(()=>{var __webpack_modules__={7876:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.addAdminServicesToServer=t.registerAdminService=void 0;const n=[];function registerAdminService(e,t){n.push({getServiceDefinition:e,getHandlers:t})}t.registerAdminService=registerAdminService;function addAdminServicesToServer(e){for(const{getServiceDefinition:t,getHandlers:r}of n){e.addService(t(),r())}}t.addAdminServicesToServer=addAdminServicesToServer},4237:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BackoffTimeout=void 0;const n=1e3;const r=1.6;const i=12e4;const s=.2;function uniformRandom(e,t){return Math.random()*(t-e)+e}class BackoffTimeout{constructor(e,t){this.callback=e;this.initialDelay=n;this.multiplier=r;this.maxDelay=i;this.jitter=s;this.running=false;this.hasRef=true;this.startTime=new Date;if(t){if(t.initialDelay){this.initialDelay=t.initialDelay}if(t.multiplier){this.multiplier=t.multiplier}if(t.jitter){this.jitter=t.jitter}if(t.maxDelay){this.maxDelay=t.maxDelay}}this.nextDelay=this.initialDelay;this.timerId=setTimeout((()=>{}),0);clearTimeout(this.timerId)}runTimer(e){var t,n;this.timerId=setTimeout((()=>{this.callback();this.running=false}),e);if(!this.hasRef){(n=(t=this.timerId).unref)===null||n===void 0?void 0:n.call(t)}}runOnce(){this.running=true;this.startTime=new Date;this.runTimer(this.nextDelay);const e=Math.min(this.nextDelay*this.multiplier,this.maxDelay);const t=e*this.jitter;this.nextDelay=e+uniformRandom(-t,t)}stop(){clearTimeout(this.timerId);this.running=false}reset(){this.nextDelay=this.initialDelay;if(this.running){const e=new Date;const t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay);clearTimeout(this.timerId);if(e<t){this.runTimer(t.getTime()-e.getTime())}else{this.running=false}}}isRunning(){return this.running}ref(){var e,t;this.hasRef=true;(t=(e=this.timerId).ref)===null||t===void 0?void 0:t.call(e)}unref(){var e,t;this.hasRef=false;(t=(e=this.timerId).unref)===null||t===void 0?void 0:t.call(e)}}t.BackoffTimeout=BackoffTimeout},5667:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CallCredentialsFilterFactory=t.CallCredentialsFilter=void 0;const r=n(3995);const i=n(8215);const s=n(8754);class CallCredentialsFilter extends r.BaseFilter{constructor(e,t){var n,r;super();this.channel=e;this.stream=t;this.channel=e;this.stream=t;const i=t.getMethod().split("/");let a="";if(i.length>=2){a=i[1]}const o=(r=(n=s.splitHostPort(t.getHost()))===null||n===void 0?void 0:n.host)!==null&&r!==void 0?r:"localhost";this.serviceUrl=`https://${o}/${a}`}async sendMetadata(e){const t=this.stream.getCredentials();const n=t.generateMetadata({service_url:this.serviceUrl});const r=await e;try{r.merge(await n)}catch(e){this.stream.cancelWithStatus(i.Status.UNAUTHENTICATED,`Failed to retrieve auth metadata with error: ${e.message}`);return Promise.reject("Failed to retrieve auth metadata")}if(r.get("authorization").length>1){this.stream.cancelWithStatus(i.Status.INTERNAL,'"authorization" metadata cannot have multiple values');return Promise.reject('"authorization" metadata cannot have multiple values')}return r}}t.CallCredentialsFilter=CallCredentialsFilter;class CallCredentialsFilterFactory{constructor(e){this.channel=e;this.channel=e}createFilter(e){return new CallCredentialsFilter(this.channel,e)}}t.CallCredentialsFilterFactory=CallCredentialsFilterFactory},3962:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CallCredentials=void 0;const r=n(6489);function isCurrentOauth2Client(e){return"getRequestHeaders"in e&&typeof e.getRequestHeaders==="function"}class CallCredentials{static createFromMetadataGenerator(e){return new SingleCallCredentials(e)}static createFromGoogleCredential(e){return CallCredentials.createFromMetadataGenerator(((t,n)=>{let i;if(isCurrentOauth2Client(e)){i=e.getRequestHeaders(t.service_url)}else{i=new Promise(((n,r)=>{e.getRequestMetadata(t.service_url,((e,t)=>{if(e){r(e);return}n(t)}))}))}i.then((e=>{const t=new r.Metadata;for(const n of Object.keys(e)){t.add(n,e[n])}n(null,t)}),(e=>{n(e)}))}))}static createEmpty(){return new EmptyCallCredentials}}t.CallCredentials=CallCredentials;class ComposedCallCredentials extends CallCredentials{constructor(e){super();this.creds=e}async generateMetadata(e){const t=new r.Metadata;const n=await Promise.all(this.creds.map((t=>t.generateMetadata(e))));for(const e of n){t.merge(e)}return t}compose(e){return new ComposedCallCredentials(this.creds.concat([e]))}_equals(e){if(this===e){return true}if(e instanceof ComposedCallCredentials){return this.creds.every(((t,n)=>t._equals(e.creds[n])))}else{return false}}}class SingleCallCredentials extends CallCredentials{constructor(e){super();this.metadataGenerator=e}generateMetadata(e){return new Promise(((t,n)=>{this.metadataGenerator(e,((e,r)=>{if(r!==undefined){t(r)}else{n(e)}}))}))}compose(e){return new ComposedCallCredentials([this,e])}_equals(e){if(this===e){return true}if(e instanceof SingleCallCredentials){return this.metadataGenerator===e.metadataGenerator}else{return false}}}class EmptyCallCredentials extends CallCredentials{generateMetadata(e){return Promise.resolve(new r.Metadata)}compose(e){return e}_equals(e){return e instanceof EmptyCallCredentials}}},250:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Http2CallStream=t.InterceptingListenerImpl=t.isInterceptingListener=void 0;const r=n(5158);const i=n(2037);const s=n(8215);const a=n(6489);const o=n(4821);const l=n(8221);const c=n(8215);const u="call_stream";const{HTTP2_HEADER_STATUS:d,HTTP2_HEADER_CONTENT_TYPE:h,NGHTTP2_CANCEL:f}=r.constants;function getSystemErrorName(e){for(const[t,n]of Object.entries(i.constants.errno)){if(n===e){return t}}return"Unknown system error "+e}function getMinDeadline(e){let t=Infinity;for(const n of e){const e=n instanceof Date?n.getTime():n;if(e<t){t=e}}return t}function isInterceptingListener(e){return e.onReceiveMetadata!==undefined&&e.onReceiveMetadata.length===1}t.isInterceptingListener=isInterceptingListener;class InterceptingListenerImpl{constructor(e,t){this.listener=e;this.nextListener=t;this.processingMetadata=false;this.hasPendingMessage=false;this.processingMessage=false;this.pendingStatus=null}processPendingMessage(){if(this.hasPendingMessage){this.nextListener.onReceiveMessage(this.pendingMessage);this.pendingMessage=null;this.hasPendingMessage=false}}processPendingStatus(){if(this.pendingStatus){this.nextListener.onReceiveStatus(this.pendingStatus)}}onReceiveMetadata(e){this.processingMetadata=true;this.listener.onReceiveMetadata(e,(e=>{this.processingMetadata=false;this.nextListener.onReceiveMetadata(e);this.processPendingMessage();this.processPendingStatus()}))}onReceiveMessage(e){this.processingMessage=true;this.listener.onReceiveMessage(e,(e=>{this.processingMessage=false;if(this.processingMetadata){this.pendingMessage=e;this.hasPendingMessage=true}else{this.nextListener.onReceiveMessage(e);this.processPendingStatus()}}))}onReceiveStatus(e){this.listener.onReceiveStatus(e,(e=>{if(this.processingMetadata||this.processingMessage){this.pendingStatus=e}else{this.nextListener.onReceiveStatus(e)}}))}}t.InterceptingListenerImpl=InterceptingListenerImpl;class Http2CallStream{constructor(e,t,n,r,i,l){this.methodName=e;this.channel=t;this.options=n;this.channelCallCredentials=i;this.callNumber=l;this.http2Stream=null;this.pendingRead=false;this.isWriteFilterPending=false;this.pendingWrite=null;this.pendingWriteCallback=null;this.writesClosed=false;this.decoder=new o.StreamDecoder;this.isReadFilterPending=false;this.canPush=false;this.readsClosed=false;this.statusOutput=false;this.unpushedReadMessages=[];this.unfilteredReadMessages=[];this.mappedStatusCode=s.Status.UNKNOWN;this.finalStatus=null;this.subchannel=null;this.listener=null;this.internalError=null;this.configDeadline=Infinity;this.statusWatchers=[];this.streamEndWatchers=[];this.callStatsTracker=null;this.filterStack=r.createFilter(this);this.credentials=i;this.disconnectListener=()=>{this.endCall({code:s.Status.UNAVAILABLE,details:"Connection dropped",metadata:new a.Metadata})};if(this.options.parentCall&&this.options.flags&s.Propagate.CANCELLATION){this.options.parentCall.on("cancelled",(()=>{this.cancelWithStatus(s.Status.CANCELLED,"Cancelled by parent call")}))}}outputStatus(){if(this.listener&&!this.statusOutput){this.statusOutput=true;const e=this.filterStack.receiveTrailers(this.finalStatus);this.trace("ended with status: code="+e.code+' details="'+e.details+'"');this.statusWatchers.forEach((t=>t(e)));process.nextTick((()=>{var t;(t=this.listener)===null||t===void 0?void 0:t.onReceiveStatus(e)}));if(this.subchannel){this.subchannel.callUnref();this.subchannel.removeDisconnectListener(this.disconnectListener)}}}trace(e){l.trace(c.LogVerbosity.DEBUG,u,"["+this.callNumber+"] "+e)}endCall(e){if(this.finalStatus===null||this.finalStatus.code===s.Status.OK){this.finalStatus=e;this.maybeOutputStatus()}this.destroyHttp2Stream()}maybeOutputStatus(){if(this.finalStatus!==null){if(this.finalStatus.code!==s.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&this.unfilteredReadMessages.length===0&&!this.isReadFilterPending){this.outputStatus()}}}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null));this.canPush=false;process.nextTick((()=>{var t;if(this.statusOutput){return}(t=this.listener)===null||t===void 0?void 0:t.onReceiveMessage(e);this.maybeOutputStatus()}))}handleFilterError(e){this.cancelWithStatus(s.Status.INTERNAL,e.message)}handleFilteredRead(e){if(this.finalStatus!==null&&this.finalStatus.code!==s.Status.OK){this.maybeOutputStatus();return}this.isReadFilterPending=false;if(this.canPush){this.http2Stream.pause();this.push(e)}else{this.trace("unpushedReadMessages.push message of length "+e.length);this.unpushedReadMessages.push(e)}if(this.unfilteredReadMessages.length>0){const e=this.unfilteredReadMessages.shift();this.filterReceivedMessage(e)}}filterReceivedMessage(e){if(this.finalStatus!==null&&this.finalStatus.code!==s.Status.OK){this.maybeOutputStatus();return}this.trace("filterReceivedMessage of length "+e.length);this.isReadFilterPending=true;this.filterStack.receiveMessage(Promise.resolve(e)).then(this.handleFilteredRead.bind(this),this.handleFilterError.bind(this))}tryPush(e){if(this.isReadFilterPending){this.trace("unfilteredReadMessages.push message of length "+(e&&e.length));this.unfilteredReadMessages.push(e)}else{this.filterReceivedMessage(e)}}handleTrailers(e){this.streamEndWatchers.forEach((e=>e(true)));let t="";for(const n of Object.keys(e)){t+="\t\t"+n+": "+e[n]+"\n"}this.trace("Received server trailers:\n"+t);let n;try{n=a.Metadata.fromHttp2Headers(e)}catch(e){n=new a.Metadata}const r=n.getMap();let i=this.mappedStatusCode;if(i===s.Status.UNKNOWN&&typeof r["grpc-status"]==="string"){const e=Number(r["grpc-status"]);if(e in s.Status){i=e;this.trace("received status code "+e+" from server")}n.remove("grpc-status")}let o="";if(typeof r["grpc-message"]==="string"){o=decodeURI(r["grpc-message"]);n.remove("grpc-message");this.trace('received status details string "'+o+'" from server')}const l={code:i,details:o,metadata:n};this.endCall(l)}writeMessageToStream(e,t){var n;(n=this.callStatsTracker)===null||n===void 0?void 0:n.addMessageSent();this.http2Stream.write(e,t)}attachHttp2Stream(e,t,n,i){this.filterStack.push(n);if(this.finalStatus!==null){e.close(f)}else{this.trace("attachHttp2Stream from subchannel "+t.getAddress());this.http2Stream=e;this.subchannel=t;this.callStatsTracker=i;t.addDisconnectListener(this.disconnectListener);t.callRef();e.on("response",((e,t)=>{var n;let i="";for(const t of Object.keys(e)){i+="\t\t"+t+": "+e[t]+"\n"}this.trace("Received server headers:\n"+i);switch(e[":status"]){case 400:this.mappedStatusCode=s.Status.INTERNAL;break;case 401:this.mappedStatusCode=s.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=s.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=s.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=s.Status.UNAVAILABLE;break;default:this.mappedStatusCode=s.Status.UNKNOWN}if(t&r.constants.NGHTTP2_FLAG_END_STREAM){this.handleTrailers(e)}else{let t;try{t=a.Metadata.fromHttp2Headers(e)}catch(e){this.endCall({code:s.Status.UNKNOWN,details:e.message,metadata:new a.Metadata});return}try{const e=this.filterStack.receiveMetadata(t);(n=this.listener)===null||n===void 0?void 0:n.onReceiveMetadata(e)}catch(e){this.endCall({code:s.Status.UNKNOWN,details:e.message,metadata:new a.Metadata})}}}));e.on("trailers",this.handleTrailers.bind(this));e.on("data",(e=>{this.trace("receive HTTP/2 data frame of length "+e.length);const t=this.decoder.write(e);for(const e of t){this.trace("parsed message of length "+e.length);this.callStatsTracker.addMessageReceived();this.tryPush(e)}}));e.on("end",(()=>{this.readsClosed=true;this.maybeOutputStatus()}));e.on("close",(()=>{process.nextTick((()=>{var t;this.trace("HTTP/2 stream closed with code "+e.rstCode);if(((t=this.finalStatus)===null||t===void 0?void 0:t.code)===s.Status.OK){return}let n;let i="";switch(e.rstCode){case r.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null){return}n=s.Status.INTERNAL;i=`Received RST_STREAM with code ${e.rstCode}`;break;case r.constants.NGHTTP2_REFUSED_STREAM:n=s.Status.UNAVAILABLE;i="Stream refused by server";break;case r.constants.NGHTTP2_CANCEL:n=s.Status.CANCELLED;i="Call cancelled";break;case r.constants.NGHTTP2_ENHANCE_YOUR_CALM:n=s.Status.RESOURCE_EXHAUSTED;i="Bandwidth exhausted or memory limit exceeded";break;case r.constants.NGHTTP2_INADEQUATE_SECURITY:n=s.Status.PERMISSION_DENIED;i="Protocol not secure enough";break;case r.constants.NGHTTP2_INTERNAL_ERROR:n=s.Status.INTERNAL;if(this.internalError===null){i=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`}else{if(this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"){n=s.Status.UNAVAILABLE;i=this.internalError.message}else{i=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`}}break;default:n=s.Status.INTERNAL;i=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:n,details:i,metadata:new a.Metadata})}))}));e.on("error",(e=>{if(e.code!=="ERR_HTTP2_STREAM_ERROR"){this.trace("Node error event: message="+e.message+" code="+e.code+" errno="+getSystemErrorName(e.errno)+" syscall="+e.syscall);this.internalError=e}this.streamEndWatchers.forEach((e=>e(false)))}));if(!this.pendingRead){e.pause()}if(this.pendingWrite){if(!this.pendingWriteCallback){throw new Error("Invalid state in write handling code")}this.trace("sending data chunk of length "+this.pendingWrite.length+" (deferred)");try{this.writeMessageToStream(this.pendingWrite,this.pendingWriteCallback)}catch(e){this.endCall({code:s.Status.UNAVAILABLE,details:`Write failed with error ${e.message}`,metadata:new a.Metadata})}}this.maybeCloseWrites()}}start(e,t){this.trace("Sending metadata");this.listener=t;this.channel._startCallStream(this,e);this.maybeOutputStatus()}destroyHttp2Stream(){var e;if(this.http2Stream!==null&&!this.http2Stream.destroyed){let t;if(((e=this.finalStatus)===null||e===void 0?void 0:e.code)===s.Status.OK){t=r.constants.NGHTTP2_NO_ERROR}else{t=r.constants.NGHTTP2_CANCEL}this.trace("close http2 stream with code "+t);this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"');this.endCall({code:e,details:t,metadata:new a.Metadata})}getDeadline(){const e=[this.options.deadline];if(this.options.parentCall&&this.options.flags&s.Propagate.DEADLINE){e.push(this.options.parentCall.getDeadline())}if(this.configDeadline){e.push(this.configDeadline)}return getMinDeadline(e)}getCredentials(){return this.credentials}setCredentials(e){this.credentials=this.channelCallCredentials.compose(e)}getStatus(){return this.finalStatus}getPeer(){var e,t;return(t=(e=this.subchannel)===null||e===void 0?void 0:e.getAddress())!==null&&t!==void 0?t:this.channel.getTarget()}getMethod(){return this.methodName}getHost(){return this.options.host}setConfigDeadline(e){this.configDeadline=e}addStatusWatcher(e){this.statusWatchers.push(e)}addStreamEndWatcher(e){this.streamEndWatchers.push(e)}addFilters(e){this.filterStack.push(e)}getCallNumber(){return this.callNumber}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==s.Status.OK){this.readsClosed=true;this.maybeOutputStatus();return}this.canPush=true;if(this.http2Stream===null){this.pendingRead=true}else{if(this.unpushedReadMessages.length>0){const e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}}maybeCloseWrites(){if(this.writesClosed&&!this.isWriteFilterPending&&this.http2Stream!==null){this.trace("calling end() on HTTP/2 stream");this.http2Stream.end()}}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);const n={message:t,flags:e.flags};const cb=t=>{var n,r;let i=s.Status.UNAVAILABLE;if(((n=t)===null||n===void 0?void 0:n.code)==="ERR_STREAM_WRITE_AFTER_END"){i=s.Status.INTERNAL}if(t){this.cancelWithStatus(i,`Write error: ${t.message}`)}(r=e.callback)===null||r===void 0?void 0:r.call(e)};this.isWriteFilterPending=true;this.filterStack.sendMessage(Promise.resolve(n)).then((e=>{this.isWriteFilterPending=false;if(this.http2Stream===null){this.trace("deferring writing data chunk of length "+e.message.length);this.pendingWrite=e.message;this.pendingWriteCallback=cb}else{this.trace("sending data chunk of length "+e.message.length);try{this.writeMessageToStream(e.message,cb)}catch(e){this.endCall({code:s.Status.UNAVAILABLE,details:`Write failed with error ${e.message}`,metadata:new a.Metadata})}this.maybeCloseWrites()}}),this.handleFilterError.bind(this))}halfClose(){this.trace("end() called");this.writesClosed=true;this.maybeCloseWrites()}}t.Http2CallStream=Http2CallStream},3732:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ClientDuplexStreamImpl=t.ClientWritableStreamImpl=t.ClientReadableStreamImpl=t.ClientUnaryCallImpl=t.callErrorFromStatus=void 0;const r=n(2361);const i=n(2781);const s=n(8215);function callErrorFromStatus(e){const t=`${e.code} ${s.Status[e.code]}: ${e.details}`;return Object.assign(new Error(t),e)}t.callErrorFromStatus=callErrorFromStatus;class ClientUnaryCallImpl extends r.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}}t.ClientUnaryCallImpl=ClientUnaryCallImpl;class ClientReadableStreamImpl extends i.Readable{constructor(e){super({objectMode:true});this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0?void 0:t.startRead()}}t.ClientReadableStreamImpl=ClientReadableStreamImpl;class ClientWritableStreamImpl extends i.Writable{constructor(e){super({objectMode:true});this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_write(e,t,n){var r;const i={callback:n};const s=Number(t);if(!Number.isNaN(s)){i.flags=s}(r=this.call)===null||r===void 0?void 0:r.sendMessageWithContext(i,e)}_final(e){var t;(t=this.call)===null||t===void 0?void 0:t.halfClose();e()}}t.ClientWritableStreamImpl=ClientWritableStreamImpl;class ClientDuplexStreamImpl extends i.Duplex{constructor(e,t){super({objectMode:true});this.serialize=e;this.deserialize=t}cancel(){var e;(e=this.call)===null||e===void 0?void 0:e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return(t=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&t!==void 0?t:"unknown"}_read(e){var t;(t=this.call)===null||t===void 0?void 0:t.startRead()}_write(e,t,n){var r;const i={callback:n};const s=Number(t);if(!Number.isNaN(s)){i.flags=s}(r=this.call)===null||r===void 0?void 0:r.sendMessageWithContext(i,e)}_final(e){var t;(t=this.call)===null||t===void 0?void 0:t.halfClose();e()}}t.ClientDuplexStreamImpl=ClientDuplexStreamImpl},3062:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChannelCredentials=void 0;const r=n(4404);const i=n(3962);const s=n(3734);function verifyIsBufferOrNull(e,t){if(e&&!(e instanceof Buffer)){throw new TypeError(`${t}, if provided, must be a Buffer.`)}}function bufferOrNullEqual(e,t){if(e===null&&t===null){return true}else{return e!==null&&t!==null&&e.equals(t)}}class ChannelCredentials{constructor(e){this.callCredentials=e||i.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,n,i){var a;verifyIsBufferOrNull(e,"Root certificate");verifyIsBufferOrNull(t,"Private key");verifyIsBufferOrNull(n,"Certificate chain");if(t&&!n){throw new Error("Private key must be given with accompanying certificate chain")}if(!t&&n){throw new Error("Certificate chain must be given with accompanying private key")}const o=r.createSecureContext({ca:(a=e!==null&&e!==void 0?e:s.getDefaultRootsData())!==null&&a!==void 0?a:undefined,key:t!==null&&t!==void 0?t:undefined,cert:n!==null&&n!==void 0?n:undefined,ciphers:s.CIPHER_SUITES});return new SecureChannelCredentialsImpl(o,i!==null&&i!==void 0?i:{})}static createFromSecureContext(e,t){return new SecureChannelCredentialsImpl(e,t!==null&&t!==void 0?t:{})}static createInsecure(){return new InsecureChannelCredentialsImpl}}t.ChannelCredentials=ChannelCredentials;class InsecureChannelCredentialsImpl extends ChannelCredentials{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return false}_equals(e){return e instanceof InsecureChannelCredentialsImpl}}class SecureChannelCredentialsImpl extends ChannelCredentials{constructor(e,t){super();this.secureContext=e;this.verifyOptions=t;this.connectionOptions={secureContext:e};if(t===null||t===void 0?void 0:t.checkServerIdentity){this.connectionOptions.checkServerIdentity=t.checkServerIdentity}}compose(e){const t=this.callCredentials.compose(e);return new ComposedChannelCredentialsImpl(this,t)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return true}_equals(e){if(this===e){return true}if(e instanceof SecureChannelCredentialsImpl){return this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity}else{return false}}}class ComposedChannelCredentialsImpl extends ChannelCredentials{constructor(e,t){super(t);this.channelCredentials=e}compose(e){const t=this.callCredentials.compose(e);return new ComposedChannelCredentialsImpl(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return true}_equals(e){if(this===e){return true}if(e instanceof ComposedChannelCredentialsImpl){return this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials)}else{return false}}}},1714:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.channelOptionsEqual=t.recognizedOptions=void 0;t.recognizedOptions={"grpc.ssl_target_name_override":true,"grpc.primary_user_agent":true,"grpc.secondary_user_agent":true,"grpc.default_authority":true,"grpc.keepalive_time_ms":true,"grpc.keepalive_timeout_ms":true,"grpc.keepalive_permit_without_calls":true,"grpc.service_config":true,"grpc.max_concurrent_streams":true,"grpc.initial_reconnect_backoff_ms":true,"grpc.max_reconnect_backoff_ms":true,"grpc.use_local_subchannel_pool":true,"grpc.max_send_message_length":true,"grpc.max_receive_message_length":true,"grpc.enable_http_proxy":true,"grpc.enable_channelz":true,"grpc.dns_min_time_between_resolutions_ms":true,"grpc-node.max_session_memory":true};function channelOptionsEqual(e,t){const n=Object.keys(e).sort();const r=Object.keys(t).sort();if(n.length!==r.length){return false}for(let i=0;i<n.length;i+=1){if(n[i]!==r[i]){return false}if(e[n[i]]!==t[r[i]]){return false}}return true}t.channelOptionsEqual=channelOptionsEqual},7586:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChannelImplementation=void 0;const r=n(250);const i=n(3062);const s=n(5478);const a=n(8603);const o=n(1576);const l=n(8215);const c=n(5866);const u=n(5667);const d=n(5071);const h=n(1762);const f=n(186);const p=n(8221);const m=n(4401);const g=n(5883);const v=n(8754);const y=n(8480);const S=n(6158);const b=2147483647;let C=0;function getNewCallNumber(){const e=C;C+=1;if(C>=Number.MAX_SAFE_INTEGER){C=0}return e}class ChannelImplementation{constructor(e,t,n){var r,C,_,T;this.credentials=t;this.options=n;this.connectivityState=y.ConnectivityState.IDLE;this.currentPicker=new o.UnavailablePicker;this.configSelectionQueue=[];this.pickQueue=[];this.connectivityStateWatchers=[];this.configSelector=null;this.currentResolutionError=null;this.channelzEnabled=true;this.callTracker=new S.ChannelzCallTracker;this.childrenTracker=new S.ChannelzChildrenTracker;if(typeof e!=="string"){throw new TypeError("Channel target must be a string")}if(!(t instanceof i.ChannelCredentials)){throw new TypeError("Channel credentials must be a ChannelCredentials object")}if(n){if(typeof n!=="object"){throw new TypeError("Channel options must be an object")}}this.originalTarget=e;const E=v.parseUri(e);if(E===null){throw new Error(`Could not parse target name "${e}"`)}const R=f.mapUriDefaultScheme(E);if(R===null){throw new Error(`Could not find a default scheme for target name "${e}"`)}this.callRefTimer=setInterval((()=>{}),b);(C=(r=this.callRefTimer).unref)===null||C===void 0?void 0:C.call(r);if(this.options["grpc.enable_channelz"]===0){this.channelzEnabled=false}this.channelzTrace=new S.ChannelzTrace;this.channelzRef=S.registerChannelzChannel(e,(()=>this.getChannelzInfo()),this.channelzEnabled);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Channel created")}if(this.options["grpc.default_authority"]){this.defaultAuthority=this.options["grpc.default_authority"]}else{this.defaultAuthority=f.getDefaultAuthority(R)}const w=g.mapProxyName(R,n);this.target=w.target;this.options=Object.assign({},this.options,w.extraOptions);this.subchannelPool=a.getSubchannelPool(((_=n["grpc.use_local_subchannel_pool"])!==null&&_!==void 0?_:0)===0);const O={createSubchannel:(e,t)=>{const n=this.subchannelPool.getOrCreateSubchannel(this.target,e,Object.assign({},this.options,t),this.credentials);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",n.getChannelzRef())}return n},updateState:(e,t)=>{this.currentPicker=t;const n=this.pickQueue.slice();this.pickQueue=[];this.callRefTimerUnref();for(const{callStream:e,callMetadata:t,callConfig:r,dynamicFilters:i}of n){this.tryPick(e,t,r,i)}this.updateState(e)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:e=>{if(this.channelzEnabled){this.childrenTracker.refChild(e)}},removeChannelzChild:e=>{if(this.channelzEnabled){this.childrenTracker.unrefChild(e)}}};this.resolvingLoadBalancer=new s.ResolvingLoadBalancer(this.target,O,n,(e=>{if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded")}this.configSelector=e;this.currentResolutionError=null;process.nextTick((()=>{const e=this.configSelectionQueue;this.configSelectionQueue=[];this.callRefTimerUnref();for(const{callStream:t,callMetadata:n}of e){this.tryGetConfig(t,n)}this.configSelectionQueue=[]}))}),(e=>{if(this.channelzEnabled){this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+e.code+' and details "'+e.details+'"')}if(this.configSelectionQueue.length>0){this.trace("Name resolution failed with calls queued for config selection")}if(this.configSelector===null){this.currentResolutionError=e}const t=this.configSelectionQueue;this.configSelectionQueue=[];this.callRefTimerUnref();for(const{callStream:n,callMetadata:r}of t){if(r.getOptions().waitForReady){this.callRefTimerRef();this.configSelectionQueue.push({callStream:n,callMetadata:r})}else{n.cancelWithStatus(e.code,e.details)}}}));this.filterStackFactory=new c.FilterStackFactory([new u.CallCredentialsFilterFactory(this),new d.DeadlineFilterFactory(this),new m.MaxMessageSizeFilterFactory(this.options),new h.CompressionFilterFactory(this,this.options)]);this.trace("Channel constructed with options "+JSON.stringify(n,undefined,2));const k=new Error;p.trace(l.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") "+"Channel constructed \n"+((T=k.stack)===null||T===void 0?void 0:T.substring(k.stack.indexOf("\n")+1)))}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){p.trace(t!==null&&t!==void 0?t:l.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+v.uriToString(this.target)+" "+e)}callRefTimerRef(){var e,t,n,r;if(!((t=(e=this.callRefTimer).hasRef)===null||t===void 0?void 0:t.call(e))){this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length);(r=(n=this.callRefTimer).ref)===null||r===void 0?void 0:r.call(n)}}callRefTimerUnref(){var e,t;if(!this.callRefTimer.hasRef||this.callRefTimer.hasRef()){this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length);(t=(e=this.callRefTimer).unref)===null||t===void 0?void 0:t.call(e)}}pushPick(e,t,n,r){this.pickQueue.push({callStream:e,callMetadata:t,callConfig:n,dynamicFilters:r});this.callRefTimerRef()}tryPick(e,t,n,r){var i,s;const a=this.currentPicker.pick({metadata:t,extraPickInfo:n.pickInformation});const c=a.subchannel?"("+a.subchannel.getChannelzRef().id+") "+a.subchannel.getAddress():""+a.subchannel;this.trace("Pick result for call ["+e.getCallNumber()+"]: "+o.PickResultType[a.pickResultType]+" subchannel: "+c+" status: "+((i=a.status)===null||i===void 0?void 0:i.code)+" "+((s=a.status)===null||s===void 0?void 0:s.details));switch(a.pickResultType){case o.PickResultType.COMPLETE:if(a.subchannel===null){e.cancelWithStatus(l.Status.UNAVAILABLE,"Request dropped by load balancing policy")}else{if(a.subchannel.getConnectivityState()!==y.ConnectivityState.READY){p.log(l.LogVerbosity.ERROR,"Error: COMPLETE pick result subchannel "+c+" has state "+y.ConnectivityState[a.subchannel.getConnectivityState()]);this.pushPick(e,t,n,r);break}e.filterStack.sendMetadata(Promise.resolve(t.clone())).then((i=>{var s,o,u;const d=a.subchannel.getConnectivityState();if(d===y.ConnectivityState.READY){try{const t=a.extraFilterFactories.map((t=>t.createFilter(e)));(s=a.subchannel)===null||s===void 0?void 0:s.getRealSubchannel().startCallStream(i,e,[...r,...t]);(o=n.onCommitted)===null||o===void 0?void 0:o.call(n);(u=a.onCallStarted)===null||u===void 0?void 0:u.call(a)}catch(i){const s=i.code;if(s==="ERR_HTTP2_GOAWAY_SESSION"||s==="ERR_HTTP2_INVALID_SESSION"){this.trace("Failed to start call on picked subchannel "+c+" with error "+i.message+". Retrying pick",l.LogVerbosity.INFO);this.tryPick(e,t,n,r)}else{this.trace("Failed to start call on picked subchanel "+c+" with error "+i.message+". Ending call",l.LogVerbosity.INFO);e.cancelWithStatus(l.Status.INTERNAL,`Failed to start HTTP/2 stream with error: ${i.message}`)}}}else{this.trace("Picked subchannel "+c+" has state "+y.ConnectivityState[d]+" after metadata filters. Retrying pick",l.LogVerbosity.INFO);this.tryPick(e,t,n,r)}}),(t=>{e.cancelWithStatus(typeof t.code==="number"?t.code:l.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${t.message}`)}))}break;case o.PickResultType.QUEUE:this.pushPick(e,t,n,r);break;case o.PickResultType.TRANSIENT_FAILURE:if(t.getOptions().waitForReady){this.pushPick(e,t,n,r)}else{e.cancelWithStatus(a.status.code,a.status.details)}break;case o.PickResultType.DROP:e.cancelWithStatus(a.status.code,a.status.details);break;default:throw new Error(`Invalid state: unknown pickResultType ${a.pickResultType}`)}}removeConnectivityStateWatcher(e){const t=this.connectivityStateWatchers.findIndex((t=>t===e));if(t>=0){this.connectivityStateWatchers.splice(t,1)}}updateState(e){p.trace(l.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+v.uriToString(this.target)+" "+y.ConnectivityState[this.connectivityState]+" -> "+y.ConnectivityState[e]);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO",y.ConnectivityState[this.connectivityState]+" -> "+y.ConnectivityState[e])}this.connectivityState=e;const t=this.connectivityStateWatchers.slice();for(const n of t){if(e!==n.currentState){if(n.timer){clearTimeout(n.timer)}this.removeConnectivityStateWatcher(n);n.callback()}}if(e!==y.ConnectivityState.TRANSIENT_FAILURE){this.currentResolutionError=null}}tryGetConfig(e,t){if(e.getStatus()!==null){return}if(this.configSelector===null){this.resolvingLoadBalancer.exitIdle();if(this.currentResolutionError&&!t.getOptions().waitForReady){e.cancelWithStatus(this.currentResolutionError.code,this.currentResolutionError.details)}else{this.configSelectionQueue.push({callStream:e,callMetadata:t});this.callRefTimerRef()}}else{const n=this.configSelector(e.getMethod(),t);if(n.status===l.Status.OK){if(n.methodConfig.timeout){const t=new Date;t.setSeconds(t.getSeconds()+n.methodConfig.timeout.seconds);t.setMilliseconds(t.getMilliseconds()+n.methodConfig.timeout.nanos/1e6);e.setConfigDeadline(t);e.filterStack.refresh()}if(n.dynamicFilterFactories.length>0){const r=new c.FilterStackFactory(n.dynamicFilterFactories);const i=r.createFilter(e);i.sendMetadata(Promise.resolve(t)).then((t=>{this.tryPick(e,t,n,i.getFilters())}))}else{this.tryPick(e,t,n,[])}}else{e.cancelWithStatus(n.status,"Failed to route call to method "+e.getMethod())}}}_startCallStream(e,t){this.tryGetConfig(e,t.clone())}close(){this.resolvingLoadBalancer.destroy();this.updateState(y.ConnectivityState.SHUTDOWN);clearInterval(this.callRefTimer);if(this.channelzEnabled){S.unregisterChannelzRef(this.channelzRef)}this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return v.uriToString(this.target)}getConnectivityState(e){const t=this.connectivityState;if(e){this.resolvingLoadBalancer.exitIdle()}return t}watchConnectivityState(e,t,n){if(this.connectivityState===y.ConnectivityState.SHUTDOWN){throw new Error("Channel has been shut down")}let r=null;if(t!==Infinity){const e=t instanceof Date?t:new Date(t);const s=new Date;if(t===-Infinity||e<=s){process.nextTick(n,new Error("Deadline passed without connectivity state change"));return}r=setTimeout((()=>{this.removeConnectivityStateWatcher(i);n(new Error("Deadline passed without connectivity state change"))}),e.getTime()-s.getTime())}const i={currentState:e,callback:n,timer:r};this.connectivityStateWatchers.push(i)}getChannelzRef(){return this.channelzRef}createCall(e,t,n,i,s){if(typeof e!=="string"){throw new TypeError("Channel#createCall: method must be a string")}if(!(typeof t==="number"||t instanceof Date)){throw new TypeError("Channel#createCall: deadline must be a number or Date")}if(this.connectivityState===y.ConnectivityState.SHUTDOWN){throw new Error("Channel has been shut down")}const a=getNewCallNumber();this.trace("createCall ["+a+'] method="'+e+'", deadline='+t);const o={deadline:t,flags:s!==null&&s!==void 0?s:l.Propagate.DEFAULTS,host:n!==null&&n!==void 0?n:this.defaultAuthority,parentCall:i};const c=new r.Http2CallStream(e,this,o,this.filterStackFactory,this.credentials._getCallCredentials(),a);if(this.channelzEnabled){this.callTracker.addCallStarted();c.addStatusWatcher((e=>{if(e.code===l.Status.OK){this.callTracker.addCallSucceeded()}else{this.callTracker.addCallFailed()}}))}return c}}t.ChannelImplementation=ChannelImplementation},6158:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setup=t.getChannelzServiceDefinition=t.getChannelzHandlers=t.unregisterChannelzRef=t.registerChannelzSocket=t.registerChannelzServer=t.registerChannelzSubchannel=t.registerChannelzChannel=t.ChannelzCallTracker=t.ChannelzChildrenTracker=t.ChannelzTrace=void 0;const r=n(1808);const i=n(8480);const s=n(8215);const a=n(9920);const o=n(7876);const l=n(1468);function channelRefToMessage(e){return{channel_id:e.id,name:e.name}}function subchannelRefToMessage(e){return{subchannel_id:e.id,name:e.name}}function serverRefToMessage(e){return{server_id:e.id}}function socketRefToMessage(e){return{socket_id:e.id,name:e.name}}const c=32;class ChannelzTrace{constructor(){this.events=[];this.eventsLogged=0;this.creationTimestamp=new Date}addTrace(e,t,n){const r=new Date;this.events.push({description:t,severity:e,timestamp:r,childChannel:(n===null||n===void 0?void 0:n.kind)==="channel"?n:undefined,childSubchannel:(n===null||n===void 0?void 0:n.kind)==="subchannel"?n:undefined});if(this.events.length>=c*2){this.events=this.events.slice(c)}this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:dateToProtoTimestamp(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map((e=>({description:e.description,severity:e.severity,timestamp:dateToProtoTimestamp(e.timestamp),channel_ref:e.childChannel?channelRefToMessage(e.childChannel):null,subchannel_ref:e.childSubchannel?subchannelRefToMessage(e.childSubchannel):null})))}}}t.ChannelzTrace=ChannelzTrace;class ChannelzChildrenTracker{constructor(){this.channelChildren=new Map;this.subchannelChildren=new Map;this.socketChildren=new Map}refChild(e){var t,n,r;switch(e.kind){case"channel":{let n=(t=this.channelChildren.get(e.id))!==null&&t!==void 0?t:{ref:e,count:0};n.count+=1;this.channelChildren.set(e.id,n);break}case"subchannel":{let t=(n=this.subchannelChildren.get(e.id))!==null&&n!==void 0?n:{ref:e,count:0};t.count+=1;this.subchannelChildren.set(e.id,t);break}case"socket":{let t=(r=this.socketChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};t.count+=1;this.socketChildren.set(e.id,t);break}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);if(t!==undefined){t.count-=1;if(t.count===0){this.channelChildren.delete(e.id)}else{this.channelChildren.set(e.id,t)}}break}case"subchannel":{let t=this.subchannelChildren.get(e.id);if(t!==undefined){t.count-=1;if(t.count===0){this.subchannelChildren.delete(e.id)}else{this.subchannelChildren.set(e.id,t)}}break}case"socket":{let t=this.socketChildren.get(e.id);if(t!==undefined){t.count-=1;if(t.count===0){this.socketChildren.delete(e.id)}else{this.socketChildren.set(e.id,t)}}break}}}getChildLists(){const e=[];for(const{ref:t}of this.channelChildren.values()){e.push(t)}const t=[];for(const{ref:e}of this.subchannelChildren.values()){t.push(e)}const n=[];for(const{ref:e}of this.socketChildren.values()){n.push(e)}return{channels:e,subchannels:t,sockets:n}}}t.ChannelzChildrenTracker=ChannelzChildrenTracker;class ChannelzCallTracker{constructor(){this.callsStarted=0;this.callsSucceeded=0;this.callsFailed=0;this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1;this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}t.ChannelzCallTracker=ChannelzCallTracker;let u=1;function getNextId(){return u++}const d=[];const h=[];const f=[];const p=[];function registerChannelzChannel(e,t,n){const r=getNextId();const i={id:r,name:e,kind:"channel"};if(n){d[r]={ref:i,getInfo:t}}return i}t.registerChannelzChannel=registerChannelzChannel;function registerChannelzSubchannel(e,t,n){const r=getNextId();const i={id:r,name:e,kind:"subchannel"};if(n){h[r]={ref:i,getInfo:t}}return i}t.registerChannelzSubchannel=registerChannelzSubchannel;function registerChannelzServer(e,t){const n=getNextId();const r={id:n,kind:"server"};if(t){f[n]={ref:r,getInfo:e}}return r}t.registerChannelzServer=registerChannelzServer;function registerChannelzSocket(e,t,n){const r=getNextId();const i={id:r,name:e,kind:"socket"};if(n){p[r]={ref:i,getInfo:t}}return i}t.registerChannelzSocket=registerChannelzSocket;function unregisterChannelzRef(e){switch(e.kind){case"channel":delete d[e.id];return;case"subchannel":delete h[e.id];return;case"server":delete f[e.id];return;case"socket":delete p[e.id];return}}t.unregisterChannelzRef=unregisterChannelzRef;function parseIPv6Section(e){const t=Number.parseInt(e,16);return[t/256|0,t%256]}function parseIPv6Chunk(e){if(e===""){return[]}const t=e.split(":").map((e=>parseIPv6Section(e)));const n=[];return n.concat(...t)}function ipAddressStringToBuffer(e){if(r.isIPv4(e)){return Buffer.from(Uint8Array.from(e.split(".").map((e=>Number.parseInt(e)))))}else if(r.isIPv6(e)){let t;let n;const r=e.indexOf("::");if(r===-1){t=e;n=""}else{t=e.substring(0,r);n=e.substring(r+2)}const i=Buffer.from(parseIPv6Chunk(t));const s=Buffer.from(parseIPv6Chunk(n));const a=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,a,s])}else{return null}}function connectivityStateToMessage(e){switch(e){case i.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case i.ConnectivityState.IDLE:return{state:"IDLE"};case i.ConnectivityState.READY:return{state:"READY"};case i.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case i.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function dateToProtoTimestamp(e){if(!e){return null}const t=e.getTime();return{seconds:t/1e3|0,nanos:t%1e3*1e6}}function getChannelMessage(e){const t=e.getInfo();return{ref:channelRefToMessage(e.ref),data:{target:t.target,state:connectivityStateToMessage(t.state),calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:dateToProtoTimestamp(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},channel_ref:t.children.channels.map((e=>channelRefToMessage(e))),subchannel_ref:t.children.subchannels.map((e=>subchannelRefToMessage(e)))}}function GetChannel(e,t){const n=Number.parseInt(e.request.channel_id);const r=d[n];if(r===undefined){t({code:s.Status.NOT_FOUND,details:"No channel data found for id "+n});return}t(null,{channel:getChannelMessage(r)})}function GetTopChannels(e,t){const n=Number.parseInt(e.request.max_results);const r=[];let i=Number.parseInt(e.request.start_channel_id);for(;i<d.length;i++){const e=d[i];if(e===undefined){continue}r.push(getChannelMessage(e));if(r.length>=n){break}}t(null,{channel:r,end:i>=f.length})}function getServerMessage(e){const t=e.getInfo();return{ref:serverRefToMessage(e.ref),data:{calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:dateToProtoTimestamp(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},listen_socket:t.listenerChildren.sockets.map((e=>socketRefToMessage(e)))}}function GetServer(e,t){const n=Number.parseInt(e.request.server_id);const r=f[n];if(r===undefined){t({code:s.Status.NOT_FOUND,details:"No server data found for id "+n});return}t(null,{server:getServerMessage(r)})}function GetServers(e,t){const n=Number.parseInt(e.request.max_results);const r=[];let i=Number.parseInt(e.request.start_server_id);for(;i<f.length;i++){const e=f[i];if(e===undefined){continue}r.push(getServerMessage(e));if(r.length>=n){break}}t(null,{server:r,end:i>=f.length})}function GetSubchannel(e,t){const n=Number.parseInt(e.request.subchannel_id);const r=h[n];if(r===undefined){t({code:s.Status.NOT_FOUND,details:"No subchannel data found for id "+n});return}const i=r.getInfo();const a={ref:subchannelRefToMessage(r.ref),data:{target:i.target,state:connectivityStateToMessage(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:dateToProtoTimestamp(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map((e=>socketRefToMessage(e)))};t(null,{subchannel:a})}function subchannelAddressToAddressMessage(e){var t;if(a.isTcpSubchannelAddress(e)){return{address:"tcpip_address",tcpip_address:{ip_address:(t=ipAddressStringToBuffer(e.host))!==null&&t!==void 0?t:undefined,port:e.port}}}else{return{address:"uds_address",uds_address:{filename:e.path}}}}function GetSocket(e,t){var n,r,i,a,o;const l=Number.parseInt(e.request.socket_id);const c=p[l];if(c===undefined){t({code:s.Status.NOT_FOUND,details:"No socket data found for id "+l});return}const u=c.getInfo();const d=u.security?{model:"tls",tls:{cipher_suite:u.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(n=u.security.cipherSuiteStandardName)!==null&&n!==void 0?n:undefined,other_name:(r=u.security.cipherSuiteOtherName)!==null&&r!==void 0?r:undefined,local_certificate:(i=u.security.localCertificate)!==null&&i!==void 0?i:undefined,remote_certificate:(a=u.security.remoteCertificate)!==null&&a!==void 0?a:undefined}}:null;const h={ref:socketRefToMessage(c.ref),local:u.localAddress?subchannelAddressToAddressMessage(u.localAddress):null,remote:u.remoteAddress?subchannelAddressToAddressMessage(u.remoteAddress):null,remote_name:(o=u.remoteName)!==null&&o!==void 0?o:undefined,security:d,data:{keep_alives_sent:u.keepAlivesSent,streams_started:u.streamsStarted,streams_succeeded:u.streamsSucceeded,streams_failed:u.streamsFailed,last_local_stream_created_timestamp:dateToProtoTimestamp(u.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:dateToProtoTimestamp(u.lastRemoteStreamCreatedTimestamp),messages_received:u.messagesReceived,messages_sent:u.messagesSent,last_message_received_timestamp:dateToProtoTimestamp(u.lastMessageReceivedTimestamp),last_message_sent_timestamp:dateToProtoTimestamp(u.lastMessageSentTimestamp),local_flow_control_window:u.localFlowControlWindow?{value:u.localFlowControlWindow}:null,remote_flow_control_window:u.remoteFlowControlWindow?{value:u.remoteFlowControlWindow}:null}};t(null,{socket:h})}function GetServerSockets(e,t){const n=Number.parseInt(e.request.server_id);const r=f[n];if(r===undefined){t({code:s.Status.NOT_FOUND,details:"No server data found for id "+n});return}const i=Number.parseInt(e.request.start_socket_id);const a=Number.parseInt(e.request.max_results);const o=r.getInfo();const l=o.sessionChildren.sockets.sort(((e,t)=>e.id-t.id));const c=[];let u=0;for(;u<l.length;u++){if(l[u].id>=i){c.push(socketRefToMessage(l[u]));if(c.length>=a){break}}}t(null,{socket_ref:c,end:u>=l.length})}function getChannelzHandlers(){return{GetChannel:GetChannel,GetTopChannels:GetTopChannels,GetServer:GetServer,GetServers:GetServers,GetSubchannel:GetSubchannel,GetSocket:GetSocket,GetServerSockets:GetServerSockets}}t.getChannelzHandlers=getChannelzHandlers;let m=null;function getChannelzServiceDefinition(){if(m){return m}const e=n(8855).J_;const t=e("channelz.proto",{keepCase:true,longs:String,enums:String,defaults:true,oneofs:true,includeDirs:[n.ab+"proto"]});const r=l.loadPackageDefinition(t);m=r.grpc.channelz.v1.Channelz.service;return m}t.getChannelzServiceDefinition=getChannelzServiceDefinition;function setup(){o.registerAdminService(getChannelzServiceDefinition,getChannelzHandlers)}t.setup=setup},3428:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getInterceptingCall=t.InterceptingCall=t.RequesterBuilder=t.ListenerBuilder=t.InterceptorConfigurationError=void 0;const r=n(6489);const i=n(250);const s=n(8215);class InterceptorConfigurationError extends Error{constructor(e){super(e);this.name="InterceptorConfigurationError";Error.captureStackTrace(this,InterceptorConfigurationError)}}t.InterceptorConfigurationError=InterceptorConfigurationError;class ListenerBuilder{constructor(){this.metadata=undefined;this.message=undefined;this.status=undefined}withOnReceiveMetadata(e){this.metadata=e;return this}withOnReceiveMessage(e){this.message=e;return this}withOnReceiveStatus(e){this.status=e;return this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}t.ListenerBuilder=ListenerBuilder;class RequesterBuilder{constructor(){this.start=undefined;this.message=undefined;this.halfClose=undefined;this.cancel=undefined}withStart(e){this.start=e;return this}withSendMessage(e){this.message=e;return this}withHalfClose(e){this.halfClose=e;return this}withCancel(e){this.cancel=e;return this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}t.RequesterBuilder=RequesterBuilder;const a={onReceiveMetadata:(e,t)=>{t(e)},onReceiveMessage:(e,t)=>{t(e)},onReceiveStatus:(e,t)=>{t(e)}};const o={start:(e,t,n)=>{n(e,t)},sendMessage:(e,t)=>{t(e)},halfClose:e=>{e()},cancel:e=>{e()}};class InterceptingCall{constructor(e,t){var n,r,i,s;this.nextCall=e;this.processingMetadata=false;this.pendingMessageContext=null;this.processingMessage=false;this.pendingHalfClose=false;if(t){this.requester={start:(n=t.start)!==null&&n!==void 0?n:o.start,sendMessage:(r=t.sendMessage)!==null&&r!==void 0?r:o.sendMessage,halfClose:(i=t.halfClose)!==null&&i!==void 0?i:o.halfClose,cancel:(s=t.cancel)!==null&&s!==void 0?s:o.cancel}}else{this.requester=o}}cancelWithStatus(e,t){this.requester.cancel((()=>{this.nextCall.cancelWithStatus(e,t)}))}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){if(this.pendingMessageContext){this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage);this.pendingMessageContext=null;this.pendingMessage=null}}processPendingHalfClose(){if(this.pendingHalfClose){this.nextCall.halfClose()}}start(e,t){var n,r,s,o,l,c;const u={onReceiveMetadata:(r=(n=t===null||t===void 0?void 0:t.onReceiveMetadata)===null||n===void 0?void 0:n.bind(t))!==null&&r!==void 0?r:e=>{},onReceiveMessage:(o=(s=t===null||t===void 0?void 0:t.onReceiveMessage)===null||s===void 0?void 0:s.bind(t))!==null&&o!==void 0?o:e=>{},onReceiveStatus:(c=(l=t===null||t===void 0?void 0:t.onReceiveStatus)===null||l===void 0?void 0:l.bind(t))!==null&&c!==void 0?c:e=>{}};this.processingMetadata=true;this.requester.start(e,u,((e,t)=>{var n,r,s;this.processingMetadata=false;let o;if(i.isInterceptingListener(t)){o=t}else{const e={onReceiveMetadata:(n=t.onReceiveMetadata)!==null&&n!==void 0?n:a.onReceiveMetadata,onReceiveMessage:(r=t.onReceiveMessage)!==null&&r!==void 0?r:a.onReceiveMessage,onReceiveStatus:(s=t.onReceiveStatus)!==null&&s!==void 0?s:a.onReceiveStatus};o=new i.InterceptingListenerImpl(e,u)}this.nextCall.start(e,o);this.processPendingMessage();this.processPendingHalfClose()}))}sendMessageWithContext(e,t){this.processingMessage=true;this.requester.sendMessage(t,(n=>{this.processingMessage=false;if(this.processingMetadata){this.pendingMessageContext=e;this.pendingMessage=t}else{this.nextCall.sendMessageWithContext(e,n);this.processPendingHalfClose()}}))}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose((()=>{if(this.processingMetadata||this.processingMessage){this.pendingHalfClose=true}else{this.nextCall.halfClose()}}))}setCredentials(e){this.nextCall.setCredentials(e)}}t.InterceptingCall=InterceptingCall;function getCall(e,t,n){var r,i;const s=(r=n.deadline)!==null&&r!==void 0?r:Infinity;const a=n.host;const o=(i=n.parent)!==null&&i!==void 0?i:null;const l=n.propagate_flags;const c=n.credentials;const u=e.createCall(t,s,a,o,l);if(c){u.setCredentials(c)}return u}class BaseInterceptingCall{constructor(e,t){this.call=e;this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}setCredentials(e){this.call.setCredentials(e)}sendMessageWithContext(e,t){let n;try{n=this.methodDefinition.requestSerialize(t)}catch(e){this.call.cancelWithStatus(s.Status.INTERNAL,`Request message serialization failure: ${e.message}`);return}this.call.sendMessageWithContext(e,n)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let n=null;this.call.start(e,{onReceiveMetadata:e=>{var n;(n=t===null||t===void 0?void 0:t.onReceiveMetadata)===null||n===void 0?void 0:n.call(t,e)},onReceiveMessage:e=>{var i;let a;try{a=this.methodDefinition.responseDeserialize(e)}catch(e){n={code:s.Status.INTERNAL,details:`Response message parsing error: ${e.message}`,metadata:new r.Metadata};this.call.cancelWithStatus(n.code,n.details);return}(i=t===null||t===void 0?void 0:t.onReceiveMessage)===null||i===void 0?void 0:i.call(t,a)},onReceiveStatus:e=>{var r,i;if(n){(r=t===null||t===void 0?void 0:t.onReceiveStatus)===null||r===void 0?void 0:r.call(t,n)}else{(i=t===null||t===void 0?void 0:t.onReceiveStatus)===null||i===void 0?void 0:i.call(t,e)}}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class BaseUnaryInterceptingCall extends BaseInterceptingCall{constructor(e,t){super(e,t)}start(e,t){var n,r;let i=false;const s={onReceiveMetadata:(r=(n=t===null||t===void 0?void 0:t.onReceiveMetadata)===null||n===void 0?void 0:n.bind(t))!==null&&r!==void 0?r:e=>{},onReceiveMessage:e=>{var n;i=true;(n=t===null||t===void 0?void 0:t.onReceiveMessage)===null||n===void 0?void 0:n.call(t,e)},onReceiveStatus:e=>{var n,r;if(!i){(n=t===null||t===void 0?void 0:t.onReceiveMessage)===null||n===void 0?void 0:n.call(t,null)}(r=t===null||t===void 0?void 0:t.onReceiveStatus)===null||r===void 0?void 0:r.call(t,e)}};super.start(e,s);this.call.startRead()}}class BaseStreamingInterceptingCall extends BaseInterceptingCall{}function getBottomInterceptingCall(e,t,n){const r=getCall(e,n.path,t);if(n.responseStream){return new BaseStreamingInterceptingCall(r,n)}else{return new BaseUnaryInterceptingCall(r,n)}}function getInterceptingCall(e,t,n,r){if(e.clientInterceptors.length>0&&e.clientInterceptorProviders.length>0){throw new InterceptorConfigurationError("Both interceptors and interceptor_providers were passed as options "+"to the client constructor. Only one of these is allowed.")}if(e.callInterceptors.length>0&&e.callInterceptorProviders.length>0){throw new InterceptorConfigurationError("Both interceptors and interceptor_providers were passed as call "+"options. Only one of these is allowed.")}let i=[];if(e.callInterceptors.length>0||e.callInterceptorProviders.length>0){i=[].concat(e.callInterceptors,e.callInterceptorProviders.map((e=>e(t)))).filter((e=>e))}else{i=[].concat(e.clientInterceptors,e.clientInterceptorProviders.map((e=>e(t)))).filter((e=>e))}const s=Object.assign({},n,{method_definition:t});const a=i.reduceRight(((e,t)=>n=>t(n,e)),(e=>getBottomInterceptingCall(r,e,t)));return a(s)}t.getInterceptingCall=getInterceptingCall},4153:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Client=void 0;const r=n(3732);const i=n(7586);const s=n(8480);const a=n(8215);const o=n(6489);const l=n(3428);const c=Symbol();const u=Symbol();const d=Symbol();const h=Symbol();function isFunction(e){return typeof e==="function"}class Client{constructor(e,t,n={}){var r,s;n=Object.assign({},n);this[u]=(r=n.interceptors)!==null&&r!==void 0?r:[];delete n.interceptors;this[d]=(s=n.interceptor_providers)!==null&&s!==void 0?s:[];delete n.interceptor_providers;if(this[u].length>0&&this[d].length>0){throw new Error("Both interceptors and interceptor_providers were passed as options "+"to the client constructor. Only one of these is allowed.")}this[h]=n.callInvocationTransformer;delete n.callInvocationTransformer;if(n.channelOverride){this[c]=n.channelOverride}else if(n.channelFactoryOverride){const r=n.channelFactoryOverride;delete n.channelFactoryOverride;this[c]=r(e,t,n)}else{this[c]=new i.ChannelImplementation(e,t,n)}}close(){this[c].close()}getChannel(){return this[c]}waitForReady(e,t){const checkState=n=>{if(n){t(new Error("Failed to connect before the deadline"));return}let r;try{r=this[c].getConnectivityState(true)}catch(e){t(new Error("The channel has been closed"));return}if(r===s.ConnectivityState.READY){t()}else{try{this[c].watchConnectivityState(r,e,checkState)}catch(e){t(new Error("The channel has been closed"))}}};setImmediate(checkState)}checkOptionalUnaryResponseArguments(e,t,n){if(isFunction(e)){return{metadata:new o.Metadata,options:{},callback:e}}else if(isFunction(t)){if(e instanceof o.Metadata){return{metadata:e,options:{},callback:t}}else{return{metadata:new o.Metadata,options:e,callback:t}}}else{if(!(e instanceof o.Metadata&&t instanceof Object&&isFunction(n))){throw new Error("Incorrect arguments passed")}return{metadata:e,options:t,callback:n}}}makeUnaryRequest(e,t,n,i,s,o,f){var p,m;const g=this.checkOptionalUnaryResponseArguments(s,o,f);const v={path:e,requestStream:false,responseStream:false,requestSerialize:t,responseDeserialize:n};let y={argument:i,metadata:g.metadata,call:new r.ClientUnaryCallImpl,channel:this[c],methodDefinition:v,callOptions:g.options,callback:g.callback};if(this[h]){y=this[h](y)}const S=y.call;const b={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(p=y.callOptions.interceptors)!==null&&p!==void 0?p:[],callInterceptorProviders:(m=y.callOptions.interceptor_providers)!==null&&m!==void 0?m:[]};const C=l.getInterceptingCall(b,y.methodDefinition,y.callOptions,y.channel);S.call=C;if(y.callOptions.credentials){C.setCredentials(y.callOptions.credentials)}let _=null;let T=false;C.start(y.metadata,{onReceiveMetadata:e=>{S.emit("metadata",e)},onReceiveMessage(e){if(_!==null){C.cancelWithStatus(a.Status.INTERNAL,"Too many responses received")}_=e},onReceiveStatus(e){if(T){return}T=true;if(e.code===a.Status.OK){y.callback(null,_)}else{y.callback(r.callErrorFromStatus(e))}S.emit("status",e)}});C.sendMessage(i);C.halfClose();return S}makeClientStreamRequest(e,t,n,i,s,o){var f,p;const m=this.checkOptionalUnaryResponseArguments(i,s,o);const g={path:e,requestStream:true,responseStream:false,requestSerialize:t,responseDeserialize:n};let v={metadata:m.metadata,call:new r.ClientWritableStreamImpl(t),channel:this[c],methodDefinition:g,callOptions:m.options,callback:m.callback};if(this[h]){v=this[h](v)}const y=v.call;const S={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(f=v.callOptions.interceptors)!==null&&f!==void 0?f:[],callInterceptorProviders:(p=v.callOptions.interceptor_providers)!==null&&p!==void 0?p:[]};const b=l.getInterceptingCall(S,v.methodDefinition,v.callOptions,v.channel);y.call=b;if(v.callOptions.credentials){b.setCredentials(v.callOptions.credentials)}let C=null;let _=false;b.start(v.metadata,{onReceiveMetadata:e=>{y.emit("metadata",e)},onReceiveMessage(e){if(C!==null){b.cancelWithStatus(a.Status.INTERNAL,"Too many responses received")}C=e},onReceiveStatus(e){if(_){return}_=true;if(e.code===a.Status.OK){v.callback(null,C)}else{v.callback(r.callErrorFromStatus(e))}y.emit("status",e)}});return y}checkMetadataAndOptions(e,t){let n;let r;if(e instanceof o.Metadata){n=e;if(t){r=t}else{r={}}}else{if(e){r=e}else{r={}}n=new o.Metadata}return{metadata:n,options:r}}makeServerStreamRequest(e,t,n,i,s,o){var f,p;const m=this.checkMetadataAndOptions(s,o);const g={path:e,requestStream:false,responseStream:true,requestSerialize:t,responseDeserialize:n};let v={argument:i,metadata:m.metadata,call:new r.ClientReadableStreamImpl(n),channel:this[c],methodDefinition:g,callOptions:m.options};if(this[h]){v=this[h](v)}const y=v.call;const S={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(f=v.callOptions.interceptors)!==null&&f!==void 0?f:[],callInterceptorProviders:(p=v.callOptions.interceptor_providers)!==null&&p!==void 0?p:[]};const b=l.getInterceptingCall(S,v.methodDefinition,v.callOptions,v.channel);y.call=b;if(v.callOptions.credentials){b.setCredentials(v.callOptions.credentials)}let C=false;b.start(v.metadata,{onReceiveMetadata(e){y.emit("metadata",e)},onReceiveMessage(e){y.push(e)},onReceiveStatus(e){if(C){return}C=true;y.push(null);if(e.code!==a.Status.OK){y.emit("error",r.callErrorFromStatus(e))}y.emit("status",e)}});b.sendMessage(i);b.halfClose();return y}makeBidiStreamRequest(e,t,n,i,s){var o,f;const p=this.checkMetadataAndOptions(i,s);const m={path:e,requestStream:true,responseStream:true,requestSerialize:t,responseDeserialize:n};let g={metadata:p.metadata,call:new r.ClientDuplexStreamImpl(t,n),channel:this[c],methodDefinition:m,callOptions:p.options};if(this[h]){g=this[h](g)}const v=g.call;const y={clientInterceptors:this[u],clientInterceptorProviders:this[d],callInterceptors:(o=g.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(f=g.callOptions.interceptor_providers)!==null&&f!==void 0?f:[]};const S=l.getInterceptingCall(y,g.methodDefinition,g.callOptions,g.channel);v.call=S;if(g.callOptions.credentials){S.setCredentials(g.callOptions.credentials)}let b=false;S.start(g.metadata,{onReceiveMetadata(e){v.emit("metadata",e)},onReceiveMessage(e){v.push(e)},onReceiveStatus(e){if(b){return}b=true;v.push(null);if(e.code!==a.Status.OK){v.emit("error",r.callErrorFromStatus(e))}v.emit("status",e)}});return v}}t.Client=Client},4726:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CompressionAlgorithms=void 0;var n;(function(e){e[e["identity"]=0]="identity";e[e["deflate"]=1]="deflate";e[e["gzip"]=2]="gzip"})(n=t.CompressionAlgorithms||(t.CompressionAlgorithms={}))},1762:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.CompressionFilterFactory=t.CompressionFilter=void 0;const r=n(9796);const i=n(4726);const s=n(8215);const a=n(3995);const o=n(8221);const isCompressionAlgorithmKey=e=>typeof e==="number"&&typeof i.CompressionAlgorithms[e]==="string";class CompressionHandler{async writeMessage(e,t){let n=e;if(t){n=await this.compressMessage(n)}const r=Buffer.allocUnsafe(n.length+5);r.writeUInt8(t?1:0,0);r.writeUInt32BE(n.length,1);n.copy(r,5);return r}async readMessage(e){const t=e.readUInt8(0)===1;let n=e.slice(5);if(t){n=await this.decompressMessage(n)}return n}}class IdentityHandler extends CompressionHandler{async compressMessage(e){return e}async writeMessage(e,t){const n=Buffer.allocUnsafe(e.length+5);n.writeUInt8(0,0);n.writeUInt32BE(e.length,1);e.copy(n,5);return n}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}}class DeflateHandler extends CompressionHandler{compressMessage(e){return new Promise(((t,n)=>{r.deflate(e,((e,r)=>{if(e){n(e)}else{t(r)}}))}))}decompressMessage(e){return new Promise(((t,n)=>{r.inflate(e,((e,r)=>{if(e){n(e)}else{t(r)}}))}))}}class GzipHandler extends CompressionHandler{compressMessage(e){return new Promise(((t,n)=>{r.gzip(e,((e,r)=>{if(e){n(e)}else{t(r)}}))}))}decompressMessage(e){return new Promise(((t,n)=>{r.unzip(e,((e,r)=>{if(e){n(e)}else{t(r)}}))}))}}class UnknownHandler extends CompressionHandler{constructor(e){super();this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}}function getCompressionHandler(e){switch(e){case"identity":return new IdentityHandler;case"deflate":return new DeflateHandler;case"gzip":return new GzipHandler;default:return new UnknownHandler(e)}}class CompressionFilter extends a.BaseFilter{constructor(e,t){var n;super();this.sharedFilterConfig=t;this.sendCompression=new IdentityHandler;this.receiveCompression=new IdentityHandler;this.currentCompressionAlgorithm="identity";const r=e["grpc.default_compression_algorithm"];if(r!==undefined){if(isCompressionAlgorithmKey(r)){const e=i.CompressionAlgorithms[r];const s=(n=t.serverSupportedEncodingHeader)===null||n===void 0?void 0:n.split(",");if(!s||s.includes(e)){this.currentCompressionAlgorithm=e;this.sendCompression=getCompressionHandler(this.currentCompressionAlgorithm)}}else{o.log(s.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${r}`)}}}async sendMetadata(e){const t=await e;t.set("grpc-accept-encoding","identity,deflate,gzip");t.set("accept-encoding","identity");if(this.currentCompressionAlgorithm==="identity"){t.remove("grpc-encoding")}else{t.set("grpc-encoding",this.currentCompressionAlgorithm)}return t}receiveMetadata(e){const t=e.get("grpc-encoding");if(t.length>0){const e=t[0];if(typeof e==="string"){this.receiveCompression=getCompressionHandler(e)}}e.remove("grpc-encoding");const n=e.get("grpc-accept-encoding")[0];if(n){this.sharedFilterConfig.serverSupportedEncodingHeader=n;const e=n.split(",");if(!e.includes(this.currentCompressionAlgorithm)){this.sendCompression=new IdentityHandler;this.currentCompressionAlgorithm="identity"}}e.remove("grpc-accept-encoding");return e}async sendMessage(e){var t;const n=await e;let r;if(this.sendCompression instanceof IdentityHandler){r=false}else{r=(((t=n.flags)!==null&&t!==void 0?t:0)&2)===0}return{message:await this.sendCompression.writeMessage(n.message,r),flags:n.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}}t.CompressionFilter=CompressionFilter;class CompressionFilterFactory{constructor(e,t){this.channel=e;this.options=t;this.sharedFilterConfig={}}createFilter(e){return new CompressionFilter(this.options,this.sharedFilterConfig)}}t.CompressionFilterFactory=CompressionFilterFactory},8480:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ConnectivityState=void 0;var n;(function(e){e[e["IDLE"]=0]="IDLE";e[e["CONNECTING"]=1]="CONNECTING";e[e["READY"]=2]="READY";e[e["TRANSIENT_FAILURE"]=3]="TRANSIENT_FAILURE";e[e["SHUTDOWN"]=4]="SHUTDOWN"})(n=t.ConnectivityState||(t.ConnectivityState={}))},8215:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=t.Propagate=t.LogVerbosity=t.Status=void 0;var n;(function(e){e[e["OK"]=0]="OK";e[e["CANCELLED"]=1]="CANCELLED";e[e["UNKNOWN"]=2]="UNKNOWN";e[e["INVALID_ARGUMENT"]=3]="INVALID_ARGUMENT";e[e["DEADLINE_EXCEEDED"]=4]="DEADLINE_EXCEEDED";e[e["NOT_FOUND"]=5]="NOT_FOUND";e[e["ALREADY_EXISTS"]=6]="ALREADY_EXISTS";e[e["PERMISSION_DENIED"]=7]="PERMISSION_DENIED";e[e["RESOURCE_EXHAUSTED"]=8]="RESOURCE_EXHAUSTED";e[e["FAILED_PRECONDITION"]=9]="FAILED_PRECONDITION";e[e["ABORTED"]=10]="ABORTED";e[e["OUT_OF_RANGE"]=11]="OUT_OF_RANGE";e[e["UNIMPLEMENTED"]=12]="UNIMPLEMENTED";e[e["INTERNAL"]=13]="INTERNAL";e[e["UNAVAILABLE"]=14]="UNAVAILABLE";e[e["DATA_LOSS"]=15]="DATA_LOSS";e[e["UNAUTHENTICATED"]=16]="UNAUTHENTICATED"})(n=t.Status||(t.Status={}));var r;(function(e){e[e["DEBUG"]=0]="DEBUG";e[e["INFO"]=1]="INFO";e[e["ERROR"]=2]="ERROR";e[e["NONE"]=3]="NONE"})(r=t.LogVerbosity||(t.LogVerbosity={}));var i;(function(e){e[e["DEADLINE"]=1]="DEADLINE";e[e["CENSUS_STATS_CONTEXT"]=2]="CENSUS_STATS_CONTEXT";e[e["CENSUS_TRACING_CONTEXT"]=4]="CENSUS_TRACING_CONTEXT";e[e["CANCELLATION"]=8]="CANCELLATION";e[e["DEFAULTS"]=65535]="DEFAULTS"})(i=t.Propagate||(t.Propagate={}));t.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;t.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024},5071:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.DeadlineFilterFactory=t.DeadlineFilter=void 0;const r=n(8215);const i=n(3995);const s=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function getDeadline(e){const t=(new Date).getTime();const n=Math.max(e-t,0);for(const[e,t]of s){const r=n/t;if(r<1e8){return String(Math.ceil(r))+e}}throw new Error("Deadline is too far in the future")}class DeadlineFilter extends i.BaseFilter{constructor(e,t){super();this.channel=e;this.callStream=t;this.timer=null;this.deadline=Infinity;this.retreiveDeadline();this.runTimer()}retreiveDeadline(){const e=this.callStream.getDeadline();if(e instanceof Date){this.deadline=e.getTime()}else{this.deadline=e}}runTimer(){var e,t;if(this.timer){clearTimeout(this.timer)}const n=(new Date).getTime();const i=this.deadline-n;if(i<=0){process.nextTick((()=>{this.callStream.cancelWithStatus(r.Status.DEADLINE_EXCEEDED,"Deadline exceeded")}))}else if(this.deadline!==Infinity){this.timer=setTimeout((()=>{this.callStream.cancelWithStatus(r.Status.DEADLINE_EXCEEDED,"Deadline exceeded")}),i);(t=(e=this.timer).unref)===null||t===void 0?void 0:t.call(e)}}refresh(){this.retreiveDeadline();this.runTimer()}async sendMetadata(e){if(this.deadline===Infinity){return e}const t=await e;const n=getDeadline(this.deadline);t.set("grpc-timeout",n);return t}receiveTrailers(e){if(this.timer){clearTimeout(this.timer)}return e}}t.DeadlineFilter=DeadlineFilter;class DeadlineFilterFactory{constructor(e){this.channel=e}createFilter(e){return new DeadlineFilter(this.channel,e)}}t.DeadlineFilterFactory=DeadlineFilterFactory},6352:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.isDuration=t.durationToMs=t.msToDuration=void 0;function msToDuration(e){return{seconds:e/1e3|0,nanos:e%1e3*1e6|0}}t.msToDuration=msToDuration;function durationToMs(e){return e.seconds*1e3+e.nanos/1e6|0}t.durationToMs=durationToMs;function isDuration(e){return typeof e.seconds==="number"&&typeof e.nanos==="number"}t.isDuration=isDuration},9006:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});var r=n(8221);Object.defineProperty(t,"trace",{enumerable:true,get:function(){return r.trace}});var i=n(186);Object.defineProperty(t,"registerResolver",{enumerable:true,get:function(){return i.registerResolver}});var s=n(8754);Object.defineProperty(t,"uriToString",{enumerable:true,get:function(){return s.uriToString}});var a=n(6352);Object.defineProperty(t,"durationToMs",{enumerable:true,get:function(){return a.durationToMs}});var o=n(4237);Object.defineProperty(t,"BackoffTimeout",{enumerable:true,get:function(){return o.BackoffTimeout}});var l=n(4106);Object.defineProperty(t,"createChildChannelControlHelper",{enumerable:true,get:function(){return l.createChildChannelControlHelper}});Object.defineProperty(t,"registerLoadBalancerType",{enumerable:true,get:function(){return l.registerLoadBalancerType}});Object.defineProperty(t,"getFirstUsableConfig",{enumerable:true,get:function(){return l.getFirstUsableConfig}});Object.defineProperty(t,"validateLoadBalancingConfig",{enumerable:true,get:function(){return l.validateLoadBalancingConfig}});var c=n(9920);Object.defineProperty(t,"subchannelAddressToString",{enumerable:true,get:function(){return c.subchannelAddressToString}});var u=n(9046);Object.defineProperty(t,"ChildLoadBalancerHandler",{enumerable:true,get:function(){return u.ChildLoadBalancerHandler}});var d=n(1576);Object.defineProperty(t,"UnavailablePicker",{enumerable:true,get:function(){return d.UnavailablePicker}});Object.defineProperty(t,"QueuePicker",{enumerable:true,get:function(){return d.QueuePicker}});Object.defineProperty(t,"PickResultType",{enumerable:true,get:function(){return d.PickResultType}});var h=n(3995);Object.defineProperty(t,"BaseFilter",{enumerable:true,get:function(){return h.BaseFilter}});var f=n(5866);Object.defineProperty(t,"FilterStackFactory",{enumerable:true,get:function(){return f.FilterStackFactory}});var p=n(7876);Object.defineProperty(t,"registerAdminService",{enumerable:true,get:function(){return p.registerAdminService}});var m=n(9121);Object.defineProperty(t,"BaseSubchannelWrapper",{enumerable:true,get:function(){return m.BaseSubchannelWrapper}});var g=n(2057);Object.defineProperty(t,"OutlierDetectionLoadBalancingConfig",{enumerable:true,get:function(){return g.OutlierDetectionLoadBalancingConfig}})},5866:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.FilterStackFactory=t.FilterStack=void 0;class FilterStack{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let e=0;e<this.filters.length;e++){t=this.filters[e].sendMetadata(t)}return t}receiveMetadata(e){let t=e;for(let e=this.filters.length-1;e>=0;e--){t=this.filters[e].receiveMetadata(t)}return t}sendMessage(e){let t=e;for(let e=0;e<this.filters.length;e++){t=this.filters[e].sendMessage(t)}return t}receiveMessage(e){let t=e;for(let e=this.filters.length-1;e>=0;e--){t=this.filters[e].receiveMessage(t)}return t}receiveTrailers(e){let t=e;for(let e=this.filters.length-1;e>=0;e--){t=this.filters[e].receiveTrailers(t)}return t}refresh(){for(const e of this.filters){e.refresh()}}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}}t.FilterStack=FilterStack;class FilterStackFactory{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}createFilter(e){return new FilterStack(this.factories.map((t=>t.createFilter(e))))}}t.FilterStackFactory=FilterStackFactory},3995:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseFilter=void 0;class BaseFilter{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}refresh(){}}t.BaseFilter=BaseFilter},5883:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getProxiedConnection=t.mapProxyName=void 0;const r=n(8221);const i=n(8215);const s=n(186);const a=n(3685);const o=n(4404);const l=n(8221);const c=n(9920);const u=n(8754);const d=n(7310);const h="proxy";function trace(e){l.trace(i.LogVerbosity.DEBUG,h,e)}function getProxyInfo(){let e="";let t="";if(process.env.grpc_proxy){t="grpc_proxy";e=process.env.grpc_proxy}else if(process.env.https_proxy){t="https_proxy";e=process.env.https_proxy}else if(process.env.http_proxy){t="http_proxy";e=process.env.http_proxy}else{return{}}let n;try{n=new d.URL(e)}catch(e){r.log(i.LogVerbosity.ERROR,`cannot parse value of "${t}" env var`);return{}}if(n.protocol!=="http:"){r.log(i.LogVerbosity.ERROR,`"${n.protocol}" scheme not supported in proxy URI`);return{}}let s=null;if(n.username){if(n.password){r.log(i.LogVerbosity.INFO,"userinfo found in proxy URI");s=`${n.username}:${n.password}`}else{s=n.username}}const a=n.hostname;let o=n.port;if(o===""){o="80"}const l={address:`${a}:${o}`};if(s){l.creds=s}trace("Proxy server "+l.address+" set by environment variable "+t);return l}function getNoProxyHostList(){let e=process.env.no_grpc_proxy;let t="no_grpc_proxy";if(!e){e=process.env.no_proxy;t="no_proxy"}if(e){trace("No proxy server list set by environment variable "+t);return e.split(",")}else{return[]}}function mapProxyName(e,t){var n;const r={target:e,extraOptions:{}};if(((n=t["grpc.enable_http_proxy"])!==null&&n!==void 0?n:1)===0){return r}if(e.scheme==="unix"){return r}const i=getProxyInfo();if(!i.address){return r}const s=u.splitHostPort(e.path);if(!s){return r}const a=s.host;for(const t of getNoProxyHostList()){if(t===a){trace("Not using proxy for target in no_proxy list: "+u.uriToString(e));return r}}const o={"grpc.http_connect_target":u.uriToString(e)};if(i.creds){o["grpc.http_connect_creds"]=i.creds}return{target:{scheme:"dns",path:i.address},extraOptions:o}}t.mapProxyName=mapProxyName;function getProxiedConnection(e,t,n){if(!("grpc.http_connect_target"in t)){return Promise.resolve({})}const l=t["grpc.http_connect_target"];const d=u.parseUri(l);if(d===null){return Promise.resolve({})}const h={method:"CONNECT",path:d.path};const f={Host:d.path};if(c.isTcpSubchannelAddress(e)){h.host=e.host;h.port=e.port}else{h.socketPath=e.path}if("grpc.http_connect_creds"in t){f["Proxy-Authorization"]="Basic "+Buffer.from(t["grpc.http_connect_creds"]).toString("base64")}h.headers=f;const p=c.subchannelAddressToString(e);trace("Using proxy "+p+" to connect to "+h.path);return new Promise(((e,t)=>{const l=a.request(h);l.once("connect",((a,c,f)=>{var m;l.removeAllListeners();c.removeAllListeners();if(a.statusCode===200){trace("Successfully connected to "+h.path+" through proxy "+p);if("secureContext"in n){const r=s.getDefaultAuthority(d);const i=u.splitHostPort(r);const a=(m=i===null||i===void 0?void 0:i.host)!==null&&m!==void 0?m:r;const l=o.connect(Object.assign({host:a,servername:a,socket:c},n),(()=>{trace("Successfully established a TLS connection to "+h.path+" through proxy "+p);e({socket:l,realTarget:d})}));l.on("error",(e=>{trace("Failed to establish a TLS connection to "+h.path+" through proxy "+p+" with error "+e.message);t()}))}else{trace("Successfully established a plaintext connection to "+h.path+" through proxy "+p);e({socket:c,realTarget:d})}}else{r.log(i.LogVerbosity.ERROR,"Failed to connect to "+h.path+" through proxy "+p+" with status "+a.statusCode);t()}}));l.once("error",(e=>{l.removeAllListeners();r.log(i.LogVerbosity.ERROR,"Failed to connect to proxy "+p+" with error "+e.message);t()}));l.end()}))}t.getProxiedConnection=getProxiedConnection},9046:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ChildLoadBalancerHandler=void 0;const r=n(4106);const i=n(8480);const s="child_load_balancer_helper";class ChildLoadBalancerHandler{constructor(e){this.channelControlHelper=e;this.currentChild=null;this.pendingChild=null;this.ChildPolicyHelper=class{constructor(e){this.parent=e;this.child=null}createSubchannel(e,t){return this.parent.channelControlHelper.createSubchannel(e,t)}updateState(e,t){var n;if(this.calledByPendingChild()){if(e!==i.ConnectivityState.READY){return}(n=this.parent.currentChild)===null||n===void 0?void 0:n.destroy();this.parent.currentChild=this.parent.pendingChild;this.parent.pendingChild=null}else if(!this.calledByCurrentChild()){return}this.parent.channelControlHelper.updateState(e,t)}requestReresolution(){var e;const t=(e=this.parent.pendingChild)!==null&&e!==void 0?e:this.parent.currentChild;if(this.child===t){this.parent.channelControlHelper.requestReresolution()}}setChild(e){this.child=e}addChannelzChild(e){this.parent.channelControlHelper.addChannelzChild(e)}removeChannelzChild(e){this.parent.channelControlHelper.removeChannelzChild(e)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}updateAddressList(e,t,n){let i;if(this.currentChild===null||this.currentChild.getTypeName()!==t.getLoadBalancerName()){const e=new this.ChildPolicyHelper(this);const n=r.createLoadBalancer(t,e);e.setChild(n);if(this.currentChild===null){this.currentChild=n;i=this.currentChild}else{if(this.pendingChild){this.pendingChild.destroy()}this.pendingChild=n;i=this.pendingChild}}else{if(this.pendingChild===null){i=this.currentChild}else{i=this.pendingChild}}i.updateAddressList(e,t,n)}exitIdle(){if(this.currentChild){this.currentChild.exitIdle();if(this.pendingChild){this.pendingChild.exitIdle()}}}resetBackoff(){if(this.currentChild){this.currentChild.resetBackoff();if(this.pendingChild){this.pendingChild.resetBackoff()}}}destroy(){if(this.currentChild){this.currentChild.destroy();this.currentChild=null}if(this.pendingChild){this.pendingChild.destroy();this.pendingChild=null}}getTypeName(){return s}}t.ChildLoadBalancerHandler=ChildLoadBalancerHandler},2057:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setup=t.OutlierDetectionLoadBalancer=t.OutlierDetectionLoadBalancingConfig=void 0;const r=n(8480);const i=n(8215);const s=n(6352);const a=n(9006);const o=n(3995);const l=n(4106);const c=n(9046);const u=n(1576);const d=n(9920);const h=n(9121);const f="outlier_detection";const p=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION==="true";const m={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100};const g={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function validateFieldType(e,t,n,r){if(t in e&&typeof e[t]!==n){const i=r?`${r}.${t}`:t;throw new Error(`outlier detection config ${i} parse error: expected ${n}, got ${typeof e[t]}`)}}function validatePositiveDuration(e,t,n){const r=n?`${n}.${t}`:t;if(t in e){if(!s.isDuration(e[t])){throw new Error(`outlier detection config ${r} parse error: expected Duration, got ${typeof e[t]}`)}if(!(e[t].seconds>=0&&e[t].seconds<=315576e6&&e[t].nanos>=0&&e[t].nanos<=999999999)){throw new Error(`outlier detection config ${r} parse error: values out of range for non-negative Duaration`)}}}function validatePercentage(e,t,n){const r=n?`${n}.${t}`:t;validateFieldType(e,t,"number",n);if(t in e&&!(e[t]>=0&&e[t]<=100)){throw new Error(`outlier detection config ${r} parse error: value out of range for percentage (0-100)`)}}class OutlierDetectionLoadBalancingConfig{constructor(e,t,n,r,i,s,a){this.childPolicy=a;this.intervalMs=e!==null&&e!==void 0?e:1e4;this.baseEjectionTimeMs=t!==null&&t!==void 0?t:3e4;this.maxEjectionTimeMs=n!==null&&n!==void 0?n:3e5;this.maxEjectionPercent=r!==null&&r!==void 0?r:10;this.successRateEjection=i?Object.assign(Object.assign({},m),i):null;this.failurePercentageEjection=s?Object.assign(Object.assign({},g),s):null}getLoadBalancerName(){return f}toJsonObject(){return{interval:s.msToDuration(this.intervalMs),base_ejection_time:s.msToDuration(this.baseEjectionTimeMs),max_ejection_time:s.msToDuration(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map((e=>e.toJsonObject()))}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new OutlierDetectionLoadBalancingConfig(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;validatePositiveDuration(e,"interval");validatePositiveDuration(e,"base_ejection_time");validatePositiveDuration(e,"max_ejection_time");validatePercentage(e,"max_ejection_percent");if("success_rate_ejection"in e){if(typeof e.success_rate_ejection!=="object"){throw new Error("outlier detection config success_rate_ejection must be an object")}validateFieldType(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection");validatePercentage(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection");validateFieldType(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection");validateFieldType(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!=="object"){throw new Error("outlier detection config failure_percentage_ejection must be an object")}validatePercentage(e.failure_percentage_ejection,"threshold","failure_percentage_ejection");validatePercentage(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection");validateFieldType(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection");validateFieldType(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new OutlierDetectionLoadBalancingConfig(e.interval?s.durationToMs(e.interval):null,e.base_ejection_time?s.durationToMs(e.base_ejection_time):null,e.max_ejection_time?s.durationToMs(e.max_ejection_time):null,(t=e.max_ejection_percent)!==null&&t!==void 0?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(l.validateLoadBalancingConfig))}}t.OutlierDetectionLoadBalancingConfig=OutlierDetectionLoadBalancingConfig;class OutlierDetectionSubchannelWrapper extends h.BaseSubchannelWrapper{constructor(e,t){super(e);this.mapEntry=t;this.childSubchannelState=r.ConnectivityState.IDLE;this.stateListeners=[];this.ejected=false;this.refCount=0;e.addConnectivityStateListener(((e,t,n)=>{this.childSubchannelState=n;if(!this.ejected){for(const e of this.stateListeners){e(this,t,n)}}}))}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){const t=this.stateListeners.indexOf(e);if(t>-1){this.stateListeners.splice(t,1)}}ref(){this.child.ref();this.refCount+=1}unref(){this.child.unref();this.refCount-=1;if(this.refCount<=0){if(this.mapEntry){const e=this.mapEntry.subchannelWrappers.indexOf(this);if(e>=0){this.mapEntry.subchannelWrappers.splice(e,1)}}}}eject(){this.ejected=true;for(const e of this.stateListeners){e(this,this.childSubchannelState,r.ConnectivityState.TRANSIENT_FAILURE)}}uneject(){this.ejected=false;for(const e of this.stateListeners){e(this,r.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState)}}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function createEmptyBucket(){return{success:0,failure:0}}class CallCounter{constructor(){this.activeBucket=createEmptyBucket();this.inactiveBucket=createEmptyBucket()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket;this.activeBucket=createEmptyBucket()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class OutlierDetectionCounterFilter extends o.BaseFilter{constructor(e){super();this.callCounter=e}receiveTrailers(e){if(e.code===i.Status.OK){this.callCounter.addSuccess()}else{this.callCounter.addFailure()}return e}}class OutlierDetectionCounterFilterFactory{constructor(e){this.callCounter=e}createFilter(e){return new OutlierDetectionCounterFilter(this.callCounter)}}class OutlierDetectionPicker{constructor(e){this.wrappedPicker=e}pick(e){const t=this.wrappedPicker.pick(e);if(t.pickResultType===u.PickResultType.COMPLETE){const e=t.subchannel;const n=e.getMapEntry();if(n){return Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel(),extraFilterFactories:[...t.extraFilterFactories,new OutlierDetectionCounterFilterFactory(n.counter)]})}else{return t}}else{return t}}}class OutlierDetectionLoadBalancer{constructor(e){this.addressMap=new Map;this.latestConfig=null;this.childBalancer=new c.ChildLoadBalancerHandler(a.createChildChannelControlHelper(e,{createSubchannel:(t,n)=>{const r=e.createSubchannel(t,n);const i=this.addressMap.get(d.subchannelAddressToString(t));const s=new OutlierDetectionSubchannelWrapper(r,i);i===null||i===void 0?void 0:i.subchannelWrappers.push(s);return s},updateState:(t,n)=>{if(t===r.ConnectivityState.READY){e.updateState(t,new OutlierDetectionPicker(n))}else{e.updateState(t,n)}}}));this.ejectionTimer=setInterval((()=>{}),0);clearInterval(this.ejectionTimer)}getCurrentEjectionPercent(){let e=0;for(const t of this.addressMap.values()){if(t.currentEjectionTimestamp!==null){e+=1}}return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig){return}const t=this.latestConfig.getSuccessRateEjectionConfig();if(!t){return}const n=t.request_volume;let r=0;const i=[];for(const e of this.addressMap.values()){const t=e.counter.getLastSuccesses();const s=e.counter.getLastFailures();if(t+s>=n){r+=1;i.push(t/(t+s))}}if(r<t.minimum_hosts){return}const s=i.reduce(((e,t)=>e+t));let a=0;for(const e of i){const t=e-s;a+=t*t}const o=Math.sqrt(a);const l=s-o*(t.stdev_factor/1e3);for(const r of this.addressMap.values()){if(this.getCurrentEjectionPercent()>this.latestConfig.getMaxEjectionPercent()){break}const i=r.counter.getLastSuccesses();const s=r.counter.getLastFailures();if(i+s<n){continue}const a=i/(i+s);if(a<l){const n=Math.random()*100;if(n<t.enforcement_percentage){this.eject(r,e)}}}}runFailurePercentageCheck(e){if(!this.latestConfig){return}const t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t){return}if(this.addressMap.size<t.minimum_hosts){return}for(const n of this.addressMap.values()){if(this.getCurrentEjectionPercent()>this.latestConfig.getMaxEjectionPercent()){break}const r=n.counter.getLastSuccesses();const i=n.counter.getLastFailures();if(r+i<t.request_volume){continue}const s=i*100/(i+r);if(s>t.threshold){const r=Math.random()*100;if(r<t.enforcement_percentage){this.eject(n,e)}}}}eject(e,t){e.currentEjectionTimestamp=new Date;e.ejectionTimeMultiplier+=1;for(const t of e.subchannelWrappers){t.eject()}}uneject(e){e.currentEjectionTimestamp=null;for(const t of e.subchannelWrappers){t.uneject()}}runChecks(){const e=new Date;for(const e of this.addressMap.values()){e.counter.switchBuckets()}if(!this.latestConfig){return}this.runSuccessRateCheck(e);this.runFailurePercentageCheck(e);for(const e of this.addressMap.values()){if(e.currentEjectionTimestamp===null){if(e.ejectionTimeMultiplier>0){e.ejectionTimeMultiplier-=1}}else{const t=this.latestConfig.getBaseEjectionTimeMs();const n=this.latestConfig.getMaxEjectionTimeMs();const r=new Date(e.currentEjectionTimestamp.getTime());r.setMilliseconds(r.getMilliseconds()+Math.min(t*e.ejectionTimeMultiplier,Math.max(t,n)));if(r<new Date){this.uneject(e)}}}}updateAddressList(e,t,n){if(!(t instanceof OutlierDetectionLoadBalancingConfig)){return}const r=new Set;for(const t of e){r.add(d.subchannelAddressToString(t))}for(const e of r){if(!this.addressMap.has(e)){this.addressMap.set(e,{counter:new CallCounter,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]})}}for(const e of this.addressMap.keys()){if(!r.has(e)){this.addressMap.delete(e)}}const i=l.getFirstUsableConfig(t.getChildPolicy(),true);this.childBalancer.updateAddressList(e,i,n);if(this.latestConfig===null||this.latestConfig.getIntervalMs()!==t.getIntervalMs()){clearInterval(this.ejectionTimer);this.ejectionTimer=setInterval((()=>this.runChecks()),t.getIntervalMs())}this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){this.childBalancer.destroy()}getTypeName(){return f}}t.OutlierDetectionLoadBalancer=OutlierDetectionLoadBalancer;function setup(){if(p){a.registerLoadBalancerType(f,OutlierDetectionLoadBalancer,OutlierDetectionLoadBalancingConfig)}}t.setup=setup},9956:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setup=t.PickFirstLoadBalancer=t.PickFirstLoadBalancingConfig=void 0;const r=n(4106);const i=n(8480);const s=n(1576);const a=n(9920);const o=n(8221);const l=n(8215);const c="pick_first";function trace(e){o.trace(l.LogVerbosity.DEBUG,c,e)}const u="pick_first";const d=250;class PickFirstLoadBalancingConfig{getLoadBalancerName(){return u}constructor(){}toJsonObject(){return{[u]:{}}}static createFromJson(e){return new PickFirstLoadBalancingConfig}}t.PickFirstLoadBalancingConfig=PickFirstLoadBalancingConfig;class PickFirstPicker{constructor(e){this.subchannel=e}pick(e){return{pickResultType:s.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,extraFilterFactories:[],onCallStarted:null}}}class PickFirstLoadBalancer{constructor(e){this.channelControlHelper=e;this.latestAddressList=[];this.subchannels=[];this.currentState=i.ConnectivityState.IDLE;this.currentSubchannelIndex=0;this.currentPick=null;this.triedAllSubchannels=false;this.subchannelStateCounts={[i.ConnectivityState.CONNECTING]:0,[i.ConnectivityState.IDLE]:0,[i.ConnectivityState.READY]:0,[i.ConnectivityState.SHUTDOWN]:0,[i.ConnectivityState.TRANSIENT_FAILURE]:0};this.subchannelStateListener=(e,t,n)=>{this.subchannelStateCounts[t]-=1;this.subchannelStateCounts[n]+=1;if(e===this.subchannels[this.currentSubchannelIndex]&&n===i.ConnectivityState.TRANSIENT_FAILURE){this.startNextSubchannelConnecting()}if(n===i.ConnectivityState.READY){this.pickSubchannel(e);return}else{if(this.triedAllSubchannels&&this.subchannelStateCounts[i.ConnectivityState.IDLE]===this.subchannels.length){this.resetSubchannelList(false);this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this));return}if(this.currentPick===null){if(this.triedAllSubchannels){let e;if(this.subchannelStateCounts[i.ConnectivityState.CONNECTING]>0){e=i.ConnectivityState.CONNECTING}else if(this.subchannelStateCounts[i.ConnectivityState.TRANSIENT_FAILURE]>0){e=i.ConnectivityState.TRANSIENT_FAILURE}else{e=i.ConnectivityState.IDLE}if(e!==this.currentState){if(e===i.ConnectivityState.TRANSIENT_FAILURE){this.updateState(e,new s.UnavailablePicker)}else{this.updateState(e,new s.QueuePicker(this))}}}else{this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}}}};this.pickedSubchannelStateListener=(e,t,n)=>{if(n!==i.ConnectivityState.READY){this.currentPick=null;e.unref();e.removeConnectivityStateListener(this.pickedSubchannelStateListener);this.channelControlHelper.removeChannelzChild(e.getChannelzRef());if(this.subchannels.length>0){if(this.triedAllSubchannels){let e;if(this.subchannelStateCounts[i.ConnectivityState.CONNECTING]>0){e=i.ConnectivityState.CONNECTING}else if(this.subchannelStateCounts[i.ConnectivityState.TRANSIENT_FAILURE]>0){e=i.ConnectivityState.TRANSIENT_FAILURE}else{e=i.ConnectivityState.IDLE}if(e===i.ConnectivityState.TRANSIENT_FAILURE){this.updateState(e,new s.UnavailablePicker)}else{this.updateState(e,new s.QueuePicker(this))}}else{this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}}else{this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this))}}};this.connectionDelayTimeout=setTimeout((()=>{}),0);clearTimeout(this.connectionDelayTimeout)}startNextSubchannelConnecting(){if(this.triedAllSubchannels){return}for(const[e,t]of this.subchannels.entries()){if(e>this.currentSubchannelIndex){const n=t.getConnectivityState();if(n===i.ConnectivityState.IDLE||n===i.ConnectivityState.CONNECTING){this.startConnecting(e);return}}}this.triedAllSubchannels=true}startConnecting(e){clearTimeout(this.connectionDelayTimeout);this.currentSubchannelIndex=e;if(this.subchannels[e].getConnectivityState()===i.ConnectivityState.IDLE){trace("Start connecting to subchannel with address "+this.subchannels[e].getAddress());process.nextTick((()=>{this.subchannels[e].startConnecting()}))}this.connectionDelayTimeout=setTimeout((()=>{this.startNextSubchannelConnecting()}),d)}pickSubchannel(e){trace("Pick subchannel with address "+e.getAddress());if(this.currentPick!==null){this.currentPick.unref();this.currentPick.removeConnectivityStateListener(this.pickedSubchannelStateListener)}this.currentPick=e;this.updateState(i.ConnectivityState.READY,new PickFirstPicker(e));e.addConnectivityStateListener(this.pickedSubchannelStateListener);e.ref();this.channelControlHelper.addChannelzChild(e.getChannelzRef());this.resetSubchannelList();clearTimeout(this.connectionDelayTimeout)}updateState(e,t){trace(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]);this.currentState=e;this.channelControlHelper.updateState(e,t)}resetSubchannelList(e=true){for(const e of this.subchannels){e.removeConnectivityStateListener(this.subchannelStateListener);e.unref();this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}this.currentSubchannelIndex=0;this.subchannelStateCounts={[i.ConnectivityState.CONNECTING]:0,[i.ConnectivityState.IDLE]:0,[i.ConnectivityState.READY]:0,[i.ConnectivityState.SHUTDOWN]:0,[i.ConnectivityState.TRANSIENT_FAILURE]:0};this.subchannels=[];if(e){this.triedAllSubchannels=false}}connectToAddressList(){this.resetSubchannelList();trace("Connect to address list "+this.latestAddressList.map((e=>a.subchannelAddressToString(e))));this.subchannels=this.latestAddressList.map((e=>this.channelControlHelper.createSubchannel(e,{})));for(const e of this.subchannels){e.ref();this.channelControlHelper.addChannelzChild(e.getChannelzRef())}for(const e of this.subchannels){e.addConnectivityStateListener(this.subchannelStateListener);this.subchannelStateCounts[e.getConnectivityState()]+=1;if(e.getConnectivityState()===i.ConnectivityState.READY){this.pickSubchannel(e);this.resetSubchannelList();return}}for(const[e,t]of this.subchannels.entries()){const n=t.getConnectivityState();if(n===i.ConnectivityState.IDLE||n===i.ConnectivityState.CONNECTING){this.startConnecting(e);if(this.currentPick===null){this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}return}}if(this.currentPick===null){this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker)}}updateAddressList(e,t){if(this.subchannels.length===0||!this.latestAddressList.every(((t,n)=>e[n]===t))){this.latestAddressList=e;this.connectToAddressList()}}exitIdle(){if(this.currentState===i.ConnectivityState.IDLE||this.triedAllSubchannels){this.channelControlHelper.requestReresolution()}for(const e of this.subchannels){e.startConnecting()}if(this.currentState===i.ConnectivityState.IDLE){if(this.latestAddressList.length>0){this.connectToAddressList()}}}resetBackoff(){}destroy(){this.resetSubchannelList();if(this.currentPick!==null){const e=this.currentPick;e.unref();e.removeConnectivityStateListener(this.pickedSubchannelStateListener);this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}getTypeName(){return u}}t.PickFirstLoadBalancer=PickFirstLoadBalancer;function setup(){r.registerLoadBalancerType(u,PickFirstLoadBalancer,PickFirstLoadBalancingConfig);r.registerDefaultLoadBalancerType(u)}t.setup=setup},6761:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setup=t.RoundRobinLoadBalancer=void 0;const r=n(4106);const i=n(8480);const s=n(1576);const a=n(9920);const o=n(8221);const l=n(8215);const c="round_robin";function trace(e){o.trace(l.LogVerbosity.DEBUG,c,e)}const u="round_robin";class RoundRobinLoadBalancingConfig{getLoadBalancerName(){return u}constructor(){}toJsonObject(){return{[u]:{}}}static createFromJson(e){return new RoundRobinLoadBalancingConfig}}class RoundRobinPicker{constructor(e,t=0){this.subchannelList=e;this.nextIndex=t}pick(e){const t=this.subchannelList[this.nextIndex];this.nextIndex=(this.nextIndex+1)%this.subchannelList.length;return{pickResultType:s.PickResultType.COMPLETE,subchannel:t,status:null,extraFilterFactories:[],onCallStarted:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class RoundRobinLoadBalancer{constructor(e){this.channelControlHelper=e;this.subchannels=[];this.currentState=i.ConnectivityState.IDLE;this.currentReadyPicker=null;this.subchannelStateCounts={[i.ConnectivityState.CONNECTING]:0,[i.ConnectivityState.IDLE]:0,[i.ConnectivityState.READY]:0,[i.ConnectivityState.SHUTDOWN]:0,[i.ConnectivityState.TRANSIENT_FAILURE]:0};this.subchannelStateListener=(e,t,n)=>{this.subchannelStateCounts[t]-=1;this.subchannelStateCounts[n]+=1;this.calculateAndUpdateState();if(n===i.ConnectivityState.TRANSIENT_FAILURE||n===i.ConnectivityState.IDLE){this.channelControlHelper.requestReresolution();e.startConnecting()}}}calculateAndUpdateState(){if(this.subchannelStateCounts[i.ConnectivityState.READY]>0){const e=this.subchannels.filter((e=>e.getConnectivityState()===i.ConnectivityState.READY));let t=0;if(this.currentReadyPicker!==null){t=e.indexOf(this.currentReadyPicker.peekNextSubchannel());if(t<0){t=0}}this.updateState(i.ConnectivityState.READY,new RoundRobinPicker(e,t))}else if(this.subchannelStateCounts[i.ConnectivityState.CONNECTING]>0){this.updateState(i.ConnectivityState.CONNECTING,new s.QueuePicker(this))}else if(this.subchannelStateCounts[i.ConnectivityState.TRANSIENT_FAILURE]>0){this.updateState(i.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker)}else{this.updateState(i.ConnectivityState.IDLE,new s.QueuePicker(this))}}updateState(e,t){trace(i.ConnectivityState[this.currentState]+" -> "+i.ConnectivityState[e]);if(e===i.ConnectivityState.READY){this.currentReadyPicker=t}else{this.currentReadyPicker=null}this.currentState=e;this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(const e of this.subchannels){e.removeConnectivityStateListener(this.subchannelStateListener);e.unref();this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}this.subchannelStateCounts={[i.ConnectivityState.CONNECTING]:0,[i.ConnectivityState.IDLE]:0,[i.ConnectivityState.READY]:0,[i.ConnectivityState.SHUTDOWN]:0,[i.ConnectivityState.TRANSIENT_FAILURE]:0};this.subchannels=[]}updateAddressList(e,t){this.resetSubchannelList();trace("Connect to address list "+e.map((e=>a.subchannelAddressToString(e))));this.subchannels=e.map((e=>this.channelControlHelper.createSubchannel(e,{})));for(const e of this.subchannels){e.ref();e.addConnectivityStateListener(this.subchannelStateListener);this.channelControlHelper.addChannelzChild(e.getChannelzRef());const t=e.getConnectivityState();this.subchannelStateCounts[t]+=1;if(t===i.ConnectivityState.IDLE||t===i.ConnectivityState.TRANSIENT_FAILURE){e.startConnecting()}}this.calculateAndUpdateState()}exitIdle(){for(const e of this.subchannels){e.startConnecting()}}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return u}}t.RoundRobinLoadBalancer=RoundRobinLoadBalancer;function setup(){r.registerLoadBalancerType(u,RoundRobinLoadBalancer,RoundRobinLoadBalancingConfig)}t.setup=setup},4106:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.validateLoadBalancingConfig=t.getFirstUsableConfig=t.isLoadBalancerNameRegistered=t.createLoadBalancer=t.registerDefaultLoadBalancerType=t.registerLoadBalancerType=t.createChildChannelControlHelper=void 0;function createChildChannelControlHelper(e,t){var n,r,i,s,a,o,l,c,u,d;return{createSubchannel:(r=(n=t.createSubchannel)===null||n===void 0?void 0:n.bind(t))!==null&&r!==void 0?r:e.createSubchannel.bind(e),updateState:(s=(i=t.updateState)===null||i===void 0?void 0:i.bind(t))!==null&&s!==void 0?s:e.updateState.bind(e),requestReresolution:(o=(a=t.requestReresolution)===null||a===void 0?void 0:a.bind(t))!==null&&o!==void 0?o:e.requestReresolution.bind(e),addChannelzChild:(c=(l=t.addChannelzChild)===null||l===void 0?void 0:l.bind(t))!==null&&c!==void 0?c:e.addChannelzChild.bind(e),removeChannelzChild:(d=(u=t.removeChannelzChild)===null||u===void 0?void 0:u.bind(t))!==null&&d!==void 0?d:e.removeChannelzChild.bind(e)}}t.createChildChannelControlHelper=createChildChannelControlHelper;const n={};let r=null;function registerLoadBalancerType(e,t,r){n[e]={LoadBalancer:t,LoadBalancingConfig:r}}t.registerLoadBalancerType=registerLoadBalancerType;function registerDefaultLoadBalancerType(e){r=e}t.registerDefaultLoadBalancerType=registerDefaultLoadBalancerType;function createLoadBalancer(e,t){const r=e.getLoadBalancerName();if(r in n){return new n[r].LoadBalancer(t)}else{return null}}t.createLoadBalancer=createLoadBalancer;function isLoadBalancerNameRegistered(e){return e in n}t.isLoadBalancerNameRegistered=isLoadBalancerNameRegistered;function getFirstUsableConfig(e,t=false){for(const t of e){if(t.getLoadBalancerName()in n){return t}}if(t){if(r){return new n[r].LoadBalancingConfig}else{return null}}else{return null}}t.getFirstUsableConfig=getFirstUsableConfig;function validateLoadBalancingConfig(e){if(!(e!==null&&typeof e==="object")){throw new Error("Load balancing config must be an object")}const t=Object.keys(e);if(t.length!==1){throw new Error("Provided load balancing config has multiple conflicting entries")}const r=t[0];if(r in n){return n[r].LoadBalancingConfig.createFromJson(e[r])}else{throw new Error(`Unrecognized load balancing config name ${r}`)}}t.validateLoadBalancingConfig=validateLoadBalancingConfig},8221:(e,t,n)=>{"use strict";var r,i,s,a;Object.defineProperty(t,"__esModule",{value:true});t.isTracerEnabled=t.trace=t.log=t.setLoggerVerbosity=t.setLogger=t.getLogger=void 0;const o=n(8215);const l={error:(e,...t)=>{console.error("E "+e,...t)},info:(e,...t)=>{console.error("I "+e,...t)},debug:(e,...t)=>{console.error("D "+e,...t)}};let c=l;let u=o.LogVerbosity.ERROR;const d=(i=(r=process.env.GRPC_NODE_VERBOSITY)!==null&&r!==void 0?r:process.env.GRPC_VERBOSITY)!==null&&i!==void 0?i:"";switch(d.toUpperCase()){case"DEBUG":u=o.LogVerbosity.DEBUG;break;case"INFO":u=o.LogVerbosity.INFO;break;case"ERROR":u=o.LogVerbosity.ERROR;break;case"NONE":u=o.LogVerbosity.NONE;break;default:}t.getLogger=()=>c;t.setLogger=e=>{c=e};t.setLoggerVerbosity=e=>{u=e};t.log=(e,...t)=>{let n;if(e>=u){switch(e){case o.LogVerbosity.DEBUG:n=c.debug;break;case o.LogVerbosity.INFO:n=c.info;break;case o.LogVerbosity.ERROR:n=c.error;break}if(!n){n=c.error}if(n){n.bind(c)(...t)}}};const h=(a=(s=process.env.GRPC_NODE_TRACE)!==null&&s!==void 0?s:process.env.GRPC_TRACE)!==null&&a!==void 0?a:"";const f=new Set;const p=new Set;for(const e of h.split(",")){if(e.startsWith("-")){p.add(e.substring(1))}else{f.add(e)}}const m=f.has("all");function trace(e,n,r){if(isTracerEnabled(n)){t.log(e,(new Date).toISOString()+" | "+n+" | "+r)}}t.trace=trace;function isTracerEnabled(e){return!p.has(e)&&(m||f.has(e))}t.isTracerEnabled=isTracerEnabled},1468:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.loadPackageDefinition=t.makeClientConstructor=void 0;const r=n(4153);const i={unary:r.Client.prototype.makeUnaryRequest,server_stream:r.Client.prototype.makeServerStreamRequest,client_stream:r.Client.prototype.makeClientStreamRequest,bidi:r.Client.prototype.makeBidiStreamRequest};function isPrototypePolluted(e){return["__proto__","prototype","constructor"].includes(e)}function makeClientConstructor(e,t,n){if(!n){n={}}class ServiceClientImpl extends r.Client{}Object.keys(e).forEach((t=>{if(isPrototypePolluted(t)){return}const n=e[t];let r;if(typeof t==="string"&&t.charAt(0)==="$"){throw new Error("Method names cannot start with $")}if(n.requestStream){if(n.responseStream){r="bidi"}else{r="client_stream"}}else{if(n.responseStream){r="server_stream"}else{r="unary"}}const s=n.requestSerialize;const a=n.responseDeserialize;const o=partial(i[r],n.path,s,a);ServiceClientImpl.prototype[t]=o;Object.assign(ServiceClientImpl.prototype[t],n);if(n.originalName&&!isPrototypePolluted(n.originalName)){ServiceClientImpl.prototype[n.originalName]=ServiceClientImpl.prototype[t]}}));ServiceClientImpl.service=e;ServiceClientImpl.serviceName=t;return ServiceClientImpl}t.makeClientConstructor=makeClientConstructor;function partial(e,t,n,r){return function(...i){return e.call(this,t,n,r,...i)}}function isProtobufTypeDefinition(e){return"format"in e}function loadPackageDefinition(e){const t={};for(const n in e){if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];const i=n.split(".");if(i.some((e=>isPrototypePolluted(e)))){continue}const s=i[i.length-1];let a=t;for(const e of i.slice(0,-1)){if(!a[e]){a[e]={}}a=a[e]}if(isProtobufTypeDefinition(r)){a[s]=r}else{a[s]=makeClientConstructor(r,s,{})}}}return t}t.loadPackageDefinition=loadPackageDefinition},4401:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.MaxMessageSizeFilterFactory=t.MaxMessageSizeFilter=void 0;const r=n(3995);const i=n(8215);class MaxMessageSizeFilter extends r.BaseFilter{constructor(e,t){super();this.options=e;this.callStream=t;this.maxSendMessageSize=i.DEFAULT_MAX_SEND_MESSAGE_LENGTH;this.maxReceiveMessageSize=i.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;if("grpc.max_send_message_length"in e){this.maxSendMessageSize=e["grpc.max_send_message_length"]}if("grpc.max_receive_message_length"in e){this.maxReceiveMessageSize=e["grpc.max_receive_message_length"]}}async sendMessage(e){if(this.maxSendMessageSize===-1){return e}else{const t=await e;if(t.message.length>this.maxSendMessageSize){this.callStream.cancelWithStatus(i.Status.RESOURCE_EXHAUSTED,`Sent message larger than max (${t.message.length} vs. ${this.maxSendMessageSize})`);return Promise.reject("Message too large")}else{return t}}}async receiveMessage(e){if(this.maxReceiveMessageSize===-1){return e}else{const t=await e;if(t.length>this.maxReceiveMessageSize){this.callStream.cancelWithStatus(i.Status.RESOURCE_EXHAUSTED,`Received message larger than max (${t.length} vs. ${this.maxReceiveMessageSize})`);return Promise.reject("Message too large")}else{return t}}}}t.MaxMessageSizeFilter=MaxMessageSizeFilter;class MaxMessageSizeFilterFactory{constructor(e){this.options=e}createFilter(e){return new MaxMessageSizeFilter(this.options,e)}}t.MaxMessageSizeFilterFactory=MaxMessageSizeFilterFactory},6489:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Metadata=void 0;const r=n(8221);const i=n(8215);const s=/^[0-9a-z_.-]+$/;const a=/^[ -~]*$/;function isLegalKey(e){return s.test(e)}function isLegalNonBinaryValue(e){return a.test(e)}function isBinaryKey(e){return e.endsWith("-bin")}function isCustomMetadata(e){return!e.startsWith("grpc-")}function normalizeKey(e){return e.toLowerCase()}function validate(e,t){if(!isLegalKey(e)){throw new Error('Metadata key "'+e+'" contains illegal characters')}if(t!==null&&t!==undefined){if(isBinaryKey(e)){if(!(t instanceof Buffer)){throw new Error("keys that end with '-bin' must have Buffer values")}}else{if(t instanceof Buffer){throw new Error("keys that don't end with '-bin' must have String values")}if(!isLegalNonBinaryValue(t)){throw new Error('Metadata string value "'+t+'" contains illegal characters')}}}}class Metadata{constructor(e){this.internalRepr=new Map;if(e===undefined){this.options={}}else{this.options=e}}set(e,t){e=normalizeKey(e);validate(e,t);this.internalRepr.set(e,[t])}add(e,t){e=normalizeKey(e);validate(e,t);const n=this.internalRepr.get(e);if(n===undefined){this.internalRepr.set(e,[t])}else{n.push(t)}}remove(e){e=normalizeKey(e);validate(e);this.internalRepr.delete(e)}get(e){e=normalizeKey(e);validate(e);return this.internalRepr.get(e)||[]}getMap(){const e={};this.internalRepr.forEach(((t,n)=>{if(t.length>0){const r=t[0];e[n]=r instanceof Buffer?r.slice():r}}));return e}clone(){const e=new Metadata(this.options);const t=e.internalRepr;this.internalRepr.forEach(((e,n)=>{const r=e.map((e=>{if(e instanceof Buffer){return Buffer.from(e)}else{return e}}));t.set(n,r)}));return e}merge(e){e.internalRepr.forEach(((e,t)=>{const n=(this.internalRepr.get(t)||[]).concat(e);this.internalRepr.set(t,n)}))}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){const e={};this.internalRepr.forEach(((t,n)=>{e[n]=t.map((e=>{if(e instanceof Buffer){return e.toString("base64")}else{return e}}))}));return e}_getCoreRepresentation(){return this.internalRepr}toJSON(){const e={};for(const[t,n]of this.internalRepr.entries()){e[t]=n}return e}static fromHttp2Headers(e){const t=new Metadata;Object.keys(e).forEach((n=>{if(n.charAt(0)===":"){return}const s=e[n];try{if(isBinaryKey(n)){if(Array.isArray(s)){s.forEach((e=>{t.add(n,Buffer.from(e,"base64"))}))}else if(s!==undefined){if(isCustomMetadata(n)){s.split(",").forEach((e=>{t.add(n,Buffer.from(e.trim(),"base64"))}))}else{t.add(n,Buffer.from(s,"base64"))}}}else{if(Array.isArray(s)){s.forEach((e=>{t.add(n,e)}))}else if(s!==undefined){t.add(n,s)}}}catch(e){const t=`Failed to add metadata entry ${n}: ${s}. ${e.message}. For more information see https://github.com/grpc/grpc-node/issues/1173`;r.log(i.LogVerbosity.ERROR,t)}}));return t}}t.Metadata=Metadata},1576:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.QueuePicker=t.UnavailablePicker=t.PickResultType=void 0;const r=n(6489);const i=n(8215);var s;(function(e){e[e["COMPLETE"]=0]="COMPLETE";e[e["QUEUE"]=1]="QUEUE";e[e["TRANSIENT_FAILURE"]=2]="TRANSIENT_FAILURE";e[e["DROP"]=3]="DROP"})(s=t.PickResultType||(t.PickResultType={}));class UnavailablePicker{constructor(e){if(e!==undefined){this.status=e}else{this.status={code:i.Status.UNAVAILABLE,details:"No connection established",metadata:new r.Metadata}}}pick(e){return{pickResultType:s.TRANSIENT_FAILURE,subchannel:null,status:this.status,extraFilterFactories:[],onCallStarted:null}}}t.UnavailablePicker=UnavailablePicker;class QueuePicker{constructor(e){this.loadBalancer=e;this.calledExitIdle=false}pick(e){if(!this.calledExitIdle){process.nextTick((()=>{this.loadBalancer.exitIdle()}));this.calledExitIdle=true}return{pickResultType:s.QUEUE,subchannel:null,status:null,extraFilterFactories:[],onCallStarted:null}}}t.QueuePicker=QueuePicker},8203:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setup=void 0;const r=n(186);const i=n(9523);const s=n(3837);const a=n(4294);const o=n(8215);const l=n(6489);const c=n(8221);const u=n(8215);const d=n(8754);const h=n(1808);const f=n(4237);const p="dns_resolver";function trace(e){c.trace(u.LogVerbosity.DEBUG,p,e)}const m=443;const g=3e4;const v=s.promisify(i.resolveTxt);const y=s.promisify(i.lookup);function mergeArrays(...e){const t=[];for(let n=0;n<Math.max.apply(null,e.map((e=>e.length)));n++){for(const r of e){if(n<r.length){t.push(r[n])}}}return t}class DnsResolver{constructor(e,t,n){var r,i,s;this.target=e;this.listener=t;this.pendingLookupPromise=null;this.pendingTxtPromise=null;this.latestLookupResult=null;this.latestServiceConfig=null;this.latestServiceConfigError=null;this.continueResolving=false;this.isNextResolutionTimerRunning=false;trace("Resolver constructed for target "+d.uriToString(e));const a=d.splitHostPort(e.path);if(a===null){this.ipResult=null;this.dnsHostname=null;this.port=null}else{if(h.isIPv4(a.host)||h.isIPv6(a.host)){this.ipResult=[{host:a.host,port:(r=a.port)!==null&&r!==void 0?r:m}];this.dnsHostname=null;this.port=null}else{this.ipResult=null;this.dnsHostname=a.host;this.port=(i=a.port)!==null&&i!==void 0?i:m}}this.percentage=Math.random()*100;this.defaultResolutionError={code:o.Status.UNAVAILABLE,details:`Name resolution failed for target ${d.uriToString(this.target)}`,metadata:new l.Metadata};const c={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoff=new f.BackoffTimeout((()=>{if(this.continueResolving){this.startResolutionWithBackoff()}}),c);this.backoff.unref();this.minTimeBetweenResolutionsMs=(s=n["grpc.dns_min_time_between_resolutions_ms"])!==null&&s!==void 0?s:g;this.nextResolutionTimer=setTimeout((()=>{}),0);clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){trace("Returning IP address for target "+d.uriToString(this.target));setImmediate((()=>{this.backoff.reset();this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}));return}if(this.dnsHostname===null){trace("Failed to parse DNS address "+d.uriToString(this.target));setImmediate((()=>{this.listener.onError({code:o.Status.UNAVAILABLE,details:`Failed to parse DNS address ${d.uriToString(this.target)}`,metadata:new l.Metadata})}))}else{trace("Looking up DNS hostname "+this.dnsHostname);this.latestLookupResult=null;const e=this.dnsHostname;this.pendingLookupPromise=y(e,{all:true});this.pendingLookupPromise.then((e=>{this.pendingLookupPromise=null;this.backoff.reset();this.backoff.stop();const t=e.filter((e=>e.family===4));const n=e.filter((e=>e.family===6));this.latestLookupResult=mergeArrays(n,t).map((e=>({host:e.address,port:+this.port})));const r="["+this.latestLookupResult.map((e=>e.host+":"+e.port)).join(",")+"]";trace("Resolved addresses for target "+d.uriToString(this.target)+": "+r);if(this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}),(e=>{trace("Resolution error for target "+d.uriToString(this.target)+": "+e.message);this.pendingLookupPromise=null;this.stopNextResolutionTimer();this.listener.onError(this.defaultResolutionError)}));if(this.pendingTxtPromise===null){this.pendingTxtPromise=v(e);this.pendingTxtPromise.then((e=>{this.pendingTxtPromise=null;try{this.latestServiceConfig=a.extractAndSelectServiceConfig(e,this.percentage)}catch(e){this.latestServiceConfigError={code:o.Status.UNAVAILABLE,details:"Parsing service config failed",metadata:new l.Metadata}}if(this.latestLookupResult!==null){this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}}),(e=>{}))}}}startNextResolutionTimer(){var e,t;this.nextResolutionTimer=(t=(e=setTimeout((()=>{this.stopNextResolutionTimer();if(this.continueResolving){this.startResolutionWithBackoff()}}),this.minTimeBetweenResolutionsMs)).unref)===null||t===void 0?void 0:t.call(e);this.isNextResolutionTimerRunning=true}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer);this.isNextResolutionTimerRunning=false}startResolutionWithBackoff(){this.continueResolving=false;this.startResolution();this.backoff.runOnce();this.startNextResolutionTimer()}updateResolution(){if(this.pendingLookupPromise===null){if(this.isNextResolutionTimerRunning||this.backoff.isRunning()){this.continueResolving=true}else{this.startResolutionWithBackoff()}}}destroy(){this.continueResolving=false;this.backoff.stop();this.stopNextResolutionTimer()}static getDefaultAuthority(e){return e.path}}function setup(){r.registerResolver("dns",DnsResolver);r.registerDefaultScheme("dns")}t.setup=setup},7447:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setup=void 0;const r=n(1808);const i=n(8215);const s=n(6489);const a=n(186);const o=n(8754);const l=n(8221);const c="ip_resolver";function trace(e){l.trace(i.LogVerbosity.DEBUG,c,e)}const u="ipv4";const d="ipv6";const h=443;class IpResolver{constructor(e,t,n){var a;this.target=e;this.listener=t;this.addresses=[];this.error=null;trace("Resolver constructed for target "+o.uriToString(e));const l=[];if(!(e.scheme===u||e.scheme===d)){this.error={code:i.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new s.Metadata};return}const c=e.path.split(",");for(const t of c){const n=o.splitHostPort(t);if(n===null){this.error={code:i.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new s.Metadata};return}if(e.scheme===u&&!r.isIPv4(n.host)||e.scheme===d&&!r.isIPv6(n.host)){this.error={code:i.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new s.Metadata};return}l.push({host:n.host,port:(a=n.port)!==null&&a!==void 0?a:h})}this.addresses=l;trace("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){process.nextTick((()=>{if(this.error){this.listener.onError(this.error)}else{this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}}))}destroy(){}static getDefaultAuthority(e){return e.path.split(",")[0]}}function setup(){a.registerResolver(u,IpResolver);a.registerResolver(d,IpResolver)}t.setup=setup},5933:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.setup=void 0;const r=n(186);class UdsResolver{constructor(e,t,n){this.listener=t;this.addresses=[];let r;if(e.authority===""){r="/"+e.path}else{r=e.path}this.addresses=[{path:r}]}updateResolution(){process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{})}destroy(){}static getDefaultAuthority(e){return"localhost"}}function setup(){r.registerResolver("unix",UdsResolver)}t.setup=setup},186:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.mapUriDefaultScheme=t.getDefaultAuthority=t.createResolver=t.registerDefaultScheme=t.registerResolver=void 0;const r=n(8754);const i={};let s=null;function registerResolver(e,t){i[e]=t}t.registerResolver=registerResolver;function registerDefaultScheme(e){s=e}t.registerDefaultScheme=registerDefaultScheme;function createResolver(e,t,n){if(e.scheme!==undefined&&e.scheme in i){return new i[e.scheme](e,t,n)}else{throw new Error(`No resolver could be created for target ${r.uriToString(e)}`)}}t.createResolver=createResolver;function getDefaultAuthority(e){if(e.scheme!==undefined&&e.scheme in i){return i[e.scheme].getDefaultAuthority(e)}else{throw new Error(`Invalid target ${r.uriToString(e)}`)}}t.getDefaultAuthority=getDefaultAuthority;function mapUriDefaultScheme(e){if(e.scheme===undefined||!(e.scheme in i)){if(s!==null){return{scheme:s,authority:undefined,path:r.uriToString(e)}}else{return null}}return e}t.mapUriDefaultScheme=mapUriDefaultScheme},5478:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ResolvingLoadBalancer=void 0;const r=n(4106);const i=n(4294);const s=n(8480);const a=n(186);const o=n(1576);const l=n(4237);const c=n(8215);const u=n(6489);const d=n(8221);const h=n(8215);const f=n(8754);const p=n(9046);const m="resolving_load_balancer";function trace(e){d.trace(h.LogVerbosity.DEBUG,m,e)}const g="pick_first";function getDefaultConfigSelector(e){return function defaultConfigSelector(t,n){var r,i;const s=t.split("/").filter((e=>e.length>0));const a=(r=s[0])!==null&&r!==void 0?r:"";const o=(i=s[1])!==null&&i!==void 0?i:"";if(e&&e.methodConfig){for(const t of e.methodConfig){for(const e of t.name){if(e.service===a&&(e.method===undefined||e.method===o)){return{methodConfig:t,pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}}}}return{methodConfig:{name:[]},pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}}class ResolvingLoadBalancer{constructor(e,t,n,d,h){this.target=e;this.channelControlHelper=t;this.channelOptions=n;this.onSuccessfulResolution=d;this.onFailedResolution=h;this.latestChildState=s.ConnectivityState.IDLE;this.latestChildPicker=new o.QueuePicker(this);this.currentState=s.ConnectivityState.IDLE;this.previousServiceConfig=null;this.continueResolving=false;if(n["grpc.service_config"]){this.defaultServiceConfig=i.validateServiceConfig(JSON.parse(n["grpc.service_config"]))}else{this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]}}this.updateState(s.ConnectivityState.IDLE,new o.QueuePicker(this));this.childLoadBalancer=new p.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{if(this.backoffTimeout.isRunning()){this.continueResolving=true}else{this.updateResolution()}},updateState:(e,t)=>{this.latestChildState=e;this.latestChildPicker=t;this.updateState(e,t)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)});this.innerResolver=a.createResolver(e,{onSuccessfulResolution:(e,t,n,i,s)=>{var a;let o=null;if(t===null){if(n===null){this.previousServiceConfig=null;o=this.defaultServiceConfig}else{if(this.previousServiceConfig===null){this.handleResolutionFailure(n)}else{o=this.previousServiceConfig}}}else{o=t;this.previousServiceConfig=t}const l=(a=o===null||o===void 0?void 0:o.loadBalancingConfig)!==null&&a!==void 0?a:[];const d=r.getFirstUsableConfig(l,true);if(d===null){this.handleResolutionFailure({code:c.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new u.Metadata});return}this.childLoadBalancer.updateAddressList(e,d,s);const h=o!==null&&o!==void 0?o:this.defaultServiceConfig;this.onSuccessfulResolution(i!==null&&i!==void 0?i:getDefaultConfigSelector(h))},onError:e=>{this.handleResolutionFailure(e)}},n);const f={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new l.BackoffTimeout((()=>{if(this.continueResolving){this.updateResolution();this.continueResolving=false}else{this.updateState(this.latestChildState,this.latestChildPicker)}}),f);this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution();if(this.currentState===s.ConnectivityState.IDLE){this.updateState(s.ConnectivityState.CONNECTING,new o.QueuePicker(this))}this.backoffTimeout.runOnce()}updateState(e,t){trace(f.uriToString(this.target)+" "+s.ConnectivityState[this.currentState]+" -> "+s.ConnectivityState[e]);if(e===s.ConnectivityState.IDLE){t=new o.QueuePicker(this)}this.currentState=e;this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){if(this.latestChildState===s.ConnectivityState.IDLE){this.updateState(s.ConnectivityState.TRANSIENT_FAILURE,new o.UnavailablePicker(e));this.onFailedResolution(e)}}exitIdle(){if(this.currentState===s.ConnectivityState.IDLE||this.currentState===s.ConnectivityState.TRANSIENT_FAILURE){if(this.backoffTimeout.isRunning()){this.continueResolving=true}else{this.updateResolution()}}this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset();this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy();this.innerResolver.destroy();this.updateState(s.ConnectivityState.SHUTDOWN,new o.UnavailablePicker)}getTypeName(){return"resolving_load_balancer"}}t.ResolvingLoadBalancer=ResolvingLoadBalancer},1517:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Http2ServerCallStream=t.ServerDuplexStreamImpl=t.ServerWritableStreamImpl=t.ServerReadableStreamImpl=t.ServerUnaryCallImpl=void 0;const r=n(2361);const i=n(5158);const s=n(2781);const a=n(9796);const o=n(8215);const l=n(6489);const c=n(4821);const u=n(8221);const d="server_call";function trace(e){u.trace(o.LogVerbosity.DEBUG,d,e)}const h="grpc-accept-encoding";const f="grpc-encoding";const p="grpc-message";const m="grpc-status";const g="grpc-timeout";const v=/(\d{1,8})\s*([HMSmun])/;const y={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6};const S={[h]:"identity,deflate,gzip",[f]:"identity",[i.constants.HTTP2_HEADER_STATUS]:i.constants.HTTP_STATUS_OK,[i.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"};const b={waitForTrailers:true};class ServerUnaryCallImpl extends r.EventEmitter{constructor(e,t,n){super();this.call=e;this.metadata=t;this.request=n;this.cancelled=false;this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}}t.ServerUnaryCallImpl=ServerUnaryCallImpl;class ServerReadableStreamImpl extends s.Readable{constructor(e,t,n,r){super({objectMode:true});this.call=e;this.metadata=t;this.deserialize=n;this.cancelled=false;this.call.setupSurfaceCall(this);this.call.setupReadable(this,r)}_read(e){if(!this.call.consumeUnpushedMessages(this)){return}this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}}t.ServerReadableStreamImpl=ServerReadableStreamImpl;class ServerWritableStreamImpl extends s.Writable{constructor(e,t,n,r){super({objectMode:true});this.call=e;this.metadata=t;this.serialize=n;this.request=r;this.cancelled=false;this.trailingMetadata=new l.Metadata;this.call.setupSurfaceCall(this);this.on("error",(e=>{this.call.sendError(e);this.end()}))}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}_write(e,t,n){try{const t=this.call.serializeMessage(e);if(!this.call.write(t)){this.call.once("drain",n);return}}catch(e){e.code=o.Status.INTERNAL;this.emit("error",e)}n()}_final(e){this.call.sendStatus({code:o.Status.OK,details:"OK",metadata:this.trailingMetadata});e(null)}end(e){if(e){this.trailingMetadata=e}return super.end()}}t.ServerWritableStreamImpl=ServerWritableStreamImpl;class ServerDuplexStreamImpl extends s.Duplex{constructor(e,t,n,r,i){super({objectMode:true});this.call=e;this.metadata=t;this.serialize=n;this.deserialize=r;this.cancelled=false;this.trailingMetadata=new l.Metadata;this.call.setupSurfaceCall(this);this.call.setupReadable(this,i);this.on("error",(e=>{this.call.sendError(e);this.end()}))}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}end(e){if(e){this.trailingMetadata=e}return super.end()}}t.ServerDuplexStreamImpl=ServerDuplexStreamImpl;ServerDuplexStreamImpl.prototype._read=ServerReadableStreamImpl.prototype._read;ServerDuplexStreamImpl.prototype._write=ServerWritableStreamImpl.prototype._write;ServerDuplexStreamImpl.prototype._final=ServerWritableStreamImpl.prototype._final;class Http2ServerCallStream extends r.EventEmitter{constructor(e,t,n){super();this.stream=e;this.handler=t;this.options=n;this.cancelled=false;this.deadlineTimer=setTimeout((()=>{}),0);this.deadline=Infinity;this.wantTrailers=false;this.metadataSent=false;this.canPush=false;this.isPushPending=false;this.bufferedMessages=[];this.messagesToPush=[];this.maxSendMessageSize=o.DEFAULT_MAX_SEND_MESSAGE_LENGTH;this.maxReceiveMessageSize=o.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.stream.once("error",(e=>{}));this.stream.once("close",(()=>{var e;trace("Request to method "+((e=this.handler)===null||e===void 0?void 0:e.path)+" stream closed with rstCode "+this.stream.rstCode);this.cancelled=true;this.emit("cancelled","cancelled");this.emit("streamEnd",false);this.sendStatus({code:o.Status.CANCELLED,details:"Cancelled by client",metadata:new l.Metadata})}));this.stream.on("drain",(()=>{this.emit("drain")}));if("grpc.max_send_message_length"in n){this.maxSendMessageSize=n["grpc.max_send_message_length"]}if("grpc.max_receive_message_length"in n){this.maxReceiveMessageSize=n["grpc.max_receive_message_length"]}clearTimeout(this.deadlineTimer)}checkCancelled(){if(this.stream.destroyed||this.stream.closed){this.cancelled=true}return this.cancelled}getDecompressedMessage(e,t){switch(t){case"deflate":{return new Promise(((n,r)=>{a.inflate(e.slice(5),((e,r)=>{if(e){this.sendError({code:o.Status.INTERNAL,details:`Received "grpc-encoding" header "${t}" but ${t} decompression failed`});n()}else{n(r)}}))}))}case"gzip":{return new Promise(((n,r)=>{a.unzip(e.slice(5),((e,r)=>{if(e){this.sendError({code:o.Status.INTERNAL,details:`Received "grpc-encoding" header "${t}" but ${t} decompression failed`});n()}else{n(r)}}))}))}case"identity":{return Promise.resolve(e.slice(5))}default:{this.sendError({code:o.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`});return Promise.resolve()}}}sendMetadata(e){if(this.checkCancelled()){return}if(this.metadataSent){return}this.metadataSent=true;const t=e?e.toHttp2Headers():null;const n=Object.assign({},S,t);this.stream.respond(n,b)}receiveMetadata(e){const t=l.Metadata.fromHttp2Headers(e);const n=t.get(g);if(n.length>0){const e=n[0].toString().match(v);if(e===null){const e=new Error("Invalid deadline");e.code=o.Status.OUT_OF_RANGE;this.sendError(e);return t}const r=+e[1]*y[e[2]]|0;const i=new Date;this.deadline=i.setMilliseconds(i.getMilliseconds()+r);this.deadlineTimer=setTimeout(handleExpiredDeadline,r,this);t.remove(g)}t.remove(i.constants.HTTP2_HEADER_ACCEPT_ENCODING);t.remove(i.constants.HTTP2_HEADER_TE);t.remove(i.constants.HTTP2_HEADER_CONTENT_TYPE);t.remove("grpc-accept-encoding");return t}receiveUnaryMessage(e){return new Promise(((t,n)=>{const r=this.stream;const i=[];let s=0;r.on("data",(e=>{i.push(e);s+=e.byteLength}));r.once("end",(async()=>{try{const n=Buffer.concat(i,s);if(this.maxReceiveMessageSize!==-1&&n.length>this.maxReceiveMessageSize){this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${n.length} vs. ${this.maxReceiveMessageSize})`});t()}this.emit("receiveMessage");const r=n.readUInt8(0)===1;const a=r?e:"identity";const l=await this.getDecompressedMessage(n,a);if(!l){t()}else{t(this.deserializeMessage(l))}}catch(e){e.code=o.Status.INTERNAL;this.sendError(e);t()}}))}))}serializeMessage(e){const t=this.handler.serialize(e);const n=t.byteLength;const r=Buffer.allocUnsafe(n+5);r.writeUInt8(0,0);r.writeUInt32BE(n,1);t.copy(r,5);return r}deserializeMessage(e){return this.handler.deserialize(e)}async sendUnaryMessage(e,t,n,r){if(this.checkCancelled()){return}if(!n){n=new l.Metadata}if(e){if(!Object.prototype.hasOwnProperty.call(e,"metadata")){e.metadata=n}this.sendError(e);return}try{const e=this.serializeMessage(t);this.write(e);this.sendStatus({code:o.Status.OK,details:"OK",metadata:n})}catch(e){e.code=o.Status.INTERNAL;this.sendError(e)}}sendStatus(e){var t;this.emit("callEnd",e.code);this.emit("streamEnd",e.code===o.Status.OK);if(this.checkCancelled()){return}trace("Request to method "+((t=this.handler)===null||t===void 0?void 0:t.path)+" ended with status code: "+o.Status[e.code]+" details: "+e.details);clearTimeout(this.deadlineTimer);if(!this.wantTrailers){this.wantTrailers=true;this.stream.once("wantTrailers",(()=>{const t=Object.assign({[m]:e.code,[p]:encodeURI(e.details)},e.metadata.toHttp2Headers());this.stream.sendTrailers(t)}));this.sendMetadata();this.stream.end()}}sendError(e){const t={code:o.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==undefined?e.metadata:new l.Metadata};if("code"in e&&typeof e.code==="number"&&Number.isInteger(e.code)){t.code=e.code;if("details"in e&&typeof e.details==="string"){t.details=e.details}}this.sendStatus(t)}write(e){if(this.checkCancelled()){return}if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}this.sendMetadata();this.emit("sendMessage");return this.stream.write(e)}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",(t=>{e.cancelled=true;e.emit("cancelled",t)}))}setupReadable(e,t){const n=new c.StreamDecoder;let r=false;let i=false;let s=false;const maybePushEnd=()=>{if(!s&&r&&!i){s=true;this.pushOrBufferMessage(e,null)}};this.stream.on("data",(async r=>{const s=n.write(r);i=true;this.stream.pause();for(const n of s){if(this.maxReceiveMessageSize!==-1&&n.length>this.maxReceiveMessageSize){this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${n.length} vs. ${this.maxReceiveMessageSize})`});return}this.emit("receiveMessage");const r=n.readUInt8(0)===1;const i=r?t:"identity";const s=await this.getDecompressedMessage(n,i);if(!s)return;this.pushOrBufferMessage(e,s)}i=false;this.stream.resume();maybePushEnd()}));this.stream.once("end",(()=>{r=true;maybePushEnd()}))}consumeUnpushedMessages(e){this.canPush=true;while(this.messagesToPush.length>0){const t=this.messagesToPush.shift();const n=e.push(t);if(t===null||n===false){this.canPush=false;break}}return this.canPush}pushOrBufferMessage(e,t){if(this.isPushPending){this.bufferedMessages.push(t)}else{this.pushMessage(e,t)}}async pushMessage(e,t){if(t===null){trace("Received end of stream");if(this.canPush){e.push(null)}else{this.messagesToPush.push(null)}return}trace("Received message of length "+t.length);this.isPushPending=true;try{const n=await this.deserializeMessage(t);if(this.canPush){if(!e.push(n)){this.canPush=false;this.stream.pause()}}else{this.messagesToPush.push(n)}}catch(t){this.bufferedMessages.length=0;if(!("code"in t&&typeof t.code==="number"&&Number.isInteger(t.code)&&t.code>=o.Status.OK&&t.code<=o.Status.UNAUTHENTICATED)){t.code=o.Status.INTERNAL}e.emit("error",t)}this.isPushPending=false;if(this.bufferedMessages.length>0){this.pushMessage(e,this.bufferedMessages.shift())}}getPeer(){const e=this.stream.session.socket;if(e.remoteAddress){if(e.remotePort){return`${e.remoteAddress}:${e.remotePort}`}else{return e.remoteAddress}}else{return"unknown"}}getDeadline(){return this.deadline}}t.Http2ServerCallStream=Http2ServerCallStream;function handleExpiredDeadline(e){const t=new Error("Deadline exceeded");t.code=o.Status.DEADLINE_EXCEEDED;e.sendError(t);e.cancelled=true;e.emit("cancelled","deadline")}},8659:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.ServerCredentials=void 0;const r=n(3734);class ServerCredentials{static createInsecure(){return new InsecureServerCredentials}static createSsl(e,t,n=false){if(e!==null&&!Buffer.isBuffer(e)){throw new TypeError("rootCerts must be null or a Buffer")}if(!Array.isArray(t)){throw new TypeError("keyCertPairs must be an array")}if(typeof n!=="boolean"){throw new TypeError("checkClientCertificate must be a boolean")}const i=[];const s=[];for(let e=0;e<t.length;e++){const n=t[e];if(n===null||typeof n!=="object"){throw new TypeError(`keyCertPair[${e}] must be an object`)}if(!Buffer.isBuffer(n.private_key)){throw new TypeError(`keyCertPair[${e}].private_key must be a Buffer`)}if(!Buffer.isBuffer(n.cert_chain)){throw new TypeError(`keyCertPair[${e}].cert_chain must be a Buffer`)}i.push(n.cert_chain);s.push(n.private_key)}return new SecureServerCredentials({ca:e||r.getDefaultRootsData()||undefined,cert:i,key:s,requestCert:n,ciphers:r.CIPHER_SUITES})}}t.ServerCredentials=ServerCredentials;class InsecureServerCredentials extends ServerCredentials{_isSecure(){return false}_getSettings(){return null}}class SecureServerCredentials extends ServerCredentials{constructor(e){super();this.options=e}_isSecure(){return true}_getSettings(){return this.options}}},1493:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Server=void 0;const r=n(5158);const i=n(8215);const s=n(6489);const a=n(1517);const o=n(8659);const l=n(186);const c=n(8221);const u=n(9920);const d=n(8754);const h=n(6158);const f="server";function noop(){}function getUnimplementedStatusResponse(e){return{code:i.Status.UNIMPLEMENTED,details:`The server does not implement the method ${e}`,metadata:new s.Metadata}}function getDefaultHandler(e,t){const n=getUnimplementedStatusResponse(t);switch(e){case"unary":return(e,t)=>{t(n,null)};case"clientStream":return(e,t)=>{t(n,null)};case"serverStream":return e=>{e.emit("error",n)};case"bidi":return e=>{e.emit("error",n)};default:throw new Error(`Invalid handlerType ${e}`)}}class Server{constructor(e){this.http2ServerList=[];this.handlers=new Map;this.sessions=new Map;this.started=false;this.channelzEnabled=true;this.channelzTrace=new h.ChannelzTrace;this.callTracker=new h.ChannelzCallTracker;this.listenerChildrenTracker=new h.ChannelzChildrenTracker;this.sessionChildrenTracker=new h.ChannelzChildrenTracker;this.options=e!==null&&e!==void 0?e:{};if(this.options["grpc.enable_channelz"]===0){this.channelzEnabled=false}this.channelzRef=h.registerChannelzServer((()=>this.getChannelzInfo()),this.channelzEnabled);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Server created")}this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,n,r;const i=this.sessions.get(e);const s=e.socket;const a=s.remoteAddress?u.stringToSubchannelAddress(s.remoteAddress,s.remotePort):null;const o=s.localAddress?u.stringToSubchannelAddress(s.localAddress,s.localPort):null;let l;if(e.encrypted){const e=s;const n=e.getCipher();const r=e.getCertificate();const i=e.getPeerCertificate();l={cipherSuiteStandardName:(t=n.standardName)!==null&&t!==void 0?t:null,cipherSuiteOtherName:n.standardName?null:n.name,localCertificate:r&&"raw"in r?r.raw:null,remoteCertificate:i&&"raw"in i?i.raw:null}}else{l=null}const c={remoteAddress:a,localAddress:o,security:l,remoteName:null,streamsStarted:i.streamTracker.callsStarted,streamsSucceeded:i.streamTracker.callsSucceeded,streamsFailed:i.streamTracker.callsFailed,messagesSent:i.messagesSent,messagesReceived:i.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:i.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:i.lastMessageSentTimestamp,lastMessageReceivedTimestamp:i.lastMessageReceivedTimestamp,localFlowControlWindow:(n=e.state.localWindowSize)!==null&&n!==void 0?n:null,remoteFlowControlWindow:(r=e.state.remoteWindowSize)!==null&&r!==void 0?r:null};return c}}trace(e){c.trace(i.LogVerbosity.DEBUG,f,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,t){if(e===null||typeof e!=="object"||t===null||typeof t!=="object"){throw new Error("addService() requires two objects as arguments")}const n=Object.keys(e);if(n.length===0){throw new Error("Cannot add an empty service to a server")}n.forEach((n=>{const r=e[n];let i;if(r.requestStream){if(r.responseStream){i="bidi"}else{i="clientStream"}}else{if(r.responseStream){i="serverStream"}else{i="unary"}}let s=t[n];let a;if(s===undefined&&typeof r.originalName==="string"){s=t[r.originalName]}if(s!==undefined){a=s.bind(t)}else{a=getDefaultHandler(i,n)}const o=this.register(r.path,a,r.responseSerialize,r.requestDeserialize,i);if(o===false){throw new Error(`Method handler for ${r.path} already provided.`)}}))}removeService(e){if(e===null||typeof e!=="object"){throw new Error("removeService() requires object as argument")}const t=Object.keys(e);t.forEach((t=>{const n=e[t];this.unregister(n.path)}))}bind(e,t){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,n){if(this.started===true){throw new Error("server is already started")}if(typeof e!=="string"){throw new TypeError("port must be a string")}if(t===null||!(t instanceof o.ServerCredentials)){throw new TypeError("creds must be a ServerCredentials object")}if(typeof n!=="function"){throw new TypeError("callback must be a function")}const s=d.parseUri(e);if(s===null){throw new Error(`Could not parse port "${e}"`)}const a=l.mapUriDefaultScheme(s);if(a===null){throw new Error(`Could not get a default scheme for port "${e}"`)}const f={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};if("grpc-node.max_session_memory"in this.options){f.maxSessionMemory=this.options["grpc-node.max_session_memory"]}if("grpc.max_concurrent_streams"in this.options){f.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]}}const deferredCallback=(e,t)=>{process.nextTick((()=>n(e,t)))};const setupServer=()=>{let e;if(t._isSecure()){const n=Object.assign(f,t._getSettings());e=r.createSecureServer(n);e.on("secureConnection",(e=>{e.on("error",(e=>{this.trace("An incoming TLS connection closed with error: "+e.message)}))}))}else{e=r.createServer(f)}e.setTimeout(0,noop);this._setupHandlers(e);return e};const bindSpecificPort=(e,t,n)=>{if(e.length===0){return Promise.resolve({port:t,count:n})}return Promise.all(e.map((e=>{this.trace("Attempting to bind "+u.subchannelAddressToString(e));let n;if(u.isTcpSubchannelAddress(e)){n={host:e.host,port:t}}else{n=e}const r=setupServer();return new Promise(((i,s)=>{const onError=t=>{this.trace("Failed to bind "+u.subchannelAddressToString(e)+" with error "+t.message);i(t)};r.once("error",onError);r.listen(n,(()=>{const e=r.address();let n;if(typeof e==="string"){n={path:e}}else{n={host:e.address,port:e.port}}let s;s=h.registerChannelzSocket(u.subchannelAddressToString(n),(()=>({localAddress:n,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null})),this.channelzEnabled);if(this.channelzEnabled){this.listenerChildrenTracker.refChild(s)}this.http2ServerList.push({server:r,channelzRef:s});this.trace("Successfully bound "+u.subchannelAddressToString(n));i("port"in n?n.port:t);r.removeListener("error",onError)}))}))}))).then((e=>{let r=0;for(const n of e){if(typeof n==="number"){r+=1;if(n!==t){throw new Error("Invalid state: multiple port numbers added from single address")}}}return{port:t,count:r+n}}))};const bindWildcardPort=e=>{if(e.length===0){return Promise.resolve({port:0,count:0})}const t=e[0];const n=setupServer();return new Promise(((r,i)=>{const onError=n=>{this.trace("Failed to bind "+u.subchannelAddressToString(t)+" with error "+n.message);r(bindWildcardPort(e.slice(1)))};n.once("error",onError);n.listen(t,(()=>{const t=n.address();const i={host:t.address,port:t.port};let s;s=h.registerChannelzSocket(u.subchannelAddressToString(i),(()=>({localAddress:i,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null})),this.channelzEnabled);if(this.channelzEnabled){this.listenerChildrenTracker.refChild(s)}this.http2ServerList.push({server:n,channelzRef:s});this.trace("Successfully bound "+u.subchannelAddressToString(i));r(bindSpecificPort(e.slice(1),t.port,1));n.removeListener("error",onError)}))}))};const p={onSuccessfulResolution:(t,n,r)=>{p.onSuccessfulResolution=()=>{};if(t.length===0){deferredCallback(new Error(`No addresses resolved for port ${e}`),0);return}let s;if(u.isTcpSubchannelAddress(t[0])){if(t[0].port===0){s=bindWildcardPort(t)}else{s=bindSpecificPort(t,t[0].port,0)}}else{s=bindSpecificPort(t,1,0)}s.then((e=>{if(e.count===0){const e=`No address added out of total ${t.length} resolved`;c.log(i.LogVerbosity.ERROR,e);deferredCallback(new Error(e),0)}else{if(e.count<t.length){c.log(i.LogVerbosity.INFO,`WARNING Only ${e.count} addresses added out of total ${t.length} resolved`)}deferredCallback(null,e.port)}}),(e=>{const n=`No address added out of total ${t.length} resolved`;c.log(i.LogVerbosity.ERROR,n);deferredCallback(new Error(n),0)}))},onError:e=>{deferredCallback(new Error(e.details),0)}};const m=l.createResolver(a,p,this.options);m.updateResolution()}forceShutdown(){for(const{server:e,channelzRef:t}of this.http2ServerList){if(e.listening){e.close((()=>{if(this.channelzEnabled){this.listenerChildrenTracker.unrefChild(t);h.unregisterChannelzRef(t)}}))}}this.started=false;this.sessions.forEach(((e,t)=>{t.destroy(r.constants.NGHTTP2_CANCEL)}));this.sessions.clear();if(this.channelzEnabled){h.unregisterChannelzRef(this.channelzRef)}}register(e,t,n,r,i){if(this.handlers.has(e)){return false}this.handlers.set(e,{func:t,serialize:n,deserialize:r,type:i,path:e});return true}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every((({server:e})=>e.listening!==true))){throw new Error("server must be bound in order to start")}if(this.started===true){throw new Error("server is already started")}if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Starting")}this.started=true}tryShutdown(e){const wrappedCallback=t=>{if(this.channelzEnabled){h.unregisterChannelzRef(this.channelzRef)}e(t)};let t=0;function maybeCallback(){t--;if(t===0){wrappedCallback()}}this.started=false;for(const{server:e,channelzRef:n}of this.http2ServerList){if(e.listening){t++;e.close((()=>{if(this.channelzEnabled){this.listenerChildrenTracker.unrefChild(n);h.unregisterChannelzRef(n)}maybeCallback()}))}}this.sessions.forEach(((e,n)=>{if(!n.closed){t+=1;n.close(maybeCallback)}}));if(t===0){wrappedCallback()}}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_setupHandlers(e){if(e===null){return}e.on("stream",((t,n)=>{var s;const o=this.sessions.get(t.session);if(this.channelzEnabled){this.callTracker.addCallStarted();o===null||o===void 0?void 0:o.streamTracker.addCallStarted()}const l=n[r.constants.HTTP2_HEADER_CONTENT_TYPE];if(typeof l!=="string"||!l.startsWith("application/grpc")){t.respond({[r.constants.HTTP2_HEADER_STATUS]:r.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:true});this.callTracker.addCallFailed();if(this.channelzEnabled){o===null||o===void 0?void 0:o.streamTracker.addCallFailed()}return}let c=null;try{const l=n[r.constants.HTTP2_HEADER_PATH];const u=e.address();let d="null";if(u){if(typeof u==="string"){d=u}else{d=u.address+":"+u.port}}this.trace("Received call to method "+l+" at address "+d);const h=this.handlers.get(l);if(h===undefined){this.trace("No handler registered for method "+l+". Sending UNIMPLEMENTED status.");throw getUnimplementedStatusResponse(l)}c=new a.Http2ServerCallStream(t,h,this.options);c.once("callEnd",(e=>{if(e===i.Status.OK){this.callTracker.addCallSucceeded()}else{this.callTracker.addCallFailed()}}));if(this.channelzEnabled&&o){c.once("streamEnd",(e=>{if(e){o.streamTracker.addCallSucceeded()}else{o.streamTracker.addCallFailed()}}));c.on("sendMessage",(()=>{o.messagesSent+=1;o.lastMessageSentTimestamp=new Date}));c.on("receiveMessage",(()=>{o.messagesReceived+=1;o.lastMessageReceivedTimestamp=new Date}))}const f=c.receiveMetadata(n);const p=(s=f.get("grpc-encoding")[0])!==null&&s!==void 0?s:"identity";f.remove("grpc-encoding");switch(h.type){case"unary":handleUnary(c,h,f,p);break;case"clientStream":handleClientStreaming(c,h,f,p);break;case"serverStream":handleServerStreaming(c,h,f,p);break;case"bidi":handleBidiStreaming(c,h,f,p);break;default:throw new Error(`Unknown handler type: ${h.type}`)}}catch(e){if(!c){c=new a.Http2ServerCallStream(t,null,this.options);if(this.channelzEnabled){this.callTracker.addCallFailed();o===null||o===void 0?void 0:o.streamTracker.addCallFailed()}}if(e.code===undefined){e.code=i.Status.INTERNAL}c.sendError(e)}}));e.on("session",(e=>{var t;if(!this.started){e.destroy();return}let n;n=h.registerChannelzSocket((t=e.socket.remoteAddress)!==null&&t!==void 0?t:"unknown",this.getChannelzSessionInfoGetter(e),this.channelzEnabled);const r={ref:n,streamTracker:new h.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(e,r);const i=e.socket.remoteAddress;if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Connection established by client "+i);this.sessionChildrenTracker.refChild(n)}e.on("close",(()=>{if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+i);this.sessionChildrenTracker.unrefChild(n);h.unregisterChannelzRef(n)}this.sessions.delete(e)}))}))}}t.Server=Server;async function handleUnary(e,t,n,r){const i=await e.receiveUnaryMessage(r);if(i===undefined||e.cancelled){return}const s=new a.ServerUnaryCallImpl(e,n,i);t.func(s,((t,n,r,i)=>{e.sendUnaryMessage(t,n,r,i)}))}function handleClientStreaming(e,t,n,r){const i=new a.ServerReadableStreamImpl(e,n,t.deserialize,r);function respond(t,n,r,s){i.destroy();e.sendUnaryMessage(t,n,r,s)}if(e.cancelled){return}i.on("error",respond);t.func(i,respond)}async function handleServerStreaming(e,t,n,r){const i=await e.receiveUnaryMessage(r);if(i===undefined||e.cancelled){return}const s=new a.ServerWritableStreamImpl(e,n,t.serialize,i);t.func(s)}function handleBidiStreaming(e,t,n,r){const i=new a.ServerDuplexStreamImpl(e,n,t.serialize,t.deserialize,r);if(e.cancelled){return}t.func(i)}},4294:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.extractAndSelectServiceConfig=t.validateServiceConfig=void 0;const r=n(2037);const i=n(4106);const s=/^\d+(\.\d{1,9})?s$/;const a="node";function validateName(e){if(!("service"in e)||typeof e.service!=="string"){throw new Error("Invalid method config name: invalid service")}const t={service:e.service};if("method"in e){if(typeof e.method==="string"){t.method=e.method}else{throw new Error("Invalid method config name: invalid method")}}return t}function validateMethodConfig(e){var t;const n={name:[]};if(!("name"in e)||!Array.isArray(e.name)){throw new Error("Invalid method config: invalid name array")}for(const t of e.name){n.name.push(validateName(t))}if("waitForReady"in e){if(typeof e.waitForReady!=="boolean"){throw new Error("Invalid method config: invalid waitForReady")}n.waitForReady=e.waitForReady}if("timeout"in e){if(typeof e.timeout==="object"){if(!("seconds"in e.timeout)||!(typeof e.timeout.seconds==="number")){throw new Error("Invalid method config: invalid timeout.seconds")}if(!("nanos"in e.timeout)||!(typeof e.timeout.nanos==="number")){throw new Error("Invalid method config: invalid timeout.nanos")}n.timeout=e.timeout}else if(typeof e.timeout==="string"&&s.test(e.timeout)){const r=e.timeout.substring(0,e.timeout.length-1).split(".");n.timeout={seconds:r[0]|0,nanos:((t=r[1])!==null&&t!==void 0?t:0)|0}}else{throw new Error("Invalid method config: invalid timeout")}}if("maxRequestBytes"in e){if(typeof e.maxRequestBytes!=="number"){throw new Error("Invalid method config: invalid maxRequestBytes")}n.maxRequestBytes=e.maxRequestBytes}if("maxResponseBytes"in e){if(typeof e.maxResponseBytes!=="number"){throw new Error("Invalid method config: invalid maxRequestBytes")}n.maxResponseBytes=e.maxResponseBytes}return n}function validateServiceConfig(e){const t={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in e){if(typeof e.loadBalancingPolicy==="string"){t.loadBalancingPolicy=e.loadBalancingPolicy}else{throw new Error("Invalid service config: invalid loadBalancingPolicy")}}if("loadBalancingConfig"in e){if(Array.isArray(e.loadBalancingConfig)){for(const n of e.loadBalancingConfig){t.loadBalancingConfig.push(i.validateLoadBalancingConfig(n))}}else{throw new Error("Invalid service config: invalid loadBalancingConfig")}}if("methodConfig"in e){if(Array.isArray(e.methodConfig)){for(const n of e.methodConfig){t.methodConfig.push(validateMethodConfig(n))}}}const n=[];for(const e of t.methodConfig){for(const t of e.name){for(const e of n){if(t.service===e.service&&t.method===e.method){throw new Error(`Invalid service config: duplicate name ${t.service}/${t.method}`)}}n.push(t)}}return t}t.validateServiceConfig=validateServiceConfig;function validateCanaryConfig(e){if(!("serviceConfig"in e)){throw new Error("Invalid service config choice: missing service config")}const t={serviceConfig:validateServiceConfig(e.serviceConfig)};if("clientLanguage"in e){if(Array.isArray(e.clientLanguage)){t.clientLanguage=[];for(const n of e.clientLanguage){if(typeof n==="string"){t.clientLanguage.push(n)}else{throw new Error("Invalid service config choice: invalid clientLanguage")}}}else{throw new Error("Invalid service config choice: invalid clientLanguage")}}if("clientHostname"in e){if(Array.isArray(e.clientHostname)){t.clientHostname=[];for(const n of e.clientHostname){if(typeof n==="string"){t.clientHostname.push(n)}else{throw new Error("Invalid service config choice: invalid clientHostname")}}}else{throw new Error("Invalid service config choice: invalid clientHostname")}}if("percentage"in e){if(typeof e.percentage==="number"&&0<=e.percentage&&e.percentage<=100){t.percentage=e.percentage}else{throw new Error("Invalid service config choice: invalid percentage")}}const n=["clientLanguage","percentage","clientHostname","serviceConfig"];for(const t in e){if(!n.includes(t)){throw new Error(`Invalid service config choice: unexpected field ${t}`)}}return t}function validateAndSelectCanaryConfig(e,t){if(!Array.isArray(e)){throw new Error("Invalid service config list")}for(const n of e){const e=validateCanaryConfig(n);if(typeof e.percentage==="number"&&t>e.percentage){continue}if(Array.isArray(e.clientHostname)){let t=false;for(const n of e.clientHostname){if(n===r.hostname()){t=true}}if(!t){continue}}if(Array.isArray(e.clientLanguage)){let t=false;for(const n of e.clientLanguage){if(n===a){t=true}}if(!t){continue}}return e.serviceConfig}throw new Error("No matching service config found")}function extractAndSelectServiceConfig(e,t){for(const n of e){if(n.length>0&&n[0].startsWith("grpc_config=")){const e=n.join("").substring("grpc_config=".length);const r=JSON.parse(e);return validateAndSelectCanaryConfig(r,t)}}return null}t.extractAndSelectServiceConfig=extractAndSelectServiceConfig},7774:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StatusBuilder=void 0;class StatusBuilder{constructor(){this.code=null;this.details=null;this.metadata=null}withCode(e){this.code=e;return this}withDetails(e){this.details=e;return this}withMetadata(e){this.metadata=e;return this}build(){const e={};if(this.code!==null){e.code=this.code}if(this.details!==null){e.details=this.details}if(this.metadata!==null){e.metadata=this.metadata}return e}}t.StatusBuilder=StatusBuilder},4821:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.StreamDecoder=void 0;var n;(function(e){e[e["NO_DATA"]=0]="NO_DATA";e[e["READING_SIZE"]=1]="READING_SIZE";e[e["READING_MESSAGE"]=2]="READING_MESSAGE"})(n||(n={}));class StreamDecoder{constructor(){this.readState=n.NO_DATA;this.readCompressFlag=Buffer.alloc(1);this.readPartialSize=Buffer.alloc(4);this.readSizeRemaining=4;this.readMessageSize=0;this.readPartialMessage=[];this.readMessageRemaining=0}write(e){let t=0;let r;const i=[];while(t<e.length){switch(this.readState){case n.NO_DATA:this.readCompressFlag=e.slice(t,t+1);t+=1;this.readState=n.READING_SIZE;this.readPartialSize.fill(0);this.readSizeRemaining=4;this.readMessageSize=0;this.readMessageRemaining=0;this.readPartialMessage=[];break;case n.READING_SIZE:r=Math.min(e.length-t,this.readSizeRemaining);e.copy(this.readPartialSize,4-this.readSizeRemaining,t,t+r);this.readSizeRemaining-=r;t+=r;if(this.readSizeRemaining===0){this.readMessageSize=this.readPartialSize.readUInt32BE(0);this.readMessageRemaining=this.readMessageSize;if(this.readMessageRemaining>0){this.readState=n.READING_MESSAGE}else{const e=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=n.NO_DATA;i.push(e)}}break;case n.READING_MESSAGE:r=Math.min(e.length-t,this.readMessageRemaining);this.readPartialMessage.push(e.slice(t,t+r));this.readMessageRemaining-=r;t+=r;if(this.readMessageRemaining===0){const e=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage);const t=Buffer.concat(e,this.readMessageSize+5);this.readState=n.NO_DATA;i.push(t)}break;default:throw new Error("Unexpected read state")}}return i}}t.StreamDecoder=StreamDecoder},9920:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.stringToSubchannelAddress=t.subchannelAddressToString=t.subchannelAddressEqual=t.isTcpSubchannelAddress=void 0;const r=n(1808);function isTcpSubchannelAddress(e){return"port"in e}t.isTcpSubchannelAddress=isTcpSubchannelAddress;function subchannelAddressEqual(e,t){if(isTcpSubchannelAddress(e)){return isTcpSubchannelAddress(t)&&e.host===t.host&&e.port===t.port}else{return!isTcpSubchannelAddress(t)&&e.path===t.path}}t.subchannelAddressEqual=subchannelAddressEqual;function subchannelAddressToString(e){if(isTcpSubchannelAddress(e)){return e.host+":"+e.port}else{return e.path}}t.subchannelAddressToString=subchannelAddressToString;const i=443;function stringToSubchannelAddress(e,t){if(r.isIP(e)){return{host:e,port:t!==null&&t!==void 0?t:i}}else{return{path:e}}}t.stringToSubchannelAddress=stringToSubchannelAddress},9121:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.BaseSubchannelWrapper=void 0;class BaseSubchannelWrapper{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}}t.BaseSubchannelWrapper=BaseSubchannelWrapper},8603:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getSubchannelPool=t.SubchannelPool=void 0;const r=n(1714);const i=n(695);const s=n(9920);const a=n(8754);const o=1e4;class SubchannelPool{constructor(e){this.global=e;this.pool=Object.create(null);this.cleanupTimer=null}unrefUnusedSubchannels(){let e=true;for(const t in this.pool){const n=this.pool[t];const r=n.filter((e=>!e.subchannel.unrefIfOneRef()));if(r.length>0){e=false}this.pool[t]=r}if(e&&this.cleanupTimer!==null){clearInterval(this.cleanupTimer);this.cleanupTimer=null}}ensureCleanupTask(){var e,t;if(this.global&&this.cleanupTimer===null){this.cleanupTimer=setInterval((()=>{this.unrefUnusedSubchannels()}),o);(t=(e=this.cleanupTimer).unref)===null||t===void 0?void 0:t.call(e)}}getOrCreateSubchannel(e,t,n,o){this.ensureCleanupTask();const l=a.uriToString(e);if(l in this.pool){const e=this.pool[l];for(const i of e){if(s.subchannelAddressEqual(t,i.subchannelAddress)&&r.channelOptionsEqual(n,i.channelArguments)&&o._equals(i.channelCredentials)){return i.subchannel}}}const c=new i.Subchannel(e,t,n,o);if(!(l in this.pool)){this.pool[l]=[]}this.pool[l].push({subchannelAddress:t,channelArguments:n,channelCredentials:o,subchannel:c});if(this.global){c.ref()}return c}}t.SubchannelPool=SubchannelPool;const l=new SubchannelPool(true);function getSubchannelPool(e){if(e){return l}else{return new SubchannelPool(false)}}t.getSubchannelPool=getSubchannelPool},695:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.Subchannel=void 0;const r=n(5158);const i=n(4404);const s=n(8480);const a=n(4237);const o=n(186);const l=n(8221);const c=n(8215);const u=n(5883);const d=n(1808);const h=n(8754);const f=n(9920);const p=n(6158);const m=n(5451).i8;const g="subchannel";const v="subchannel_flowctrl";const y=2e4;const S=1e3;const b=1.6;const C=12e4;const _=.2;const T=~(1<<31);const E=2e4;const{HTTP2_HEADER_AUTHORITY:R,HTTP2_HEADER_CONTENT_TYPE:w,HTTP2_HEADER_METHOD:O,HTTP2_HEADER_PATH:k,HTTP2_HEADER_TE:A,HTTP2_HEADER_USER_AGENT:N}=r.constants;function uniformRandom(e,t){return Math.random()*(t-e)+e}const I=Buffer.from("too_many_pings","ascii");class Subchannel{constructor(e,t,n,r){this.channelTarget=e;this.subchannelAddress=t;this.options=n;this.credentials=r;this.connectivityState=s.ConnectivityState.IDLE;this.session=null;this.continueConnecting=false;this.stateListeners=[];this.disconnectListeners=[];this.keepaliveTimeMs=T;this.keepaliveTimeoutMs=E;this.keepaliveWithoutCalls=false;this.callRefcount=0;this.refcount=0;this.channelzEnabled=true;this.callTracker=new p.ChannelzCallTracker;this.childrenTracker=new p.ChannelzChildrenTracker;this.channelzSocketRef=null;this.remoteName=null;this.streamTracker=new p.ChannelzCallTracker;this.keepalivesSent=0;this.messagesSent=0;this.messagesReceived=0;this.lastMessageSentTimestamp=null;this.lastMessageReceivedTimestamp=null;this.userAgent=[n["grpc.primary_user_agent"],`grpc-node-js/${m}`,n["grpc.secondary_user_agent"]].filter((e=>e)).join(" ");if("grpc.keepalive_time_ms"in n){this.keepaliveTimeMs=n["grpc.keepalive_time_ms"]}if("grpc.keepalive_timeout_ms"in n){this.keepaliveTimeoutMs=n["grpc.keepalive_timeout_ms"]}if("grpc.keepalive_permit_without_calls"in n){this.keepaliveWithoutCalls=n["grpc.keepalive_permit_without_calls"]===1}else{this.keepaliveWithoutCalls=false}this.keepaliveIntervalId=setTimeout((()=>{}),0);clearTimeout(this.keepaliveIntervalId);this.keepaliveTimeoutId=setTimeout((()=>{}),0);clearTimeout(this.keepaliveTimeoutId);const i={initialDelay:n["grpc.initial_reconnect_backoff_ms"],maxDelay:n["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new a.BackoffTimeout((()=>{this.handleBackoffTimer()}),i);this.subchannelAddressString=f.subchannelAddressToString(t);if(n["grpc.enable_channelz"]===0){this.channelzEnabled=false}this.channelzTrace=new p.ChannelzTrace;this.channelzRef=p.registerChannelzSubchannel(this.subchannelAddressString,(()=>this.getChannelzInfo()),this.channelzEnabled);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Subchannel created")}this.trace("Subchannel constructed with options "+JSON.stringify(n,undefined,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}getChannelzSocketInfo(){var e,t,n;if(this.session===null){return null}const r=this.session.socket;const i=r.remoteAddress?f.stringToSubchannelAddress(r.remoteAddress,r.remotePort):null;const s=r.localAddress?f.stringToSubchannelAddress(r.localAddress,r.localPort):null;let a;if(this.session.encrypted){const t=r;const n=t.getCipher();const i=t.getCertificate();const s=t.getPeerCertificate();a={cipherSuiteStandardName:(e=n.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:n.standardName?null:n.name,localCertificate:i&&"raw"in i?i.raw:null,remoteCertificate:s&&"raw"in s?s.raw:null}}else{a=null}const o={remoteAddress:i,localAddress:s,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(t=this.session.state.localWindowSize)!==null&&t!==void 0?t:null,remoteFlowControlWindow:(n=this.session.state.remoteWindowSize)!==null&&n!==void 0?n:null};return o}resetChannelzSocketInfo(){if(!this.channelzEnabled){return}if(this.channelzSocketRef){p.unregisterChannelzRef(this.channelzSocketRef);this.childrenTracker.unrefChild(this.channelzSocketRef);this.channelzSocketRef=null}this.remoteName=null;this.streamTracker=new p.ChannelzCallTracker;this.keepalivesSent=0;this.messagesSent=0;this.messagesReceived=0;this.lastMessageSentTimestamp=null;this.lastMessageReceivedTimestamp=null}trace(e){l.trace(c.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){l.trace(c.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){l.trace(c.LogVerbosity.DEBUG,v,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){l.trace(c.LogVerbosity.DEBUG,"subchannel_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){l.trace(c.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){if(this.continueConnecting){this.transitionToState([s.ConnectivityState.TRANSIENT_FAILURE],s.ConnectivityState.CONNECTING)}else{this.transitionToState([s.ConnectivityState.TRANSIENT_FAILURE],s.ConnectivityState.IDLE)}}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop();this.backoffTimeout.reset()}sendPing(){var e,t;if(this.channelzEnabled){this.keepalivesSent+=1}this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms");this.keepaliveTimeoutId=setTimeout((()=>{this.keepaliveTrace("Ping timeout passed without response");this.handleDisconnect()}),this.keepaliveTimeoutMs);(t=(e=this.keepaliveTimeoutId).unref)===null||t===void 0?void 0:t.call(e);this.session.ping(((e,t,n)=>{this.keepaliveTrace("Received ping response");clearTimeout(this.keepaliveTimeoutId)}))}startKeepalivePings(){var e,t;this.keepaliveIntervalId=setInterval((()=>{this.sendPing()}),this.keepaliveTimeMs);(t=(e=this.keepaliveIntervalId).unref)===null||t===void 0?void 0:t.call(e)}stopKeepalivePings(){clearInterval(this.keepaliveIntervalId);clearTimeout(this.keepaliveTimeoutId)}createSession(e){var t,n,a;if(e.realTarget){this.remoteName=h.uriToString(e.realTarget);this.trace("creating HTTP/2 session through proxy to "+e.realTarget)}else{this.remoteName=null;this.trace("creating HTTP/2 session")}const u=o.getDefaultAuthority((t=e.realTarget)!==null&&t!==void 0?t:this.channelTarget);let f=this.credentials._getConnectionOptions()||{};f.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER;if("grpc-node.max_session_memory"in this.options){f.maxSessionMemory=this.options["grpc-node.max_session_memory"]}else{f.maxSessionMemory=Number.MAX_SAFE_INTEGER}let m="http://";if("secureContext"in f){m="https://";if(this.options["grpc.ssl_target_name_override"]){const e=this.options["grpc.ssl_target_name_override"];f.checkServerIdentity=(t,n)=>i.checkServerIdentity(e,n);f.servername=e}else{const e=(a=(n=h.splitHostPort(u))===null||n===void 0?void 0:n.host)!==null&&a!==void 0?a:"localhost";f.servername=e}if(e.socket){f.createConnection=(t,n)=>e.socket}}else{f.createConnection=(t,n)=>{if(e.socket){return e.socket}else{return d.connect(this.subchannelAddress)}}}f=Object.assign(Object.assign({},f),this.subchannelAddress);const v=r.connect(m+u,f);this.session=v;this.channelzSocketRef=p.registerChannelzSocket(this.subchannelAddressString,(()=>this.getChannelzSocketInfo()),this.channelzEnabled);if(this.channelzEnabled){this.childrenTracker.refChild(this.channelzSocketRef)}v.unref();v.once("connect",(()=>{if(this.session===v){this.transitionToState([s.ConnectivityState.CONNECTING],s.ConnectivityState.READY)}}));v.once("close",(()=>{if(this.session===v){this.trace("connection closed");this.transitionToState([s.ConnectivityState.CONNECTING],s.ConnectivityState.TRANSIENT_FAILURE);this.transitionToState([s.ConnectivityState.READY],s.ConnectivityState.IDLE)}}));v.once("goaway",((e,t,n)=>{if(this.session===v){if(e===r.constants.NGHTTP2_ENHANCE_YOUR_CALM&&n.equals(I)){this.keepaliveTimeMs=Math.min(2*this.keepaliveTimeMs,T);l.log(c.LogVerbosity.ERROR,`Connection to ${h.uriToString(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTimeMs} ms`)}this.trace("connection closed by GOAWAY with code "+e);this.transitionToState([s.ConnectivityState.CONNECTING,s.ConnectivityState.READY],s.ConnectivityState.IDLE)}}));v.once("error",(e=>{this.trace("connection closed with error "+e.message)}));if(l.isTracerEnabled(g)){v.on("remoteSettings",(e=>{this.trace("new settings received"+(this.session!==v?" on the old connection":"")+": "+JSON.stringify(e))}));v.on("localSettings",(e=>{this.trace("local settings acknowledged by remote"+(this.session!==v?" on the old connection":"")+": "+JSON.stringify(e))}))}}startConnectingInternal(){var e,t;const n=this.credentials._getConnectionOptions()||{};if("secureContext"in n){n.ALPNProtocols=["h2"];if(this.options["grpc.ssl_target_name_override"]){const e=this.options["grpc.ssl_target_name_override"];n.checkServerIdentity=(t,n)=>i.checkServerIdentity(e,n);n.servername=e}else{if("grpc.http_connect_target"in this.options){const r=o.getDefaultAuthority((e=h.parseUri(this.options["grpc.http_connect_target"]))!==null&&e!==void 0?e:{path:"localhost"});const i=h.splitHostPort(r);n.servername=(t=i===null||i===void 0?void 0:i.host)!==null&&t!==void 0?t:r}}}u.getProxiedConnection(this.subchannelAddress,this.options,n).then((e=>{this.createSession(e)}),(e=>{this.transitionToState([s.ConnectivityState.CONNECTING],s.ConnectivityState.TRANSIENT_FAILURE)}))}handleDisconnect(){this.transitionToState([s.ConnectivityState.READY],s.ConnectivityState.TRANSIENT_FAILURE);for(const e of this.disconnectListeners){e()}}transitionToState(e,t){if(e.indexOf(this.connectivityState)===-1){return false}this.trace(s.ConnectivityState[this.connectivityState]+" -> "+s.ConnectivityState[t]);if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO",s.ConnectivityState[this.connectivityState]+" -> "+s.ConnectivityState[t])}const n=this.connectivityState;this.connectivityState=t;switch(t){case s.ConnectivityState.READY:this.stopBackoff();const e=this.session;e.socket.once("close",(()=>{if(this.session===e){this.handleDisconnect()}}));if(this.keepaliveWithoutCalls){this.startKeepalivePings()}break;case s.ConnectivityState.CONNECTING:this.startBackoff();this.startConnectingInternal();this.continueConnecting=false;break;case s.ConnectivityState.TRANSIENT_FAILURE:if(this.session){this.session.close()}this.session=null;this.resetChannelzSocketInfo();this.stopKeepalivePings();if(!this.backoffTimeout.isRunning()){process.nextTick((()=>{this.handleBackoffTimer()}))}break;case s.ConnectivityState.IDLE:if(this.session){this.session.close()}this.session=null;this.resetChannelzSocketInfo();this.stopKeepalivePings();break;default:throw new Error(`Invalid state: unknown ConnectivityState ${t}`)}for(const e of[...this.stateListeners]){e(this,n,t)}return true}checkBothRefcounts(){if(this.callRefcount===0&&this.refcount===0){if(this.channelzEnabled){this.channelzTrace.addTrace("CT_INFO","Shutting down")}this.transitionToState([s.ConnectivityState.CONNECTING,s.ConnectivityState.READY],s.ConnectivityState.TRANSIENT_FAILURE);if(this.channelzEnabled){p.unregisterChannelzRef(this.channelzRef)}}}callRef(){this.refTrace("callRefcount "+this.callRefcount+" -> "+(this.callRefcount+1));if(this.callRefcount===0){if(this.session){this.session.ref()}this.backoffTimeout.ref();if(!this.keepaliveWithoutCalls){this.startKeepalivePings()}}this.callRefcount+=1}callUnref(){this.refTrace("callRefcount "+this.callRefcount+" -> "+(this.callRefcount-1));this.callRefcount-=1;if(this.callRefcount===0){if(this.session){this.session.unref()}this.backoffTimeout.unref();if(!this.keepaliveWithoutCalls){clearInterval(this.keepaliveIntervalId)}this.checkBothRefcounts()}}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1));this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1));this.refcount-=1;this.checkBothRefcounts()}unrefIfOneRef(){if(this.refcount===1){this.unref();return true}return false}startCallStream(e,t,n){const r=e.toHttp2Headers();r[R]=t.getHost();r[N]=this.userAgent;r[w]="application/grpc";r[O]="POST";r[k]=t.getMethod();r[A]="trailers";let i;try{i=this.session.request(r)}catch(e){this.transitionToState([s.ConnectivityState.READY],s.ConnectivityState.TRANSIENT_FAILURE);throw e}let a="";for(const e of Object.keys(r)){a+="\t\t"+e+": "+r[e]+"\n"}l.trace(c.LogVerbosity.DEBUG,"call_stream","Starting stream ["+t.getCallNumber()+"] on subchannel "+"("+this.channelzRef.id+") "+this.subchannelAddressString+" with headers\n"+a);this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize);const o=this.session;this.internalsTrace("session.closed="+o.closed+" session.destroyed="+o.destroyed+" session.socket.destroyed="+o.socket.destroyed);let u;if(this.channelzEnabled){this.callTracker.addCallStarted();t.addStatusWatcher((e=>{if(e.code===c.Status.OK){this.callTracker.addCallSucceeded()}else{this.callTracker.addCallFailed()}}));this.streamTracker.addCallStarted();t.addStreamEndWatcher((e=>{if(o===this.session){if(e){this.streamTracker.addCallSucceeded()}else{this.streamTracker.addCallFailed()}}}));u={addMessageSent:()=>{this.messagesSent+=1;this.lastMessageSentTimestamp=new Date},addMessageReceived:()=>{this.messagesReceived+=1}}}else{u={addMessageSent:()=>{},addMessageReceived:()=>{}}}t.attachHttp2Stream(i,this,n,u)}startConnecting(){if(!this.transitionToState([s.ConnectivityState.IDLE],s.ConnectivityState.CONNECTING)){if(this.connectivityState===s.ConnectivityState.TRANSIENT_FAILURE){this.continueConnecting=true}}}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){const t=this.stateListeners.indexOf(e);if(t>-1){this.stateListeners.splice(t,1)}}addDisconnectListener(e){this.disconnectListeners.push(e)}removeDisconnectListener(e){const t=this.disconnectListeners.indexOf(e);if(t>-1){this.disconnectListeners.splice(t,1)}}resetBackoff(){this.backoffTimeout.reset();this.transitionToState([s.ConnectivityState.TRANSIENT_FAILURE],s.ConnectivityState.CONNECTING)}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}}t.Subchannel=Subchannel},3734:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getDefaultRootsData=t.CIPHER_SUITES=void 0;const r=n(7147);t.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;const i=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH;let s=null;function getDefaultRootsData(){if(i){if(s===null){s=r.readFileSync(i)}return s}return null}t.getDefaultRootsData=getDefaultRootsData},8754:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:true});t.uriToString=t.splitHostPort=t.parseUri=void 0;const n=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function parseUri(e){const t=n.exec(e);if(t===null){return null}return{scheme:t[1],authority:t[2],path:t[3]}}t.parseUri=parseUri;const r=/^\d+$/;function splitHostPort(e){if(e.startsWith("[")){const t=e.indexOf("]");if(t===-1){return null}const n=e.substring(1,t);if(n.indexOf(":")===-1){return null}if(e.length>t+1){if(e[t+1]===":"){const i=e.substring(t+2);if(r.test(i)){return{host:n,port:+i}}else{return null}}else{return null}}else{return{host:n}}}else{const t=e.split(":");if(t.length===2){if(r.test(t[1])){return{host:t[0],port:+t[1]}}else{return null}}else{return{host:e}}}}t.splitHostPort=splitHostPort;function uriToString(e){let t="";if(e.scheme!==undefined){t+=e.scheme+":"}if(e.authority!==undefined){t+="//"+e.authority+"/"}t+=e.path;return t}t.uriToString=uriToString},8855:(e,t,n)=>{"use strict";var r;
/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */r={value:true};const i=n(7317);const s=n(3400);const a=n(4451);const o=n(2213);function isAnyExtension(e){return"@type"in e&&typeof e["@type"]==="string"}r=isAnyExtension;const l={longs:String,enums:String,bytes:String,defaults:true,oneofs:true,json:true};function joinName(e,t){if(e===""){return t}else{return e+"."+t}}function isHandledReflectionObject(e){return e instanceof s.Service||e instanceof s.Type||e instanceof s.Enum}function isNamespaceBase(e){return e instanceof s.Namespace||e instanceof s.Root}function getAllHandledReflectionObjects(e,t){const n=joinName(t,e.name);if(isHandledReflectionObject(e)){return[[n,e]]}else{if(isNamespaceBase(e)&&typeof e.nested!=="undefined"){return Object.keys(e.nested).map((t=>getAllHandledReflectionObjects(e.nested[t],n))).reduce(((e,t)=>e.concat(t)),[])}}return[]}function createDeserializer(e,t){return function deserialize(n){return e.toObject(e.decode(n),t)}}function createSerializer(e){return function serialize(t){if(Array.isArray(t)){throw new Error(`Failed to serialize message: expected object with ${e.name} structure, got array instead`)}const n=e.fromObject(t);return e.encode(n).finish()}}function createMethodDefinition(e,t,n,r){const s=e.resolvedRequestType;const a=e.resolvedResponseType;return{path:"/"+t+"/"+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestSerialize:createSerializer(s),requestDeserialize:createDeserializer(s,n),responseSerialize:createSerializer(a),responseDeserialize:createDeserializer(a,n),originalName:i(e.name),requestType:createMessageDefinition(s,r),responseType:createMessageDefinition(a,r)}}function createServiceDefinition(e,t,n,r){const i={};for(const s of e.methodsArray){i[s.name]=createMethodDefinition(s,t,n,r)}return i}function createMessageDefinition(e,t){const n=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:n.$type.toObject(n,l),fileDescriptorProtos:t}}function createEnumDefinition(e,t){const n=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:n.$type.toObject(n,l),fileDescriptorProtos:t}}function createDefinition(e,t,n,r){if(e instanceof s.Service){return createServiceDefinition(e,t,n,r)}else if(e instanceof s.Type){return createMessageDefinition(e,r)}else if(e instanceof s.Enum){return createEnumDefinition(e,r)}else{throw new Error("Type mismatch in reflection object handling")}}function createPackageDefinition(e,t){const n={};e.resolveAll();const r=e.toDescriptor("proto3").file;const i=r.map((e=>Buffer.from(a.FileDescriptorProto.encode(e).finish())));for(const[r,s]of getAllHandledReflectionObjects(e,"")){n[r]=createDefinition(s,r,t,i)}return n}function createPackageDefinitionFromDescriptorSet(e,t){t=t||{};const n=s.Root.fromDescriptor(e);n.resolveAll();return createPackageDefinition(n,t)}function load(e,t){return o.loadProtosWithOptions(e,t).then((e=>createPackageDefinition(e,t)))}r=load;function loadSync(e,t){const n=o.loadProtosWithOptionsSync(e,t);return createPackageDefinition(n,t)}t.J_=loadSync;function fromJSON(e,t){t=t||{};const n=s.Root.fromJSON(e);n.resolveAll();return createPackageDefinition(n,t)}r=fromJSON;function loadFileDescriptorSetFromBuffer(e,t){const n=a.FileDescriptorSet.decode(e);return createPackageDefinitionFromDescriptorSet(n,t)}r=loadFileDescriptorSetFromBuffer;function loadFileDescriptorSetFromObject(e,t){const n=a.FileDescriptorSet.fromObject(e);return createPackageDefinitionFromDescriptorSet(n,t)}r=loadFileDescriptorSetFromObject;o.addCommonProtos()},2213:(e,t,n)=>{"use strict";
/**
 * @license
 * Copyright 2018 gRPC authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */Object.defineProperty(t,"__esModule",{value:true});const r=n(7147);const i=n(1017);const s=n(3400);function addIncludePathResolver(e,t){const n=e.resolvePath;e.resolvePath=(e,s)=>{if(i.isAbsolute(s)){return s}for(const e of t){const t=i.join(e,s);try{r.accessSync(t,r.constants.R_OK);return t}catch(e){continue}}process.emitWarning(`${s} not found in any of the include paths ${t}`);return n(e,s)}}async function loadProtosWithOptions(e,t){const n=new s.Root;t=t||{};if(!!t.includeDirs){if(!Array.isArray(t.includeDirs)){return Promise.reject(new Error("The includeDirs option must be an array"))}addIncludePathResolver(n,t.includeDirs)}const r=await n.load(e,t);r.resolveAll();return r}t.loadProtosWithOptions=loadProtosWithOptions;function loadProtosWithOptionsSync(e,t){const n=new s.Root;t=t||{};if(!!t.includeDirs){if(!Array.isArray(t.includeDirs)){throw new Error("The includeDirs option must be an array")}addIncludePathResolver(n,t.includeDirs)}const r=n.loadSync(e,t);r.resolveAll();return r}t.loadProtosWithOptionsSync=loadProtosWithOptionsSync;function addCommonProtos(){const e=n(9412);const t=n(3460);const r=n(3266);const i=n(6019);s.common("api",e.nested.google.nested.protobuf.nested);s.common("descriptor",t.nested.google.nested.protobuf.nested);s.common("source_context",r.nested.google.nested.protobuf.nested);s.common("type",i.nested.google.nested.protobuf.nested)}t.addCommonProtos=addCommonProtos},4955:e=>{"use strict";e.exports=asPromise;function asPromise(e,t){var n=new Array(arguments.length-1),r=0,i=2,s=true;while(i<arguments.length)n[r++]=arguments[i++];return new Promise((function executor(i,a){n[r]=function callback(e){if(s){s=false;if(e)a(e);else{var t=new Array(arguments.length-1),n=0;while(n<t.length)t[n++]=arguments[n];i.apply(null,t)}}};try{e.apply(t||null,n)}catch(e){if(s){s=false;a(e)}}}))}},8293:(e,t)=>{"use strict";var n=t;n.length=function length(e){var t=e.length;if(!t)return 0;var n=0;while(--t%4>1&&e.charAt(t)==="=")++n;return Math.ceil(e.length*3)/4-n};var r=new Array(64);var i=new Array(123);for(var s=0;s<64;)i[r[s]=s<26?s+65:s<52?s+71:s<62?s-4:s-59|43]=s++;n.encode=function encode(e,t,n){var i=null,s=[];var a=0,o=0,l;while(t<n){var c=e[t++];switch(o){case 0:s[a++]=r[c>>2];l=(c&3)<<4;o=1;break;case 1:s[a++]=r[l|c>>4];l=(c&15)<<2;o=2;break;case 2:s[a++]=r[l|c>>6];s[a++]=r[c&63];o=0;break}if(a>8191){(i||(i=[])).push(String.fromCharCode.apply(String,s));a=0}}if(o){s[a++]=r[l];s[a++]=61;if(o===1)s[a++]=61}if(i){if(a)i.push(String.fromCharCode.apply(String,s.slice(0,a)));return i.join("")}return String.fromCharCode.apply(String,s.slice(0,a))};var a="invalid encoding";n.decode=function decode(e,t,n){var r=n;var s=0,o;for(var l=0;l<e.length;){var c=e.charCodeAt(l++);if(c===61&&s>1)break;if((c=i[c])===undefined)throw Error(a);switch(s){case 0:o=c;s=1;break;case 1:t[n++]=o<<2|(c&48)>>4;o=c;s=2;break;case 2:t[n++]=(o&15)<<4|(c&60)>>2;o=c;s=3;break;case 3:t[n++]=(o&3)<<6|c;s=0;break}}if(s===1)throw Error(a);return n-r};n.test=function test(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},8566:e=>{"use strict";e.exports=codegen;function codegen(e,t){if(typeof e==="string"){t=e;e=undefined}var n=[];function Codegen(e){if(typeof e!=="string"){var t=toString();if(codegen.verbose)console.log("codegen: "+t);t="return "+t;if(e){var r=Object.keys(e),i=new Array(r.length+1),s=new Array(r.length),a=0;while(a<r.length){i[a]=r[a];s[a]=e[r[a++]]}i[a]=t;return Function.apply(null,i).apply(null,s)}return Function(t)()}var o=new Array(arguments.length-1),l=0;while(l<o.length)o[l]=arguments[++l];l=0;e=e.replace(/%([%dfijs])/g,(function replace(e,t){var n=o[l++];switch(t){case"d":case"f":return String(Number(n));case"i":return String(Math.floor(n));case"j":return JSON.stringify(n);case"s":return String(n)}return"%"}));if(l!==o.length)throw Error("parameter count mismatch");n.push(e);return Codegen}function toString(r){return"function "+(r||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+n.join("\n  ")+"\n}"}Codegen.toString=toString;return Codegen}codegen.verbose=false},6585:e=>{"use strict";e.exports=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function on(e,t,n){(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this});return this};EventEmitter.prototype.off=function off(e,t){if(e===undefined)this._listeners={};else{if(t===undefined)this._listeners[e]=[];else{var n=this._listeners[e];for(var r=0;r<n.length;)if(n[r].fn===t)n.splice(r,1);else++r}}return this};EventEmitter.prototype.emit=function emit(e){var t=this._listeners[e];if(t){var n=[],r=1;for(;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},7561:(e,t,n)=>{"use strict";e.exports=fetch;var r=n(4955),i=n(7461);var s=i("fs");function fetch(e,t,n){if(typeof t==="function"){n=t;t={}}else if(!t)t={};if(!n)return r(fetch,this,e,t);if(!t.xhr&&s&&s.readFile)return s.readFile(e,(function fetchReadFileCallback(r,i){return r&&typeof XMLHttpRequest!=="undefined"?fetch.xhr(e,t,n):r?n(r):n(null,t.binary?i:i.toString("utf8"))}));return fetch.xhr(e,t,n)}fetch.xhr=function fetch_xhr(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function fetchOnReadyStateChange(){if(r.readyState!==4)return undefined;if(r.status!==0&&r.status!==200)return n(Error("status "+r.status));if(t.binary){var e=r.response;if(!e){e=[];for(var i=0;i<r.responseText.length;++i)e.push(r.responseText.charCodeAt(i)&255)}return n(null,typeof Uint8Array!=="undefined"?new Uint8Array(e):e)}return n(null,r.responseText)};if(t.binary){if("overrideMimeType"in r)r.overrideMimeType("text/plain; charset=x-user-defined");r.responseType="arraybuffer"}r.open("GET",e);r.send()}},8602:e=>{"use strict";e.exports=factory(factory);function factory(e){if(typeof Float32Array!=="undefined")(function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=n[3]===128;function writeFloat_f32_cpy(e,r,i){t[0]=e;r[i]=n[0];r[i+1]=n[1];r[i+2]=n[2];r[i+3]=n[3]}function writeFloat_f32_rev(e,r,i){t[0]=e;r[i]=n[3];r[i+1]=n[2];r[i+2]=n[1];r[i+3]=n[0]}e.writeFloatLE=r?writeFloat_f32_cpy:writeFloat_f32_rev;e.writeFloatBE=r?writeFloat_f32_rev:writeFloat_f32_cpy;function readFloat_f32_cpy(e,r){n[0]=e[r];n[1]=e[r+1];n[2]=e[r+2];n[3]=e[r+3];return t[0]}function readFloat_f32_rev(e,r){n[3]=e[r];n[2]=e[r+1];n[1]=e[r+2];n[0]=e[r+3];return t[0]}e.readFloatLE=r?readFloat_f32_cpy:readFloat_f32_rev;e.readFloatBE=r?readFloat_f32_rev:readFloat_f32_cpy})();else(function(){function writeFloat_ieee754(e,t,n,r){var i=t<0?1:0;if(i)t=-t;if(t===0)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var s=Math.floor(Math.log(t)/Math.LN2),a=Math.round(t*Math.pow(2,-s)*8388608)&8388607;e((i<<31|s+127<<23|a)>>>0,n,r)}}e.writeFloatLE=writeFloat_ieee754.bind(null,writeUintLE);e.writeFloatBE=writeFloat_ieee754.bind(null,writeUintBE);function readFloat_ieee754(e,t,n){var r=e(t,n),i=(r>>31)*2+1,s=r>>>23&255,a=r&8388607;return s===255?a?NaN:i*Infinity:s===0?i*1401298464324817e-60*a:i*Math.pow(2,s-150)*(a+8388608)}e.readFloatLE=readFloat_ieee754.bind(null,readUintLE);e.readFloatBE=readFloat_ieee754.bind(null,readUintBE)})();if(typeof Float64Array!=="undefined")(function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=n[7]===128;function writeDouble_f64_cpy(e,r,i){t[0]=e;r[i]=n[0];r[i+1]=n[1];r[i+2]=n[2];r[i+3]=n[3];r[i+4]=n[4];r[i+5]=n[5];r[i+6]=n[6];r[i+7]=n[7]}function writeDouble_f64_rev(e,r,i){t[0]=e;r[i]=n[7];r[i+1]=n[6];r[i+2]=n[5];r[i+3]=n[4];r[i+4]=n[3];r[i+5]=n[2];r[i+6]=n[1];r[i+7]=n[0]}e.writeDoubleLE=r?writeDouble_f64_cpy:writeDouble_f64_rev;e.writeDoubleBE=r?writeDouble_f64_rev:writeDouble_f64_cpy;function readDouble_f64_cpy(e,r){n[0]=e[r];n[1]=e[r+1];n[2]=e[r+2];n[3]=e[r+3];n[4]=e[r+4];n[5]=e[r+5];n[6]=e[r+6];n[7]=e[r+7];return t[0]}function readDouble_f64_rev(e,r){n[7]=e[r];n[6]=e[r+1];n[5]=e[r+2];n[4]=e[r+3];n[3]=e[r+4];n[2]=e[r+5];n[1]=e[r+6];n[0]=e[r+7];return t[0]}e.readDoubleLE=r?readDouble_f64_cpy:readDouble_f64_rev;e.readDoubleBE=r?readDouble_f64_rev:readDouble_f64_cpy})();else(function(){function writeDouble_ieee754(e,t,n,r,i,s){var a=r<0?1:0;if(a)r=-r;if(r===0){e(0,i,s+t);e(1/r>0?0:2147483648,i,s+n)}else if(isNaN(r)){e(0,i,s+t);e(2146959360,i,s+n)}else if(r>17976931348623157e292){e(0,i,s+t);e((a<<31|2146435072)>>>0,i,s+n)}else{var o;if(r<22250738585072014e-324){o=r/5e-324;e(o>>>0,i,s+t);e((a<<31|o/4294967296)>>>0,i,s+n)}else{var l=Math.floor(Math.log(r)/Math.LN2);if(l===1024)l=1023;o=r*Math.pow(2,-l);e(o*4503599627370496>>>0,i,s+t);e((a<<31|l+1023<<20|o*1048576&1048575)>>>0,i,s+n)}}}e.writeDoubleLE=writeDouble_ieee754.bind(null,writeUintLE,0,4);e.writeDoubleBE=writeDouble_ieee754.bind(null,writeUintBE,4,0);function readDouble_ieee754(e,t,n,r,i){var s=e(r,i+t),a=e(r,i+n);var o=(a>>31)*2+1,l=a>>>20&2047,c=4294967296*(a&1048575)+s;return l===2047?c?NaN:o*Infinity:l===0?o*5e-324*c:o*Math.pow(2,l-1075)*(c+4503599627370496)}e.readDoubleLE=readDouble_ieee754.bind(null,readUintLE,0,4);e.readDoubleBE=readDouble_ieee754.bind(null,readUintBE,4,0)})();return e}function writeUintLE(e,t,n){t[n]=e&255;t[n+1]=e>>>8&255;t[n+2]=e>>>16&255;t[n+3]=e>>>24}function writeUintBE(e,t,n){t[n]=e>>>24;t[n+1]=e>>>16&255;t[n+2]=e>>>8&255;t[n+3]=e&255}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}},7461:module=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}},8464:(e,t)=>{"use strict";var n=t;var r=n.isAbsolute=function isAbsolute(e){return/^(?:\/|\w+:)/.test(e)};var i=n.normalize=function normalize(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var t=e.split("/"),n=r(e),i="";if(n)i=t.shift()+"/";for(var s=0;s<t.length;){if(t[s]===".."){if(s>0&&t[s-1]!=="..")t.splice(--s,2);else if(n)t.splice(s,1);else++s}else if(t[s]===".")t.splice(s,1);else++s}return i+t.join("/")};n.resolve=function resolve(e,t,n){if(!n)t=i(t);if(r(t))return t;if(!n)e=i(e);return(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?i(e+"/"+t):t}},5945:e=>{"use strict";e.exports=pool;function pool(e,t,n){var r=n||8192;var i=r>>>1;var s=null;var a=r;return function pool_alloc(n){if(n<1||n>i)return e(n);if(a+n>r){s=e(r);a=0}var o=t.call(s,a,a+=n);if(a&7)a=(a|7)+1;return o}}},795:(e,t)=>{"use strict";var n=t;n.length=function utf8_length(e){var t=0,n=0;for(var r=0;r<e.length;++r){n=e.charCodeAt(r);if(n<128)t+=1;else if(n<2048)t+=2;else if((n&64512)===55296&&(e.charCodeAt(r+1)&64512)===56320){++r;t+=4}else t+=3}return t};n.read=function utf8_read(e,t,n){var r=n-t;if(r<1)return"";var i=null,s=[],a=0,o;while(t<n){o=e[t++];if(o<128)s[a++]=o;else if(o>191&&o<224)s[a++]=(o&31)<<6|e[t++]&63;else if(o>239&&o<365){o=((o&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536;s[a++]=55296+(o>>10);s[a++]=56320+(o&1023)}else s[a++]=(o&15)<<12|(e[t++]&63)<<6|e[t++]&63;if(a>8191){(i||(i=[])).push(String.fromCharCode.apply(String,s));a=0}}if(i){if(a)i.push(String.fromCharCode.apply(String,s.slice(0,a)));return i.join("")}return String.fromCharCode.apply(String,s.slice(0,a))};n.write=function utf8_write(e,t,n){var r=n,i,s;for(var a=0;a<e.length;++a){i=e.charCodeAt(a);if(i<128){t[n++]=i}else if(i<2048){t[n++]=i>>6|192;t[n++]=i&63|128}else if((i&64512)===55296&&((s=e.charCodeAt(a+1))&64512)===56320){i=65536+((i&1023)<<10)+(s&1023);++a;t[n++]=i>>18|240;t[n++]=i>>12&63|128;t[n++]=i>>6&63|128;t[n++]=i&63|128}else{t[n++]=i>>12|224;t[n++]=i>>6&63|128;t[n++]=i&63|128}}return n-r}},7317:e=>{var t=1/0;var n="[object Symbol]";var r=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var i=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g;var s="\\ud800-\\udfff",a="\\u0300-\\u036f\\ufe20-\\ufe23",o="\\u20d0-\\u20f0",l="\\u2700-\\u27bf",c="a-z\\xdf-\\xf6\\xf8-\\xff",u="\\xac\\xb1\\xd7\\xf7",d="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",h="\\u2000-\\u206f",f=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",p="A-Z\\xc0-\\xd6\\xd8-\\xde",m="\\ufe0e\\ufe0f",g=u+d+h+f;var v="['’]",y="["+s+"]",S="["+g+"]",b="["+a+o+"]",C="\\d+",_="["+l+"]",T="["+c+"]",E="[^"+s+g+C+l+c+p+"]",R="\\ud83c[\\udffb-\\udfff]",w="(?:"+b+"|"+R+")",O="[^"+s+"]",k="(?:\\ud83c[\\udde6-\\uddff]){2}",A="[\\ud800-\\udbff][\\udc00-\\udfff]",N="["+p+"]",I="\\u200d";var P="(?:"+T+"|"+E+")",D="(?:"+N+"|"+E+")",M="(?:"+v+"(?:d|ll|m|re|s|t|ve))?",x="(?:"+v+"(?:D|LL|M|RE|S|T|VE))?",L=w+"?",F="["+m+"]?",j="(?:"+I+"(?:"+[O,k,A].join("|")+")"+F+L+")*",B=F+L+j,z="(?:"+[_,k,A].join("|")+")"+B,U="(?:"+[O+b+"?",b,k,A,y].join("|")+")";var H=RegExp(v,"g");var W=RegExp(b,"g");var q=RegExp(R+"(?="+R+")|"+U+B,"g");var G=RegExp([N+"?"+T+"+"+M+"(?="+[S,N,"$"].join("|")+")",D+"+"+x+"(?="+[S,N+P,"$"].join("|")+")",N+"?"+P+"+"+M,N+"+"+x,C,z].join("|"),"g");var V=RegExp("["+I+s+a+o+m+"]");var $=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var J={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"ss"};var Y=typeof global=="object"&&global&&global.Object===Object&&global;var K=typeof self=="object"&&self&&self.Object===Object&&self;var Q=Y||K||Function("return this")();function arrayReduce(e,t,n,r){var i=-1,s=e?e.length:0;if(r&&s){n=e[++i]}while(++i<s){n=t(n,e[i],i,e)}return n}function asciiToArray(e){return e.split("")}function asciiWords(e){return e.match(r)||[]}function basePropertyOf(e){return function(t){return e==null?undefined:e[t]}}var X=basePropertyOf(J);function hasUnicode(e){return V.test(e)}function hasUnicodeWord(e){return $.test(e)}function stringToArray(e){return hasUnicode(e)?unicodeToArray(e):asciiToArray(e)}function unicodeToArray(e){return e.match(q)||[]}function unicodeWords(e){return e.match(G)||[]}var Z=Object.prototype;var ee=Z.toString;var te=Q.Symbol;var ne=te?te.prototype:undefined,re=ne?ne.toString:undefined;function baseSlice(e,t,n){var r=-1,i=e.length;if(t<0){t=-t>i?0:i+t}n=n>i?i:n;if(n<0){n+=i}i=t>n?0:n-t>>>0;t>>>=0;var s=Array(i);while(++r<i){s[r]=e[r+t]}return s}function baseToString(e){if(typeof e=="string"){return e}if(isSymbol(e)){return re?re.call(e):""}var n=e+"";return n=="0"&&1/e==-t?"-0":n}function castSlice(e,t,n){var r=e.length;n=n===undefined?r:n;return!t&&n>=r?e:baseSlice(e,t,n)}function createCaseFirst(e){return function(t){t=toString(t);var n=hasUnicode(t)?stringToArray(t):undefined;var r=n?n[0]:t.charAt(0);var i=n?castSlice(n,1).join(""):t.slice(1);return r[e]()+i}}function createCompounder(e){return function(t){return arrayReduce(words(deburr(t).replace(H,"")),e,"")}}function isObjectLike(e){return!!e&&typeof e=="object"}function isSymbol(e){return typeof e=="symbol"||isObjectLike(e)&&ee.call(e)==n}function toString(e){return e==null?"":baseToString(e)}var ie=createCompounder((function(e,t,n){t=t.toLowerCase();return e+(n?capitalize(t):t)}));function capitalize(e){return se(toString(e).toLowerCase())}function deburr(e){e=toString(e);return e&&e.replace(i,X).replace(W,"")}var se=createCaseFirst("toUpperCase");function words(e,t,n){e=toString(e);t=n?undefined:t;if(t===undefined){return hasUnicodeWord(e)?unicodeWords(e):asciiWords(e)}return e.match(t)||[]}e.exports=ie},4451:(e,t,n)=>{"use strict";var r=n(3400);e.exports=t=r.descriptor=r.Root.fromJSON(n(3460)).lookup(".google.protobuf");var i=r.Namespace,s=r.Root,a=r.Enum,o=r.Type,l=r.Field,c=r.MapField,u=r.OneOf,d=r.Service,h=r.Method;s.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.FileDescriptorSet.decode(e);var n=new s;if(e.file){var r,i;for(var c=0,u;c<e.file.length;++c){i=n;if((r=e.file[c])["package"]&&r["package"].length)i=n.define(r["package"]);if(r.name&&r.name.length)n.files.push(i.filename=r.name);if(r.messageType)for(u=0;u<r.messageType.length;++u)i.add(o.fromDescriptor(r.messageType[u],r.syntax));if(r.enumType)for(u=0;u<r.enumType.length;++u)i.add(a.fromDescriptor(r.enumType[u]));if(r.extension)for(u=0;u<r.extension.length;++u)i.add(l.fromDescriptor(r.extension[u]));if(r.service)for(u=0;u<r.service.length;++u)i.add(d.fromDescriptor(r.service[u]));var h=fromDescriptorOptions(r.options,t.FileOptions);if(h){var f=Object.keys(h);for(u=0;u<f.length;++u)i.setOption(f[u],h[f[u]])}}}return n};s.prototype.toDescriptor=function toDescriptor(e){var n=t.FileDescriptorSet.create();Root_toDescriptorRecursive(this,n.file,e);return n};function Root_toDescriptorRecursive(e,n,r){var c=t.FileDescriptorProto.create({name:e.filename||(e.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});if(r)c.syntax=r;if(!(e instanceof s))c["package"]=e.fullName.substring(1);for(var u=0,h;u<e.nestedArray.length;++u)if((h=e._nestedArray[u])instanceof o)c.messageType.push(h.toDescriptor(r));else if(h instanceof a)c.enumType.push(h.toDescriptor());else if(h instanceof l)c.extension.push(h.toDescriptor(r));else if(h instanceof d)c.service.push(h.toDescriptor());else if(h instanceof i)Root_toDescriptorRecursive(h,n,r);c.options=toDescriptorOptions(e.options,t.FileOptions);if(c.messageType.length+c.enumType.length+c.extension.length+c.service.length)n.push(c)}var f=0;o.fromDescriptor=function fromDescriptor(e,n){if(typeof e.length==="number")e=t.DescriptorProto.decode(e);var r=new o(e.name.length?e.name:"Type"+f++,fromDescriptorOptions(e.options,t.MessageOptions)),i;if(e.oneofDecl)for(i=0;i<e.oneofDecl.length;++i)r.add(u.fromDescriptor(e.oneofDecl[i]));if(e.field)for(i=0;i<e.field.length;++i){var s=l.fromDescriptor(e.field[i],n);r.add(s);if(e.field[i].hasOwnProperty("oneofIndex"))r.oneofsArray[e.field[i].oneofIndex].add(s)}if(e.extension)for(i=0;i<e.extension.length;++i)r.add(l.fromDescriptor(e.extension[i],n));if(e.nestedType)for(i=0;i<e.nestedType.length;++i){r.add(o.fromDescriptor(e.nestedType[i],n));if(e.nestedType[i].options&&e.nestedType[i].options.mapEntry)r.setOption("map_entry",true)}if(e.enumType)for(i=0;i<e.enumType.length;++i)r.add(a.fromDescriptor(e.enumType[i]));if(e.extensionRange&&e.extensionRange.length){r.extensions=[];for(i=0;i<e.extensionRange.length;++i)r.extensions.push([e.extensionRange[i].start,e.extensionRange[i].end])}if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){r.reserved=[];if(e.reservedRange)for(i=0;i<e.reservedRange.length;++i)r.reserved.push([e.reservedRange[i].start,e.reservedRange[i].end]);if(e.reservedName)for(i=0;i<e.reservedName.length;++i)r.reserved.push(e.reservedName[i])}return r};o.prototype.toDescriptor=function toDescriptor(e){var n=t.DescriptorProto.create({name:this.name}),r;for(r=0;r<this.fieldsArray.length;++r){var i;n.field.push(i=this._fieldsArray[r].toDescriptor(e));if(this._fieldsArray[r]instanceof c){var s=toDescriptorType(this._fieldsArray[r].keyType,this._fieldsArray[r].resolvedKeyType),u=toDescriptorType(this._fieldsArray[r].type,this._fieldsArray[r].resolvedType),d=u===11||u===14?this._fieldsArray[r].resolvedType&&shortname(this.parent,this._fieldsArray[r].resolvedType)||this._fieldsArray[r].type:undefined;n.nestedType.push(t.DescriptorProto.create({name:i.typeName,field:[t.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),t.FieldDescriptorProto.create({name:"value",number:2,label:1,type:u,typeName:d})],options:t.MessageOptions.create({mapEntry:true})}))}}for(r=0;r<this.oneofsArray.length;++r)n.oneofDecl.push(this._oneofsArray[r].toDescriptor());for(r=0;r<this.nestedArray.length;++r){if(this._nestedArray[r]instanceof l)n.field.push(this._nestedArray[r].toDescriptor(e));else if(this._nestedArray[r]instanceof o)n.nestedType.push(this._nestedArray[r].toDescriptor(e));else if(this._nestedArray[r]instanceof a)n.enumType.push(this._nestedArray[r].toDescriptor())}if(this.extensions)for(r=0;r<this.extensions.length;++r)n.extensionRange.push(t.DescriptorProto.ExtensionRange.create({start:this.extensions[r][0],end:this.extensions[r][1]}));if(this.reserved)for(r=0;r<this.reserved.length;++r)if(typeof this.reserved[r]==="string")n.reservedName.push(this.reserved[r]);else n.reservedRange.push(t.DescriptorProto.ReservedRange.create({start:this.reserved[r][0],end:this.reserved[r][1]}));n.options=toDescriptorOptions(this.options,t.MessageOptions);return n};var p=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function fromDescriptor(e,n){if(typeof e.length==="number")e=t.DescriptorProto.decode(e);if(typeof e.number!=="number")throw Error("missing field id");var r;if(e.typeName&&e.typeName.length)r=e.typeName;else r=fromDescriptorType(e.type);var i;switch(e.label){case 1:i=undefined;break;case 2:i="required";break;case 3:i="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;if(e.extendee!==undefined){s=s.length?s:undefined}var a=new l(e.name.length?e.name:"field"+e.number,e.number,r,i,s);a.options=fromDescriptorOptions(e.options,t.FieldOptions);if(e.defaultValue&&e.defaultValue.length){var o=e.defaultValue;switch(o){case"true":case"TRUE":o=true;break;case"false":case"FALSE":o=false;break;default:var c=p.exec(o);if(c)o=parseInt(o);break}a.setOption("default",o)}if(packableDescriptorType(e.type)){if(n==="proto3"){if(e.options&&!e.options.packed)a.setOption("packed",false)}else if(!(e.options&&e.options.packed))a.setOption("packed",false)}return a};l.prototype.toDescriptor=function toDescriptor(e){var n=t.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map){n.type=11;n.typeName=r.util.ucFirst(this.name);n.label=3}else{switch(n.type=toDescriptorType(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:n.typeName=this.resolvedType?shortname(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":n.label=3;break;case"required":n.label=2;break;default:n.label=1;break}}n.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend;if(this.partOf)if((n.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");if(this.options){n.options=toDescriptorOptions(this.options,t.FieldOptions);if(this.options["default"]!=null)n.defaultValue=String(this.options["default"])}if(e==="proto3"){if(!this.packed)(n.options||(n.options=t.FieldOptions.create())).packed=false}else if(this.packed)(n.options||(n.options=t.FieldOptions.create())).packed=true;return n};var m=0;a.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.EnumDescriptorProto.decode(e);var n={};if(e.value)for(var r=0;r<e.value.length;++r){var i=e.value[r].name,s=e.value[r].number||0;n[i&&i.length?i:"NAME"+s]=s}return new a(e.name&&e.name.length?e.name:"Enum"+m++,n,fromDescriptorOptions(e.options,t.EnumOptions))};a.prototype.toDescriptor=function toDescriptor(){var e=[];for(var n=0,r=Object.keys(this.values);n<r.length;++n)e.push(t.EnumValueDescriptorProto.create({name:r[n],number:this.values[r[n]]}));return t.EnumDescriptorProto.create({name:this.name,value:e,options:toDescriptorOptions(this.options,t.EnumOptions)})};var g=0;u.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.OneofDescriptorProto.decode(e);return new u(e.name&&e.name.length?e.name:"oneof"+g++)};u.prototype.toDescriptor=function toDescriptor(){return t.OneofDescriptorProto.create({name:this.name})};var v=0;d.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.ServiceDescriptorProto.decode(e);var n=new d(e.name&&e.name.length?e.name:"Service"+v++,fromDescriptorOptions(e.options,t.ServiceOptions));if(e.method)for(var r=0;r<e.method.length;++r)n.add(h.fromDescriptor(e.method[r]));return n};d.prototype.toDescriptor=function toDescriptor(){var e=[];for(var n=0;n<this.methodsArray.length;++n)e.push(this._methodsArray[n].toDescriptor());return t.ServiceDescriptorProto.create({name:this.name,method:e,options:toDescriptorOptions(this.options,t.ServiceOptions)})};var y=0;h.fromDescriptor=function fromDescriptor(e){if(typeof e.length==="number")e=t.MethodDescriptorProto.decode(e);return new h(e.name&&e.name.length?e.name:"Method"+y++,"rpc",e.inputType,e.outputType,Boolean(e.clientStreaming),Boolean(e.serverStreaming),fromDescriptorOptions(e.options,t.MethodOptions))};h.prototype.toDescriptor=function toDescriptor(){return t.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:toDescriptorOptions(this.options,t.MethodOptions)})};function fromDescriptorType(e){switch(e){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+e)}function packableDescriptorType(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return true}return false}function toDescriptorType(e,t){switch(e){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(t instanceof a)return 14;if(t instanceof o)return t.group?10:11;throw Error("illegal type: "+e)}function fromDescriptorOptions(e,t){if(!e)return undefined;var n=[];for(var i=0,s,o,l;i<t.fieldsArray.length;++i)if((o=(s=t._fieldsArray[i]).name)!=="uninterpretedOption")if(e.hasOwnProperty(o)){l=e[o];if(s.resolvedType instanceof a&&typeof l==="number"&&s.resolvedType.valuesById[l]!==undefined)l=s.resolvedType.valuesById[l];n.push(underScore(o),l)}return n.length?r.util.toObject(n):undefined}function toDescriptorOptions(e,t){if(!e)return undefined;var n=[];for(var i=0,s=Object.keys(e),a,o;i<s.length;++i){o=e[a=s[i]];if(a==="default")continue;var l=t.fields[a];if(!l&&!(l=t.fields[a=r.util.camelCase(a)]))continue;n.push(a,o)}return n.length?t.fromObject(r.util.toObject(n)):undefined}function shortname(e,t){var n=e.fullName.split("."),r=t.fullName.split("."),a=0,o=0,l=r.length-1;if(!(e instanceof s)&&t instanceof i)while(a<n.length&&o<l&&n[a]===r[o]){var c=t.lookup(n[a++],true);if(c!==null&&c!==t)break;++o}else for(;a<n.length&&o<l&&n[a]===r[o];++a,++o);return r.slice(o).join(".")}function underScore(e){return e.substring(0,1)+e.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,(function(e,t){return"_"+t.toLowerCase()}))}},3400:(e,t,n)=>{"use strict";e.exports=n(9206)},4573:e=>{"use strict";e.exports=common;var t=/\/|\./;function common(e,n){if(!t.test(e)){e="google/protobuf/"+e+".proto";n={nested:{google:{nested:{protobuf:{nested:n}}}}}}common[e]=n}common("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var n;common("duration",{Duration:n={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});common("timestamp",{Timestamp:n});common("empty",{Empty:{fields:{}}});common("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});common("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});common("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});common.get=function get(e){return common[e]||null}},1980:(e,t,n)=>{"use strict";var r=t;var i=n(9344),s=n(8431);function genValuePartial_fromObject(e,t,n,r){if(t.resolvedType){if(t.resolvedType instanceof i){e("switch(d%s){",r);for(var s=t.resolvedType.values,a=Object.keys(s),o=0;o<a.length;++o){if(t.repeated&&s[a[o]]===t.typeDefault)e("default:");e("case%j:",a[o])("case %i:",s[a[o]])("m%s=%j",r,s[a[o]])("break")}e("}")}else e('if(typeof d%s!=="object")',r)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r)}else{var l=false;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",r,r);break;case"uint64":l=true;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,l)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,l?"true":"");break;case"bytes":e('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length)",r)("m%s=d%s",r,r);break;case"string":e("m%s=String(d%s)",r,r);break;case"bool":e("m%s=Boolean(d%s)",r,r);break}}return e}r.fromObject=function fromObject(e){var t=e.fieldsArray;var n=s.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return n("return new this.ctor");n("var m=new this.ctor");for(var r=0;r<t.length;++r){var a=t[r].resolve(),o=s.safeProp(a.name);if(a.map){n("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",a.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o);genValuePartial_fromObject(n,a,r,o+"[ks[i]]")("}")("}")}else if(a.repeated){n("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",a.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o);genValuePartial_fromObject(n,a,r,o+"[i]")("}")("}")}else{if(!(a.resolvedType instanceof i))n("if(d%s!=null){",o);genValuePartial_fromObject(n,a,r,o);if(!(a.resolvedType instanceof i))n("}")}}return n("return m")};function genValuePartial_toObject(e,t,n,r){if(t.resolvedType){if(t.resolvedType instanceof i)e("d%s=o.enums===String?types[%i].values[m%s]:m%s",r,n,r,r);else e("d%s=types[%i].toObject(m%s,o)",r,n,r)}else{var s=false;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":s=true;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,s?"true":"",r);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:e("d%s=m%s",r,r);break}}return e}r.toObject=function toObject(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()("return {}");var n=s.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}");var r=[],a=[],o=[],l=0;for(;l<t.length;++l)if(!t[l].partOf)(t[l].resolve().repeated?r:t[l].map?a:o).push(t[l]);if(r.length){n("if(o.arrays||o.defaults){");for(l=0;l<r.length;++l)n("d%s=[]",s.safeProp(r[l].name));n("}")}if(a.length){n("if(o.objects||o.defaults){");for(l=0;l<a.length;++l)n("d%s={}",s.safeProp(a[l].name));n("}")}if(o.length){n("if(o.defaults){");for(l=0;l<o.length;++l){var c=o[l],u=s.safeProp(c.name);if(c.resolvedType instanceof i)n("d%s=o.enums===String?%j:%j",u,c.resolvedType.valuesById[c.typeDefault],c.typeDefault);else if(c.long)n("if(util.Long){")("var n=new util.Long(%i,%i,%j)",c.typeDefault.low,c.typeDefault.high,c.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",u)("}else")("d%s=o.longs===String?%j:%i",u,c.typeDefault.toString(),c.typeDefault.toNumber());else if(c.bytes){var d="["+Array.prototype.slice.call(c.typeDefault).join(",")+"]";n("if(o.bytes===String)d%s=%j",u,String.fromCharCode.apply(String,c.typeDefault))("else{")("d%s=%s",u,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",u,u)("}")}else n("d%s=%j",u,c.typeDefault)}n("}")}var h=false;for(l=0;l<t.length;++l){var c=t[l],f=e._fieldsArray.indexOf(c),u=s.safeProp(c.name);if(c.map){if(!h){h=true;n("var ks2")}n("if(m%s&&(ks2=Object.keys(m%s)).length){",u,u)("d%s={}",u)("for(var j=0;j<ks2.length;++j){");genValuePartial_toObject(n,c,f,u+"[ks2[j]]")("}")}else if(c.repeated){n("if(m%s&&m%s.length){",u,u)("d%s=[]",u)("for(var j=0;j<m%s.length;++j){",u);genValuePartial_toObject(n,c,f,u+"[j]")("}")}else{n("if(m%s!=null&&m.hasOwnProperty(%j)){",u,c.name);genValuePartial_toObject(n,c,f,u);if(c.partOf)n("if(o.oneofs)")("d%s=%j",s.safeProp(c.partOf.name),c.name)}n("}")}return n("return d")}},9939:(e,t,n)=>{"use strict";e.exports=decoder;var r=n(9344),i=n(8144),s=n(8431);function missing(e){return"missing required '"+e.name+"'"}function decoder(e){var t=s.codegen(["r","l"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter((function(e){return e.map})).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");if(e.group)t("if((t&7)===4)")("break");t("switch(t>>>3){");var n=0;for(;n<e.fieldsArray.length;++n){var a=e._fieldsArray[n].resolve(),o=a.resolvedType instanceof r?"int32":a.type,l="m"+s.safeProp(a.name);t("case %i:",a.id);if(a.map){t("if(%s===util.emptyObject)",l)("%s={}",l)("var c2 = r.uint32()+r.pos");if(i.defaults[a.keyType]!==undefined)t("k=%j",i.defaults[a.keyType]);else t("k=null");if(i.defaults[o]!==undefined)t("value=%j",i.defaults[o]);else t("value=null");t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",a.keyType)("case 2:");if(i.basic[o]===undefined)t("value=types[%i].decode(r,r.uint32())",n);else t("value=r.%s()",o);t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}");if(i.long[a.keyType]!==undefined)t('%s[typeof k==="object"?util.longToHash(k):k]=value',l);else t("%s[k]=value",l)}else if(a.repeated){t("if(!(%s&&%s.length))",l,l)("%s=[]",l);if(i.packed[o]!==undefined)t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",l,o)("}else");if(i.basic[o]===undefined)t(a.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",l,n);else t("%s.push(r.%s())",l,o)}else if(i.basic[o]===undefined)t(a.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",l,n);else t("%s=r.%s()",l,o);t("break")}t("default:")("r.skipType(t&7)")("break")("}")("}");for(n=0;n<e._fieldsArray.length;++n){var c=e._fieldsArray[n];if(c.required)t("if(!m.hasOwnProperty(%j))",c.name)("throw util.ProtocolError(%j,{instance:m})",missing(c))}return t("return m")}},7511:(e,t,n)=>{"use strict";e.exports=encoder;var r=n(9344),i=n(8144),s=n(8431);function genTypePartial(e,t,n,r){return t.resolvedType.group?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(t.id<<3|2)>>>0)}function encoder(e){var t=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()");var n,a;var o=e.fieldsArray.slice().sort(s.compareFieldsById);for(var n=0;n<o.length;++n){var l=o[n].resolve(),c=e._fieldsArray.indexOf(l),u=l.resolvedType instanceof r?"int32":l.type,d=i.basic[u];a="m"+s.safeProp(l.name);if(l.map){t("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",a,l.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",a)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(l.id<<3|2)>>>0,8|i.mapKey[l.keyType],l.keyType);if(d===undefined)t("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",c,a);else t(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|d,u,a);t("}")("}")}else if(l.repeated){t("if(%s!=null&&%s.length){",a,a);if(l.packed&&i.packed[u]!==undefined){t("w.uint32(%i).fork()",(l.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",a)("w.%s(%s[i])",u,a)("w.ldelim()")}else{t("for(var i=0;i<%s.length;++i)",a);if(d===undefined)genTypePartial(t,l,c,a+"[i]");else t("w.uint32(%i).%s(%s[i])",(l.id<<3|d)>>>0,u,a)}t("}")}else{if(l.optional)t("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",a,l.name);if(d===undefined)genTypePartial(t,l,c,a);else t("w.uint32(%i).%s(%s)",(l.id<<3|d)>>>0,u,a)}}return t("return w")}},9344:(e,t,n)=>{"use strict";e.exports=Enum;var r=n(7582);((Enum.prototype=Object.create(r.prototype)).constructor=Enum).className="Enum";var i=n(7567),s=n(8431);function Enum(e,t,n,i,s){r.call(this,e,n);if(t&&typeof t!=="object")throw TypeError("values must be an object");this.valuesById={};this.values=Object.create(this.valuesById);this.comment=i;this.comments=s||{};this.reserved=undefined;if(t)for(var a=Object.keys(t),o=0;o<a.length;++o)if(typeof t[a[o]]==="number")this.valuesById[this.values[a[o]]=t[a[o]]]=a[o]}Enum.fromJSON=function fromJSON(e,t){var n=new Enum(e,t.values,t.options,t.comment,t.comments);n.reserved=t.reserved;return n};Enum.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return s.toObject(["options",this.options,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"comment",t?this.comment:undefined,"comments",t?this.comments:undefined])};Enum.prototype.add=function add(e,t,n){if(!s.isString(e))throw TypeError("name must be a string");if(!s.isInteger(t))throw TypeError("id must be an integer");if(this.values[e]!==undefined)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[t]!==undefined){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;this.comments[e]=n||null;return this};Enum.prototype.remove=function remove(e){if(!s.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(t==null)throw Error("name '"+e+"' does not exist in "+this);delete this.valuesById[t];delete this.values[e];delete this.comments[e];return this};Enum.prototype.isReservedId=function isReservedId(e){return i.isReservedId(this.reserved,e)};Enum.prototype.isReservedName=function isReservedName(e){return i.isReservedName(this.reserved,e)}},5794:(e,t,n)=>{"use strict";e.exports=Field;var r=n(7582);((Field.prototype=Object.create(r.prototype)).constructor=Field).className="Field";var i=n(9344),s=n(8144),a=n(8431);var o;var l=/^required|optional|repeated$/;Field.fromJSON=function fromJSON(e,t){return new Field(e,t.id,t.type,t.rule,t.extend,t.options,t.comment)};function Field(e,t,n,i,o,c,u){if(a.isObject(i)){u=o;c=i;i=o=undefined}else if(a.isObject(o)){u=c;c=o;o=undefined}r.call(this,e,c);if(!a.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!a.isString(n))throw TypeError("type must be a string");if(i!==undefined&&!l.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(o!==undefined&&!a.isString(o))throw TypeError("extend must be a string");if(i==="proto3_optional"){i="optional"}this.rule=i&&i!=="optional"?i:undefined;this.type=n;this.id=t;this.extend=o||undefined;this.required=i==="required";this.optional=!this.required;this.repeated=i==="repeated";this.map=false;this.message=null;this.partOf=null;this.typeDefault=null;this.defaultValue=null;this.long=a.Long?s.long[n]!==undefined:false;this.bytes=n==="bytes";this.resolvedType=null;this.extensionField=null;this.declaringField=null;this._packed=null;this.comment=u}Object.defineProperty(Field.prototype,"packed",{get:function(){if(this._packed===null)this._packed=this.getOption("packed")!==false;return this._packed}});Field.prototype.setOption=function setOption(e,t,n){if(e==="packed")this._packed=null;return r.prototype.setOption.call(this,e,t,n)};Field.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return a.toObject(["rule",this.rule!=="optional"&&this.rule||undefined,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])};Field.prototype.resolve=function resolve(){if(this.resolved)return this;if((this.typeDefault=s.defaults[this.type])===undefined){this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type);if(this.resolvedType instanceof o)this.typeDefault=null;else this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]}if(this.options&&this.options["default"]!=null){this.typeDefault=this.options["default"];if(this.resolvedType instanceof i&&typeof this.typeDefault==="string")this.typeDefault=this.resolvedType.values[this.typeDefault]}if(this.options){if(this.options.packed===true||this.options.packed!==undefined&&this.resolvedType&&!(this.resolvedType instanceof i))delete this.options.packed;if(!Object.keys(this.options).length)this.options=undefined}if(this.long){this.typeDefault=a.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u");if(Object.freeze)Object.freeze(this.typeDefault)}else if(this.bytes&&typeof this.typeDefault==="string"){var e;if(a.base64.test(this.typeDefault))a.base64.decode(this.typeDefault,e=a.newBuffer(a.base64.length(this.typeDefault)),0);else a.utf8.write(this.typeDefault,e=a.newBuffer(a.utf8.length(this.typeDefault)),0);this.typeDefault=e}if(this.map)this.defaultValue=a.emptyObject;else if(this.repeated)this.defaultValue=a.emptyArray;else this.defaultValue=this.typeDefault;if(this.parent instanceof o)this.parent.ctor.prototype[this.name]=this.defaultValue;return r.prototype.resolve.call(this)};Field.d=function decorateField(e,t,n,r){if(typeof t==="function")t=a.decorateType(t).name;else if(t&&typeof t==="object")t=a.decorateEnum(t).name;return function fieldDecorator(i,s){a.decorateType(i.constructor).add(new Field(s,e,t,n,{default:r}))}};Field._configure=function configure(e){o=e}},6087:(e,t,n)=>{"use strict";var r=e.exports=n(2999);r.build="light";function load(e,t,n){if(typeof t==="function"){n=t;t=new r.Root}else if(!t)t=new r.Root;return t.load(e,n)}r.load=load;function loadSync(e,t){if(!t)t=new r.Root;return t.loadSync(e)}r.loadSync=loadSync;r.encoder=n(7511);r.decoder=n(9939);r.verifier=n(9304);r.converter=n(1980);r.ReflectionObject=n(7582);r.Namespace=n(7567);r.Root=n(6420);r.Enum=n(9344);r.Type=n(3101);r.Field=n(5794);r.OneOf=n(3841);r.MapField=n(3031);r.Service=n(5560);r.Method=n(3655);r.Message=n(4811);r.wrappers=n(3147);r.types=n(8144);r.util=n(8431);r.ReflectionObject._configure(r.Root);r.Namespace._configure(r.Type,r.Service,r.Enum);r.Root._configure(r.Type);r.Field._configure(r.Type)},2999:(e,t,n)=>{"use strict";var r=t;r.build="minimal";r.Writer=n(8781);r.BufferWriter=n(7527);r.Reader=n(3246);r.BufferReader=n(5591);r.util=n(5537);r.rpc=n(7062);r.roots=n(741);r.configure=configure;function configure(){r.util._configure();r.Writer._configure(r.BufferWriter);r.Reader._configure(r.BufferReader)}configure()},9206:(e,t,n)=>{"use strict";var r=e.exports=n(6087);r.build="full";r.tokenize=n(817);r.parse=n(7265);r.common=n(4573);r.Root._configure(r.Type,r.parse,r.common)},3031:(e,t,n)=>{"use strict";e.exports=MapField;var r=n(5794);((MapField.prototype=Object.create(r.prototype)).constructor=MapField).className="MapField";var i=n(8144),s=n(8431);function MapField(e,t,n,i,a,o){r.call(this,e,t,i,undefined,undefined,a,o);if(!s.isString(n))throw TypeError("keyType must be a string");this.keyType=n;this.resolvedKeyType=null;this.map=true}MapField.fromJSON=function fromJSON(e,t){return new MapField(e,t.id,t.keyType,t.type,t.options,t.comment)};MapField.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:undefined])};MapField.prototype.resolve=function resolve(){if(this.resolved)return this;if(i.mapKey[this.keyType]===undefined)throw Error("invalid key type: "+this.keyType);return r.prototype.resolve.call(this)};MapField.d=function decorateMapField(e,t,n){if(typeof n==="function")n=s.decorateType(n).name;else if(n&&typeof n==="object")n=s.decorateEnum(n).name;return function mapFieldDecorator(r,i){s.decorateType(r.constructor).add(new MapField(i,e,t,n))}}},4811:(e,t,n)=>{"use strict";e.exports=Message;var r=n(5537);function Message(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)this[t[n]]=e[t[n]]}Message.create=function create(e){return this.$type.create(e)};Message.encode=function encode(e,t){return this.$type.encode(e,t)};Message.encodeDelimited=function encodeDelimited(e,t){return this.$type.encodeDelimited(e,t)};Message.decode=function decode(e){return this.$type.decode(e)};Message.decodeDelimited=function decodeDelimited(e){return this.$type.decodeDelimited(e)};Message.verify=function verify(e){return this.$type.verify(e)};Message.fromObject=function fromObject(e){return this.$type.fromObject(e)};Message.toObject=function toObject(e,t){return this.$type.toObject(e,t)};Message.prototype.toJSON=function toJSON(){return this.$type.toObject(this,r.toJSONOptions)}},3655:(e,t,n)=>{"use strict";e.exports=Method;var r=n(7582);((Method.prototype=Object.create(r.prototype)).constructor=Method).className="Method";var i=n(8431);function Method(e,t,n,s,a,o,l,c,u){if(i.isObject(a)){l=a;a=o=undefined}else if(i.isObject(o)){l=o;o=undefined}if(!(t===undefined||i.isString(t)))throw TypeError("type must be a string");if(!i.isString(n))throw TypeError("requestType must be a string");if(!i.isString(s))throw TypeError("responseType must be a string");r.call(this,e,l);this.type=t||"rpc";this.requestType=n;this.requestStream=a?true:undefined;this.responseType=s;this.responseStream=o?true:undefined;this.resolvedRequestType=null;this.resolvedResponseType=null;this.comment=c;this.parsedOptions=u}Method.fromJSON=function fromJSON(e,t){return new Method(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)};Method.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return i.toObject(["type",this.type!=="rpc"&&this.type||undefined,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:undefined,"parsedOptions",this.parsedOptions])};Method.prototype.resolve=function resolve(){if(this.resolved)return this;this.resolvedRequestType=this.parent.lookupType(this.requestType);this.resolvedResponseType=this.parent.lookupType(this.responseType);return r.prototype.resolve.call(this)}},7567:(e,t,n)=>{"use strict";e.exports=Namespace;var r=n(7582);((Namespace.prototype=Object.create(r.prototype)).constructor=Namespace).className="Namespace";var i=n(5794),s=n(3841),a=n(8431);var o,l,c;Namespace.fromJSON=function fromJSON(e,t){return new Namespace(e,t.options).addJSON(t.nested)};function arrayToJSON(e,t){if(!(e&&e.length))return undefined;var n={};for(var r=0;r<e.length;++r)n[e[r].name]=e[r].toJSON(t);return n}Namespace.arrayToJSON=arrayToJSON;Namespace.isReservedId=function isReservedId(e,t){if(e)for(var n=0;n<e.length;++n)if(typeof e[n]!=="string"&&e[n][0]<=t&&e[n][1]>t)return true;return false};Namespace.isReservedName=function isReservedName(e,t){if(e)for(var n=0;n<e.length;++n)if(e[n]===t)return true;return false};function Namespace(e,t){r.call(this,e,t);this.nested=undefined;this._nestedArray=null}function clearCache(e){e._nestedArray=null;return e}Object.defineProperty(Namespace.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=a.toArray(this.nested))}});Namespace.prototype.toJSON=function toJSON(e){return a.toObject(["options",this.options,"nested",arrayToJSON(this.nestedArray,e)])};Namespace.prototype.addJSON=function addJSON(e){var t=this;if(e){for(var n=Object.keys(e),r=0,s;r<n.length;++r){s=e[n[r]];t.add((s.fields!==undefined?o.fromJSON:s.values!==undefined?c.fromJSON:s.methods!==undefined?l.fromJSON:s.id!==undefined?i.fromJSON:Namespace.fromJSON)(n[r],s))}}return this};Namespace.prototype.get=function get(e){return this.nested&&this.nested[e]||null};Namespace.prototype.getEnum=function getEnum(e){if(this.nested&&this.nested[e]instanceof c)return this.nested[e].values;throw Error("no such enum: "+e)};Namespace.prototype.add=function add(e){if(!(e instanceof i&&e.extend!==undefined||e instanceof o||e instanceof c||e instanceof l||e instanceof Namespace||e instanceof s))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var t=this.get(e.name);if(t){if(t instanceof Namespace&&e instanceof Namespace&&!(t instanceof o||t instanceof l)){var n=t.nestedArray;for(var r=0;r<n.length;++r)e.add(n[r]);this.remove(t);if(!this.nested)this.nested={};e.setOptions(t.options,true)}else throw Error("duplicate name '"+e.name+"' in "+this)}}this.nested[e.name]=e;e.onAdd(this);return clearCache(this)};Namespace.prototype.remove=function remove(e){if(!(e instanceof r))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);delete this.nested[e.name];if(!Object.keys(this.nested).length)this.nested=undefined;e.onRemove(this);return clearCache(this)};Namespace.prototype.define=function define(e,t){if(a.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");var n=this;while(e.length>0){var r=e.shift();if(n.nested&&n.nested[r]){n=n.nested[r];if(!(n instanceof Namespace))throw Error("path conflicts with non-namespace objects")}else n.add(n=new Namespace(r))}if(t)n.addJSON(t);return n};Namespace.prototype.resolveAll=function resolveAll(){var e=this.nestedArray,t=0;while(t<e.length)if(e[t]instanceof Namespace)e[t++].resolveAll();else e[t++].resolve();return this.resolve()};Namespace.prototype.lookup=function lookup(e,t,n){if(typeof t==="boolean"){n=t;t=undefined}else if(t&&!Array.isArray(t))t=[t];if(a.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),t);var r=this.get(e[0]);if(r){if(e.length===1){if(!t||t.indexOf(r.constructor)>-1)return r}else if(r instanceof Namespace&&(r=r.lookup(e.slice(1),t,true)))return r}else for(var i=0;i<this.nestedArray.length;++i)if(this._nestedArray[i]instanceof Namespace&&(r=this._nestedArray[i].lookup(e,t,true)))return r;if(this.parent===null||n)return null;return this.parent.lookup(e,t)};Namespace.prototype.lookupType=function lookupType(e){var t=this.lookup(e,[o]);if(!t)throw Error("no such type: "+e);return t};Namespace.prototype.lookupEnum=function lookupEnum(e){var t=this.lookup(e,[c]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t};Namespace.prototype.lookupTypeOrEnum=function lookupTypeOrEnum(e){var t=this.lookup(e,[o,c]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t};Namespace.prototype.lookupService=function lookupService(e){var t=this.lookup(e,[l]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t};Namespace._configure=function(e,t,n){o=e;l=t;c=n}},7582:(e,t,n)=>{"use strict";e.exports=ReflectionObject;ReflectionObject.className="ReflectionObject";var r=n(8431);var i;function ReflectionObject(e,t){if(!r.isString(e))throw TypeError("name must be a string");if(t&&!r.isObject(t))throw TypeError("options must be an object");this.options=t;this.parsedOptions=null;this.name=e;this.parent=null;this.resolved=false;this.comment=null;this.filename=null}Object.defineProperties(ReflectionObject.prototype,{root:{get:function(){var e=this;while(e.parent!==null)e=e.parent;return e}},fullName:{get:function(){var e=[this.name],t=this.parent;while(t){e.unshift(t.name);t=t.parent}return e.join(".")}}});ReflectionObject.prototype.toJSON=function toJSON(){throw Error()};ReflectionObject.prototype.onAdd=function onAdd(e){if(this.parent&&this.parent!==e)this.parent.remove(this);this.parent=e;this.resolved=false;var t=e.root;if(t instanceof i)t._handleAdd(this)};ReflectionObject.prototype.onRemove=function onRemove(e){var t=e.root;if(t instanceof i)t._handleRemove(this);this.parent=null;this.resolved=false};ReflectionObject.prototype.resolve=function resolve(){if(this.resolved)return this;if(this.root instanceof i)this.resolved=true;return this};ReflectionObject.prototype.getOption=function getOption(e){if(this.options)return this.options[e];return undefined};ReflectionObject.prototype.setOption=function setOption(e,t,n){if(!n||!this.options||this.options[e]===undefined)(this.options||(this.options={}))[e]=t;return this};ReflectionObject.prototype.setParsedOption=function setParsedOption(e,t,n){if(!this.parsedOptions){this.parsedOptions=[]}var i=this.parsedOptions;if(n){var s=i.find((function(t){return Object.prototype.hasOwnProperty.call(t,e)}));if(s){var a=s[e];r.setProperty(a,n,t)}else{s={};s[e]=r.setProperty({},n,t);i.push(s)}}else{var o={};o[e]=t;i.push(o)}return this};ReflectionObject.prototype.setOptions=function setOptions(e,t){if(e)for(var n=Object.keys(e),r=0;r<n.length;++r)this.setOption(n[r],e[n[r]],t);return this};ReflectionObject.prototype.toString=function toString(){var e=this.constructor.className,t=this.fullName;if(t.length)return e+" "+t;return e};ReflectionObject._configure=function(e){i=e}},3841:(e,t,n)=>{"use strict";e.exports=OneOf;var r=n(7582);((OneOf.prototype=Object.create(r.prototype)).constructor=OneOf).className="OneOf";var i=n(5794),s=n(8431);function OneOf(e,t,n,i){if(!Array.isArray(t)){n=t;t=undefined}r.call(this,e,n);if(!(t===undefined||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[];this.fieldsArray=[];this.comment=i}OneOf.fromJSON=function fromJSON(e,t){return new OneOf(e,t.oneof,t.options,t.comment)};OneOf.prototype.toJSON=function toJSON(e){var t=e?Boolean(e.keepComments):false;return s.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:undefined])};function addFieldsToParent(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)if(!e.fieldsArray[t].parent)e.parent.add(e.fieldsArray[t])}OneOf.prototype.add=function add(e){if(!(e instanceof i))throw TypeError("field must be a Field");if(e.parent&&e.parent!==this.parent)e.parent.remove(e);this.oneof.push(e.name);this.fieldsArray.push(e);e.partOf=this;addFieldsToParent(this);return this};OneOf.prototype.remove=function remove(e){if(!(e instanceof i))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);this.fieldsArray.splice(t,1);t=this.oneof.indexOf(e.name);if(t>-1)this.oneof.splice(t,1);e.partOf=null;return this};OneOf.prototype.onAdd=function onAdd(e){r.prototype.onAdd.call(this,e);var t=this;for(var n=0;n<this.oneof.length;++n){var i=e.get(this.oneof[n]);if(i&&!i.partOf){i.partOf=t;t.fieldsArray.push(i)}}addFieldsToParent(this)};OneOf.prototype.onRemove=function onRemove(e){for(var t=0,n;t<this.fieldsArray.length;++t)if((n=this.fieldsArray[t]).parent)n.parent.remove(n);r.prototype.onRemove.call(this,e)};OneOf.d=function decorateOneOf(){var e=new Array(arguments.length),t=0;while(t<arguments.length)e[t]=arguments[t++];return function oneOfDecorator(t,n){s.decorateType(t.constructor).add(new OneOf(n,e));Object.defineProperty(t,n,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},7265:(e,t,n)=>{"use strict";e.exports=parse;parse.filename=null;parse.defaults={keepCase:false};var r=n(817),i=n(6420),s=n(3101),a=n(5794),o=n(3031),l=n(3841),c=n(9344),u=n(5560),d=n(3655),h=n(8144),f=n(8431);var p=/^[1-9][0-9]*$/,m=/^-?[1-9][0-9]*$/,g=/^0[x][0-9a-fA-F]+$/,v=/^-?0[x][0-9a-fA-F]+$/,y=/^0[0-7]+$/,S=/^-?0[0-7]+$/,b=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,C=/^[a-zA-Z_][a-zA-Z_0-9]*$/,_=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,T=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function parse(e,t,n){if(!(t instanceof i)){n=t;t=new i}if(!n)n=parse.defaults;var E=n.preferTrailingComment||false;var R=r(e,n.alternateCommentMode||false),w=R.next,O=R.push,k=R.peek,A=R.skip,N=R.cmnt;var I=true,P,D,M,x,L=false;var F=t;var j=n.keepCase?function(e){return e}:f.camelCase;function illegal(e,t,n){var r=parse.filename;if(!n)parse.filename=null;return Error("illegal "+(t||"token")+" '"+e+"' ("+(r?r+", ":"")+"line "+R.line+")")}function readString(){var e=[],t;do{if((t=w())!=='"'&&t!=="'")throw illegal(t);e.push(w());A(t);t=k()}while(t==='"'||t==="'");return e.join("")}function readValue(e){var t=w();switch(t){case"'":case'"':O(t);return readString();case"true":case"TRUE":return true;case"false":case"FALSE":return false}try{return parseNumber(t,true)}catch(n){if(e&&_.test(t))return t;throw illegal(t,"value")}}function readRanges(e,t){var n,r;do{if(t&&((n=k())==='"'||n==="'"))e.push(readString());else e.push([r=parseId(w()),A("to",true)?parseId(w()):r])}while(A(",",true));A(";")}function parseNumber(e,t){var n=1;if(e.charAt(0)==="-"){n=-1;e=e.substring(1)}switch(e){case"inf":case"INF":case"Inf":return n*Infinity;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(p.test(e))return n*parseInt(e,10);if(g.test(e))return n*parseInt(e,16);if(y.test(e))return n*parseInt(e,8);if(b.test(e))return n*parseFloat(e);throw illegal(e,"number",t)}function parseId(e,t){switch(e){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!t&&e.charAt(0)==="-")throw illegal(e,"id");if(m.test(e))return parseInt(e,10);if(v.test(e))return parseInt(e,16);if(S.test(e))return parseInt(e,8);throw illegal(e,"id")}function parsePackage(){if(P!==undefined)throw illegal("package");P=w();if(!_.test(P))throw illegal(P,"name");F=F.define(P);A(";")}function parseImport(){var e=k();var t;switch(e){case"weak":t=M||(M=[]);w();break;case"public":w();default:t=D||(D=[]);break}e=readString();A(";");t.push(e)}function parseSyntax(){A("=");x=readString();L=x==="proto3";if(!L&&x!=="proto2")throw illegal(x,"syntax");A(";")}function parseCommon(e,t){switch(t){case"option":parseOption(e,t);A(";");return true;case"message":parseType(e,t);return true;case"enum":parseEnum(e,t);return true;case"service":parseService(e,t);return true;case"extend":parseExtension(e,t);return true}return false}function ifBlock(e,t,n){var r=R.line;if(e){if(typeof e.comment!=="string"){e.comment=N()}e.filename=parse.filename}if(A("{",true)){var i;while((i=w())!=="}")t(i);A(";",true)}else{if(n)n();A(";");if(e&&(typeof e.comment!=="string"||E))e.comment=N(r)||e.comment}}function parseType(e,t){if(!C.test(t=w()))throw illegal(t,"type name");var n=new s(t);ifBlock(n,(function parseType_block(e){if(parseCommon(n,e))return;switch(e){case"map":parseMapField(n,e);break;case"required":case"repeated":parseField(n,e);break;case"optional":if(L){parseField(n,"proto3_optional")}else{parseField(n,"optional")}break;case"oneof":parseOneOf(n,e);break;case"extensions":readRanges(n.extensions||(n.extensions=[]));break;case"reserved":readRanges(n.reserved||(n.reserved=[]),true);break;default:if(!L||!_.test(e))throw illegal(e);O(e);parseField(n,"optional");break}}));e.add(n)}function parseField(e,t,n){var r=w();if(r==="group"){parseGroup(e,t);return}if(!_.test(r))throw illegal(r,"type");var i=w();if(!C.test(i))throw illegal(i,"name");i=j(i);A("=");var s=new a(i,parseId(w()),r,t,n);ifBlock(s,(function parseField_block(e){if(e==="option"){parseOption(s,e);A(";")}else throw illegal(e)}),(function parseField_line(){parseInlineOptions(s)}));if(t==="proto3_optional"){var o=new l("_"+i);s.setOption("proto3_optional",true);o.add(s);e.add(o)}else{e.add(s)}if(!L&&s.repeated&&(h.packed[r]!==undefined||h.basic[r]===undefined))s.setOption("packed",false,true)}function parseGroup(e,t){var n=w();if(!C.test(n))throw illegal(n,"name");var r=f.lcFirst(n);if(n===r)n=f.ucFirst(n);A("=");var i=parseId(w());var o=new s(n);o.group=true;var l=new a(r,i,n,t);l.filename=parse.filename;ifBlock(o,(function parseGroup_block(e){switch(e){case"option":parseOption(o,e);A(";");break;case"required":case"repeated":parseField(o,e);break;case"optional":if(L){parseField(o,"proto3_optional")}else{parseField(o,"optional")}break;default:throw illegal(e)}}));e.add(o).add(l)}function parseMapField(e){A("<");var t=w();if(h.mapKey[t]===undefined)throw illegal(t,"type");A(",");var n=w();if(!_.test(n))throw illegal(n,"type");A(">");var r=w();if(!C.test(r))throw illegal(r,"name");A("=");var i=new o(j(r),parseId(w()),t,n);ifBlock(i,(function parseMapField_block(e){if(e==="option"){parseOption(i,e);A(";")}else throw illegal(e)}),(function parseMapField_line(){parseInlineOptions(i)}));e.add(i)}function parseOneOf(e,t){if(!C.test(t=w()))throw illegal(t,"name");var n=new l(j(t));ifBlock(n,(function parseOneOf_block(e){if(e==="option"){parseOption(n,e);A(";")}else{O(e);parseField(n,"optional")}}));e.add(n)}function parseEnum(e,t){if(!C.test(t=w()))throw illegal(t,"name");var n=new c(t);ifBlock(n,(function parseEnum_block(e){switch(e){case"option":parseOption(n,e);A(";");break;case"reserved":readRanges(n.reserved||(n.reserved=[]),true);break;default:parseEnumValue(n,e)}}));e.add(n)}function parseEnumValue(e,t){if(!C.test(t))throw illegal(t,"name");A("=");var n=parseId(w(),true),r={};ifBlock(r,(function parseEnumValue_block(e){if(e==="option"){parseOption(r,e);A(";")}else throw illegal(e)}),(function parseEnumValue_line(){parseInlineOptions(r)}));e.add(t,n,r.comment)}function parseOption(e,t){var n=A("(",true);if(!_.test(t=w()))throw illegal(t,"name");var r=t;var i=r;var s;if(n){A(")");r="("+r+")";i=r;t=k();if(T.test(t)){s=t.substr(1);r+=t;w()}}A("=");var a=parseOptionValue(e,r);setParsedOption(e,i,a,s)}function parseOptionValue(e,t){if(A("{",true)){var n={};while(!A("}",true)){if(!C.test(B=w()))throw illegal(B,"name");var r;var i=B;if(k()==="{")r=parseOptionValue(e,t+"."+B);else{A(":");if(k()==="{")r=parseOptionValue(e,t+"."+B);else{r=readValue(true);setOption(e,t+"."+B,r)}}var s=n[i];if(s)r=[].concat(s).concat(r);n[i]=r;A(",",true)}return n}var a=readValue(true);setOption(e,t,a);return a}function setOption(e,t,n){if(e.setOption)e.setOption(t,n)}function setParsedOption(e,t,n,r){if(e.setParsedOption)e.setParsedOption(t,n,r)}function parseInlineOptions(e){if(A("[",true)){do{parseOption(e,"option")}while(A(",",true));A("]")}return e}function parseService(e,t){if(!C.test(t=w()))throw illegal(t,"service name");var n=new u(t);ifBlock(n,(function parseService_block(e){if(parseCommon(n,e))return;if(e==="rpc")parseMethod(n,e);else throw illegal(e)}));e.add(n)}function parseMethod(e,t){var n=N();var r=t;if(!C.test(t=w()))throw illegal(t,"name");var i=t,s,a,o,l;A("(");if(A("stream",true))a=true;if(!_.test(t=w()))throw illegal(t);s=t;A(")");A("returns");A("(");if(A("stream",true))l=true;if(!_.test(t=w()))throw illegal(t);o=t;A(")");var c=new d(i,r,s,o,a,l);c.comment=n;ifBlock(c,(function parseMethod_block(e){if(e==="option"){parseOption(c,e);A(";")}else throw illegal(e)}));e.add(c)}function parseExtension(e,t){if(!_.test(t=w()))throw illegal(t,"reference");var n=t;ifBlock(null,(function parseExtension_block(t){switch(t){case"required":case"repeated":parseField(e,t,n);break;case"optional":if(L){parseField(e,"proto3_optional",n)}else{parseField(e,"optional",n)}break;default:if(!L||!_.test(t))throw illegal(t);O(t);parseField(e,"optional",n);break}}))}var B;while((B=w())!==null){switch(B){case"package":if(!I)throw illegal(B);parsePackage();break;case"import":if(!I)throw illegal(B);parseImport();break;case"syntax":if(!I)throw illegal(B);parseSyntax();break;case"option":parseOption(F,B);A(";");break;default:if(parseCommon(F,B)){I=false;continue}throw illegal(B)}}parse.filename=null;return{package:P,imports:D,weakImports:M,syntax:x,root:t}}},3246:(e,t,n)=>{"use strict";e.exports=Reader;var r=n(5537);var i;var s=r.LongBits,a=r.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e;this.pos=0;this.len=e.length}var o=typeof Uint8Array!=="undefined"?function create_typed_array(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function create_array(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")};var l=function create(){return r.Buffer?function create_buffer_setup(e){return(Reader.create=function create_buffer(e){return r.Buffer.isBuffer(e)?new i(e):o(e)})(e)}:o};Reader.create=l();Reader.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice;Reader.prototype.uint32=function read_uint32_setup(){var e=4294967295;return function read_uint32(){e=(this.buf[this.pos]&127)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&127)<<7)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&127)<<14)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&127)<<21)>>>0;if(this.buf[this.pos++]<128)return e;e=(e|(this.buf[this.pos]&15)<<28)>>>0;if(this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len){this.pos=this.len;throw indexOutOfRange(this,10)}return e}}();Reader.prototype.int32=function read_int32(){return this.uint32()|0};Reader.prototype.sint32=function read_sint32(){var e=this.uint32();return e>>>1^-(e&1)|0};function readLongVarint(){var e=new s(0,0);var t=0;if(this.len-this.pos>4){for(;t<4;++t){e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0;e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0;if(this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0;if(this.buf[this.pos++]<128)return e}e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0;return e}if(this.len-this.pos>4){for(;t<5;++t){e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}else{for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0;if(this.buf[this.pos++]<128)return e}}throw Error("invalid varint encoding")}Reader.prototype.bool=function read_bool(){return this.uint32()!==0};function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Reader.prototype.fixed32=function read_fixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)};Reader.prototype.sfixed32=function read_sfixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new s(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.prototype.float=function read_float(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=r.float.readFloatLE(this.buf,this.pos);this.pos+=4;return e};Reader.prototype.double=function read_double(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);this.pos+=8;return e};Reader.prototype.bytes=function read_bytes(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw indexOutOfRange(this,e);this.pos+=e;if(Array.isArray(this.buf))return this.buf.slice(t,n);return t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)};Reader.prototype.string=function read_string(){var e=this.bytes();return a.read(e,0,e.length)};Reader.prototype.skip=function skip(e){if(typeof e==="number"){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else{do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(this.buf[this.pos++]&128)}return this};Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:while((e=this.uint32()&7)!==4){this.skipType(e)}break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Reader._configure=function(e){i=e;Reader.create=l();i._configure();var t=r.Long?"toLong":"toNumber";r.merge(Reader.prototype,{int64:function read_int64(){return readLongVarint.call(this)[t](false)},uint64:function read_uint64(){return readLongVarint.call(this)[t](true)},sint64:function read_sint64(){return readLongVarint.call(this).zzDecode()[t](false)},fixed64:function read_fixed64(){return readFixed64.call(this)[t](true)},sfixed64:function read_sfixed64(){return readFixed64.call(this)[t](false)}})}},5591:(e,t,n)=>{"use strict";e.exports=BufferReader;var r=n(3246);(BufferReader.prototype=Object.create(r.prototype)).constructor=BufferReader;var i=n(5537);function BufferReader(e){r.call(this,e)}BufferReader._configure=function(){if(i.Buffer)BufferReader.prototype._slice=i.Buffer.prototype.slice};BufferReader.prototype.string=function read_string_buffer(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};BufferReader._configure()},6420:(e,t,n)=>{"use strict";e.exports=Root;var r=n(7567);((Root.prototype=Object.create(r.prototype)).constructor=Root).className="Root";var i=n(5794),s=n(9344),a=n(3841),o=n(8431);var l,c,u;function Root(e){r.call(this,"",e);this.deferred=[];this.files=[]}Root.fromJSON=function fromJSON(e,t){if(!t)t=new Root;if(e.options)t.setOptions(e.options);return t.addJSON(e.nested)};Root.prototype.resolvePath=o.path.resolve;Root.prototype.fetch=o.fetch;function SYNC(){}Root.prototype.load=function load(e,t,n){if(typeof t==="function"){n=t;t=undefined}var r=this;if(!n)return o.asPromise(load,r,e,t);var i=n===SYNC;function finish(e,t){if(!n)return;var r=n;n=null;if(i)throw e;r(e,t)}function getBundledFileName(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var n=e.substring(t);if(n in u)return n}return null}function process(e,n){try{if(o.isString(n)&&n.charAt(0)==="{")n=JSON.parse(n);if(!o.isString(n))r.setOptions(n.options).addJSON(n.nested);else{c.filename=e;var a=c(n,r,t),l,u=0;if(a.imports)for(;u<a.imports.length;++u)if(l=getBundledFileName(a.imports[u])||r.resolvePath(e,a.imports[u]))fetch(l);if(a.weakImports)for(u=0;u<a.weakImports.length;++u)if(l=getBundledFileName(a.weakImports[u])||r.resolvePath(e,a.weakImports[u]))fetch(l,true)}}catch(e){finish(e)}if(!i&&!s)finish(null,r)}function fetch(e,t){if(r.files.indexOf(e)>-1)return;r.files.push(e);if(e in u){if(i)process(e,u[e]);else{++s;setTimeout((function(){--s;process(e,u[e])}))}return}if(i){var a;try{a=o.fs.readFileSync(e).toString("utf8")}catch(e){if(!t)finish(e);return}process(e,a)}else{++s;r.fetch(e,(function(i,a){--s;if(!n)return;if(i){if(!t)finish(i);else if(!s)finish(null,r);return}process(e,a)}))}}var s=0;if(o.isString(e))e=[e];for(var a=0,l;a<e.length;++a)if(l=r.resolvePath("",e[a]))fetch(l);if(i)return r;if(!s)finish(null,r);return undefined};Root.prototype.loadSync=function loadSync(e,t){if(!o.isNode)throw Error("not supported");return this.load(e,t,SYNC)};Root.prototype.resolveAll=function resolveAll(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map((function(e){return"'extend "+e.extend+"' in "+e.parent.fullName})).join(", "));return r.prototype.resolveAll.call(this)};var d=/^[A-Z]/;function tryHandleExtension(e,t){var n=t.parent.lookup(t.extend);if(n){var r=new i(t.fullName,t.id,t.type,t.rule,undefined,t.options);r.declaringField=t;t.extensionField=r;n.add(r);return true}return false}Root.prototype._handleAdd=function _handleAdd(e){if(e instanceof i){if(e.extend!==undefined&&!e.extensionField)if(!tryHandleExtension(this,e))this.deferred.push(e)}else if(e instanceof s){if(d.test(e.name))e.parent[e.name]=e.values}else if(!(e instanceof a)){if(e instanceof l)for(var t=0;t<this.deferred.length;)if(tryHandleExtension(this,this.deferred[t]))this.deferred.splice(t,1);else++t;for(var n=0;n<e.nestedArray.length;++n)this._handleAdd(e._nestedArray[n]);if(d.test(e.name))e.parent[e.name]=e}};Root.prototype._handleRemove=function _handleRemove(e){if(e instanceof i){if(e.extend!==undefined){if(e.extensionField){e.extensionField.parent.remove(e.extensionField);e.extensionField=null}else{var t=this.deferred.indexOf(e);if(t>-1)this.deferred.splice(t,1)}}}else if(e instanceof s){if(d.test(e.name))delete e.parent[e.name]}else if(e instanceof r){for(var n=0;n<e.nestedArray.length;++n)this._handleRemove(e._nestedArray[n]);if(d.test(e.name))delete e.parent[e.name]}};Root._configure=function(e,t,n){l=e;c=t;u=n}},741:e=>{"use strict";e.exports={}},7062:(e,t,n)=>{"use strict";var r=t;r.Service=n(4523)},4523:(e,t,n)=>{"use strict";e.exports=Service;var r=n(5537);(Service.prototype=Object.create(r.EventEmitter.prototype)).constructor=Service;function Service(e,t,n){if(typeof e!=="function")throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this);this.rpcImpl=e;this.requestDelimited=Boolean(t);this.responseDelimited=Boolean(n)}Service.prototype.rpcCall=function rpcCall(e,t,n,i,s){if(!i)throw TypeError("request must be specified");var a=this;if(!s)return r.asPromise(rpcCall,a,e,t,n,i);if(!a.rpcImpl){setTimeout((function(){s(Error("already ended"))}),0);return undefined}try{return a.rpcImpl(e,t[a.requestDelimited?"encodeDelimited":"encode"](i).finish(),(function rpcCallback(t,r){if(t){a.emit("error",t,e);return s(t)}if(r===null){a.end(true);return undefined}if(!(r instanceof n)){try{r=n[a.responseDelimited?"decodeDelimited":"decode"](r)}catch(t){a.emit("error",t,e);return s(t)}}a.emit("data",r,e);return s(null,r)}))}catch(t){a.emit("error",t,e);setTimeout((function(){s(t)}),0);return undefined}};Service.prototype.end=function end(e){if(this.rpcImpl){if(!e)this.rpcImpl(null,null,null);this.rpcImpl=null;this.emit("end").off()}return this}},5560:(e,t,n)=>{"use strict";e.exports=Service;var r=n(7567);((Service.prototype=Object.create(r.prototype)).constructor=Service).className="Service";var i=n(3655),s=n(8431),a=n(7062);function Service(e,t){r.call(this,e,t);this.methods={};this._methodsArray=null}Service.fromJSON=function fromJSON(e,t){var n=new Service(e,t.options);if(t.methods)for(var r=Object.keys(t.methods),s=0;s<r.length;++s)n.add(i.fromJSON(r[s],t.methods[r[s]]));if(t.nested)n.addJSON(t.nested);n.comment=t.comment;return n};Service.prototype.toJSON=function toJSON(e){var t=r.prototype.toJSON.call(this,e);var n=e?Boolean(e.keepComments):false;return s.toObject(["options",t&&t.options||undefined,"methods",r.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||undefined,"comment",n?this.comment:undefined])};Object.defineProperty(Service.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}});function clearCache(e){e._methodsArray=null;return e}Service.prototype.get=function get(e){return this.methods[e]||r.prototype.get.call(this,e)};Service.prototype.resolveAll=function resolveAll(){var e=this.methodsArray;for(var t=0;t<e.length;++t)e[t].resolve();return r.prototype.resolve.call(this)};Service.prototype.add=function add(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof i){this.methods[e.name]=e;e.parent=this;return clearCache(this)}return r.prototype.add.call(this,e)};Service.prototype.remove=function remove(e){if(e instanceof i){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);delete this.methods[e.name];e.parent=null;return clearCache(this)}return r.prototype.remove.call(this,e)};Service.prototype.create=function create(e,t,n){var r=new a.Service(e,t,n);for(var i=0,o;i<this.methodsArray.length;++i){var l=s.lcFirst((o=this._methodsArray[i]).resolve().name).replace(/[^$\w_]/g,"");r[l]=s.codegen(["r","c"],s.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return r}},817:e=>{"use strict";e.exports=tokenize;var t=/[\s{}=;:[\],'"()<>]/g,n=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,r=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g;var i=/^ *[*/]+ */,s=/^\s*\*?\/*/,a=/\n/g,o=/\s/,l=/\\(.?)/g;var c={0:"\0",r:"\r",n:"\n",t:"\t"};function unescape(e){return e.replace(l,(function(e,t){switch(t){case"\\":case"":return t;default:return c[t]||""}}))}tokenize.unescape=unescape;function tokenize(e,l){e=e.toString();var c=0,u=e.length,d=1,h=null,f=null,p=0,m=false,g=false;var v=[];var y=null;function illegal(e){return Error("illegal "+e+" (line "+d+")")}function readString(){var t=y==="'"?r:n;t.lastIndex=c-1;var i=t.exec(e);if(!i)throw illegal("string");c=t.lastIndex;push(y);y=null;return unescape(i[1])}function charAt(t){return e.charAt(t)}function setComment(t,n,r){h=e.charAt(t++);p=d;m=false;g=r;var o;if(l){o=2}else{o=3}var c=t-o,u;do{if(--c<0||(u=e.charAt(c))==="\n"){m=true;break}}while(u===" "||u==="\t");var v=e.substring(t,n).split(a);for(var y=0;y<v.length;++y)v[y]=v[y].replace(l?s:i,"").trim();f=v.join("\n").trim()}function isDoubleSlashCommentLine(t){var n=findEndOfLine(t);var r=e.substring(t,n);var i=/^\s*\/{1,2}/.test(r);return i}function findEndOfLine(e){var t=e;while(t<u&&charAt(t)!=="\n"){t++}return t}function next(){if(v.length>0)return v.shift();if(y)return readString();var n,r,i,s,a,h=c===0;do{if(c===u)return null;n=false;while(o.test(i=charAt(c))){if(i==="\n"){h=true;++d}if(++c===u)return null}if(charAt(c)==="/"){if(++c===u){throw illegal("comment")}if(charAt(c)==="/"){if(!l){a=charAt(s=c+1)==="/";while(charAt(++c)!=="\n"){if(c===u){return null}}++c;if(a){setComment(s,c-1,h)}++d;n=true}else{s=c;a=false;if(isDoubleSlashCommentLine(c)){a=true;do{c=findEndOfLine(c);if(c===u){break}c++}while(isDoubleSlashCommentLine(c))}else{c=Math.min(u,findEndOfLine(c)+1)}if(a){setComment(s,c,h)}d++;n=true}}else if((i=charAt(c))==="*"){s=c+1;a=l||charAt(s)==="*";do{if(i==="\n"){++d}if(++c===u){throw illegal("comment")}r=i;i=charAt(c)}while(r!=="*"||i!=="/");++c;if(a){setComment(s,c-2,h)}n=true}else{return"/"}}}while(n);var f=c;t.lastIndex=0;var p=t.test(charAt(f++));if(!p)while(f<u&&!t.test(charAt(f)))++f;var m=e.substring(c,c=f);if(m==='"'||m==="'")y=m;return m}function push(e){v.push(e)}function peek(){if(!v.length){var e=next();if(e===null)return null;push(e)}return v[0]}function skip(e,t){var n=peek(),r=n===e;if(r){next();return true}if(!t)throw illegal("token '"+n+"', '"+e+"' expected");return false}function cmnt(e){var t=null;if(e===undefined){if(p===d-1&&(l||h==="*"||m)){t=g?f:null}}else{if(p<e){peek()}if(p===e&&!m&&(l||h==="/")){t=g?null:f}}return t}return Object.defineProperty({next:next,peek:peek,push:push,skip:skip,cmnt:cmnt},"line",{get:function(){return d}})}},3101:(e,t,n)=>{"use strict";e.exports=Type;var r=n(7567);((Type.prototype=Object.create(r.prototype)).constructor=Type).className="Type";var i=n(9344),s=n(3841),a=n(5794),o=n(3031),l=n(5560),c=n(4811),u=n(3246),d=n(8781),h=n(8431),f=n(7511),p=n(9939),m=n(9304),g=n(1980),v=n(3147);function Type(e,t){r.call(this,e,t);this.fields={};this.oneofs=undefined;this.extensions=undefined;this.reserved=undefined;this.group=undefined;this._fieldsById=null;this._fieldsArray=null;this._oneofsArray=null;this._ctor=null}Object.defineProperties(Type.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var n=this.fields[e[t]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=h.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=h.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Type.generateConstructor(this)())},set:function(e){var t=e.prototype;if(!(t instanceof c)){(e.prototype=new c).constructor=e;h.merge(e.prototype,t)}e.$type=e.prototype.$type=this;h.merge(e,c,true);this._ctor=e;var n=0;for(;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:h.oneOfGetter(this._oneofsArray[n].oneof),set:h.oneOfSetter(this._oneofsArray[n].oneof)};if(n)Object.defineProperties(e.prototype,r)}}});Type.generateConstructor=function generateConstructor(e){var t=h.codegen(["p"],e.name);for(var n=0,r;n<e.fieldsArray.length;++n)if((r=e._fieldsArray[n]).map)t("this%s={}",h.safeProp(r.name));else if(r.repeated)t("this%s=[]",h.safeProp(r.name));return t("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function clearCache(e){e._fieldsById=e._fieldsArray=e._oneofsArray=null;delete e.encode;delete e.decode;delete e.verify;return e}Type.fromJSON=function fromJSON(e,t){var n=new Type(e,t.options);n.extensions=t.extensions;n.reserved=t.reserved;var c=Object.keys(t.fields),u=0;for(;u<c.length;++u)n.add((typeof t.fields[c[u]].keyType!=="undefined"?o.fromJSON:a.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)n.add(s.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var d=t.nested[c[u]];n.add((d.id!==undefined?a.fromJSON:d.fields!==undefined?Type.fromJSON:d.values!==undefined?i.fromJSON:d.methods!==undefined?l.fromJSON:r.fromJSON)(c[u],d))}if(t.extensions&&t.extensions.length)n.extensions=t.extensions;if(t.reserved&&t.reserved.length)n.reserved=t.reserved;if(t.group)n.group=true;if(t.comment)n.comment=t.comment;return n};Type.prototype.toJSON=function toJSON(e){var t=r.prototype.toJSON.call(this,e);var n=e?Boolean(e.keepComments):false;return h.toObject(["options",t&&t.options||undefined,"oneofs",r.arrayToJSON(this.oneofsArray,e),"fields",r.arrayToJSON(this.fieldsArray.filter((function(e){return!e.declaringField})),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:undefined,"reserved",this.reserved&&this.reserved.length?this.reserved:undefined,"group",this.group||undefined,"nested",t&&t.nested||undefined,"comment",n?this.comment:undefined])};Type.prototype.resolveAll=function resolveAll(){var e=this.fieldsArray,t=0;while(t<e.length)e[t++].resolve();var n=this.oneofsArray;t=0;while(t<n.length)n[t++].resolve();return r.prototype.resolveAll.call(this)};Type.prototype.get=function get(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Type.prototype.add=function add(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&e.extend===undefined){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);if(e.parent)e.parent.remove(e);this.fields[e.name]=e;e.message=this;e.onAdd(this);return clearCache(this)}if(e instanceof s){if(!this.oneofs)this.oneofs={};this.oneofs[e.name]=e;e.onAdd(this);return clearCache(this)}return r.prototype.add.call(this,e)};Type.prototype.remove=function remove(e){if(e instanceof a&&e.extend===undefined){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);delete this.fields[e.name];e.parent=null;e.onRemove(this);return clearCache(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);delete this.oneofs[e.name];e.parent=null;e.onRemove(this);return clearCache(this)}return r.prototype.remove.call(this,e)};Type.prototype.isReservedId=function isReservedId(e){return r.isReservedId(this.reserved,e)};Type.prototype.isReservedName=function isReservedName(e){return r.isReservedName(this.reserved,e)};Type.prototype.create=function create(e){return new this.ctor(e)};Type.prototype.setup=function setup(){var e=this.fullName,t=[];for(var n=0;n<this.fieldsArray.length;++n)t.push(this._fieldsArray[n].resolve().resolvedType);this.encode=f(this)({Writer:d,types:t,util:h});this.decode=p(this)({Reader:u,types:t,util:h});this.verify=m(this)({types:t,util:h});this.fromObject=g.fromObject(this)({types:t,util:h});this.toObject=g.toObject(this)({types:t,util:h});var r=v[e];if(r){var i=Object.create(this);i.fromObject=this.fromObject;this.fromObject=r.fromObject.bind(i);i.toObject=this.toObject;this.toObject=r.toObject.bind(i)}return this};Type.prototype.encode=function encode_setup(e,t){return this.setup().encode(e,t)};Type.prototype.encodeDelimited=function encodeDelimited(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()};Type.prototype.decode=function decode_setup(e,t){return this.setup().decode(e,t)};Type.prototype.decodeDelimited=function decodeDelimited(e){if(!(e instanceof u))e=u.create(e);return this.decode(e,e.uint32())};Type.prototype.verify=function verify_setup(e){return this.setup().verify(e)};Type.prototype.fromObject=function fromObject(e){return this.setup().fromObject(e)};Type.prototype.toObject=function toObject(e,t){return this.setup().toObject(e,t)};Type.d=function decorateType(e){return function typeDecorator(t){h.decorateType(t,e)}}},8144:(e,t,n)=>{"use strict";var r=t;var i=n(8431);var s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function bake(e,t){var n=0,r={};t|=0;while(n<e.length)r[s[n+t]]=e[n++];return r}r.basic=bake([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);r.defaults=bake([0,0,0,0,0,0,0,0,0,0,0,0,false,"",i.emptyArray,null]);r.long=bake([0,0,0,1,1],7);r.mapKey=bake([0,0,0,5,5,0,0,0,1,1,0,2],2);r.packed=bake([1,5,0,0,0,5,5,0,0,0,1,1,0])},8431:(e,t,n)=>{"use strict";var r=e.exports=n(5537);var i=n(741);var s,a;r.codegen=n(8566);r.fetch=n(7561);r.path=n(8464);r.fs=r.inquire("fs");r.toArray=function toArray(e){if(e){var t=Object.keys(e),n=new Array(t.length),r=0;while(r<t.length)n[r]=e[t[r++]];return n}return[]};r.toObject=function toObject(e){var t={},n=0;while(n<e.length){var r=e[n++],i=e[n++];if(i!==undefined)t[r]=i}return t};var o=/\\/g,l=/"/g;r.isReserved=function isReserved(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};r.safeProp=function safeProp(e){if(!/^[$\w_]+$/.test(e)||r.isReserved(e))return'["'+e.replace(o,"\\\\").replace(l,'\\"')+'"]';return"."+e};r.ucFirst=function ucFirst(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;r.camelCase=function camelCase(e){return e.substring(0,1)+e.substring(1).replace(c,(function(e,t){return t.toUpperCase()}))};r.compareFieldsById=function compareFieldsById(e,t){return e.id-t.id};r.decorateType=function decorateType(e,t){if(e.$type){if(t&&e.$type.name!==t){r.decorateRoot.remove(e.$type);e.$type.name=t;r.decorateRoot.add(e.$type)}return e.$type}if(!s)s=n(3101);var i=new s(t||e.name);r.decorateRoot.add(i);i.ctor=e;Object.defineProperty(e,"$type",{value:i,enumerable:false});Object.defineProperty(e.prototype,"$type",{value:i,enumerable:false});return i};var u=0;r.decorateEnum=function decorateEnum(e){if(e.$type)return e.$type;if(!a)a=n(9344);var t=new a("Enum"+u++,e);r.decorateRoot.add(t);Object.defineProperty(e,"$type",{value:t,enumerable:false});return t};r.setProperty=function setProperty(e,t,n){function setProp(e,t,n){var r=t.shift();if(t.length>0){e[r]=setProp(e[r]||{},t,n)}else{var i=e[r];if(i)n=[].concat(i).concat(n);e[r]=n}return e}if(typeof e!=="object")throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");t=t.split(".");return setProp(e,t,n)};Object.defineProperty(r,"decorateRoot",{get:function(){return i["decorated"]||(i["decorated"]=new(n(6420)))}})},4536:(e,t,n)=>{"use strict";e.exports=LongBits;var r=n(5537);function LongBits(e,t){this.lo=e>>>0;this.hi=t>>>0}var i=LongBits.zero=new LongBits(0,0);i.toNumber=function(){return 0};i.zzEncode=i.zzDecode=function(){return this};i.length=function(){return 1};var s=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function fromNumber(e){if(e===0)return i;var t=e<0;if(t)e=-e;var n=e>>>0,r=(e-n)/4294967296>>>0;if(t){r=~r>>>0;n=~n>>>0;if(++n>4294967295){n=0;if(++r>4294967295)r=0}}return new LongBits(n,r)};LongBits.from=function from(e){if(typeof e==="number")return LongBits.fromNumber(e);if(r.isString(e)){if(r.Long)e=r.Long.fromString(e);else return LongBits.fromNumber(parseInt(e,10))}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):i};LongBits.prototype.toNumber=function toNumber(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,n=~this.hi>>>0;if(!t)n=n+1>>>0;return-(t+n*4294967296)}return this.lo+this.hi*4294967296};LongBits.prototype.toLong=function toLong(e){return r.Long?new r.Long(this.lo|0,this.hi|0,Boolean(e)):{low:this.lo|0,high:this.hi|0,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;LongBits.fromHash=function fromHash(e){if(e===s)return i;return new LongBits((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)};LongBits.prototype.toHash=function toHash(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};LongBits.prototype.zzEncode=function zzEncode(){var e=this.hi>>31;this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0;this.lo=(this.lo<<1^e)>>>0;return this};LongBits.prototype.zzDecode=function zzDecode(){var e=-(this.lo&1);this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0;this.hi=(this.hi>>>1^e)>>>0;return this};LongBits.prototype.length=function length(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?t===0?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},5537:function(e,t,n){"use strict";var r=t;r.asPromise=n(4955);r.base64=n(8293);r.EventEmitter=n(6585);r.float=n(8602);r.inquire=n(7461);r.utf8=n(795);r.pool=n(5945);r.LongBits=n(4536);r.isNode=Boolean(typeof global!=="undefined"&&global&&global.process&&global.process.versions&&global.process.versions.node);r.global=r.isNode&&global||typeof window!=="undefined"&&window||typeof self!=="undefined"&&self||this;r.emptyArray=Object.freeze?Object.freeze([]):[];r.emptyObject=Object.freeze?Object.freeze({}):{};r.isInteger=Number.isInteger||function isInteger(e){return typeof e==="number"&&isFinite(e)&&Math.floor(e)===e};r.isString=function isString(e){return typeof e==="string"||e instanceof String};r.isObject=function isObject(e){return e&&typeof e==="object"};r.isset=r.isSet=function isSet(e,t){var n=e[t];if(n!=null&&e.hasOwnProperty(t))return typeof n!=="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0;return false};r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}();r._Buffer_from=null;r._Buffer_allocUnsafe=null;r.newBuffer=function newBuffer(e){return typeof e==="number"?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):typeof Uint8Array==="undefined"?e:new Uint8Array(e)};r.Array=typeof Uint8Array!=="undefined"?Uint8Array:Array;r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long");r.key2Re=/^true|false|0|1$/;r.key32Re=/^-?(?:0|[1-9][0-9]*)$/;r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;r.longToHash=function longToHash(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash};r.longFromHash=function longFromHash(e,t){var n=r.LongBits.fromHash(e);if(r.Long)return r.Long.fromBits(n.lo,n.hi,t);return n.toNumber(Boolean(t))};function merge(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)if(e[r[i]]===undefined||!n)e[r[i]]=t[r[i]];return e}r.merge=merge;r.lcFirst=function lcFirst(e){return e.charAt(0).toLowerCase()+e.substring(1)};function newError(e){function CustomError(e,t){if(!(this instanceof CustomError))return new CustomError(e,t);Object.defineProperty(this,"message",{get:function(){return e}});if(Error.captureStackTrace)Error.captureStackTrace(this,CustomError);else Object.defineProperty(this,"stack",{value:(new Error).stack||""});if(t)merge(this,t)}(CustomError.prototype=Object.create(Error.prototype)).constructor=CustomError;Object.defineProperty(CustomError.prototype,"name",{get:function(){return e}});CustomError.prototype.toString=function toString(){return this.name+": "+this.message};return CustomError}r.newError=newError;r.ProtocolError=newError("ProtocolError");r.oneOfGetter=function getOneOf(e){var t={};for(var n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(t[e[n]]===1&&this[e[n]]!==undefined&&this[e[n]]!==null)return e[n]}};r.oneOfSetter=function setOneOf(e){return function(t){for(var n=0;n<e.length;++n)if(e[n]!==t)delete this[e[n]]}};r.toJSONOptions={longs:String,enums:String,bytes:String,json:true};r._configure=function(){var e=r.Buffer;if(!e){r._Buffer_from=r._Buffer_allocUnsafe=null;return}r._Buffer_from=e.from!==Uint8Array.from&&e.from||function Buffer_from(t,n){return new e(t,n)};r._Buffer_allocUnsafe=e.allocUnsafe||function Buffer_allocUnsafe(t){return new e(t)}}},9304:(e,t,n)=>{"use strict";e.exports=verifier;var r=n(9344),i=n(8431);function invalid(e,t){return e.name+": "+t+(e.repeated&&t!=="array"?"[]":e.map&&t!=="object"?"{k:"+e.keyType+"}":"")+" expected"}function genVerifyValue(e,t,n,i){if(t.resolvedType){if(t.resolvedType instanceof r){e("switch(%s){",i)("default:")("return%j",invalid(t,"enum value"));for(var s=Object.keys(t.resolvedType.values),a=0;a<s.length;++a)e("case %i:",t.resolvedType.values[s[a]]);e("break")("}")}else{e("{")("var e=types[%i].verify(%s);",n,i)("if(e)")("return%j+e",t.name+".")("}")}}else{switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",i)("return%j",invalid(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",invalid(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',i)("return%j",invalid(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',i)("return%j",invalid(t,"boolean"));break;case"string":e("if(!util.isString(%s))",i)("return%j",invalid(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",invalid(t,"buffer"));break}}return e}function genVerifyKey(e,t,n){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",n)("return%j",invalid(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",n)("return%j",invalid(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",n)("return%j",invalid(t,"boolean key"));break}return e}function verifier(e){var t=i.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected");var n=e.oneofsArray,r={};if(n.length)t("var p={}");for(var s=0;s<e.fieldsArray.length;++s){var a=e._fieldsArray[s].resolve(),o="m"+i.safeProp(a.name);if(a.optional)t("if(%s!=null&&m.hasOwnProperty(%j)){",o,a.name);if(a.map){t("if(!util.isObject(%s))",o)("return%j",invalid(a,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){");genVerifyKey(t,a,"k[i]");genVerifyValue(t,a,s,o+"[k[i]]")("}")}else if(a.repeated){t("if(!Array.isArray(%s))",o)("return%j",invalid(a,"array"))("for(var i=0;i<%s.length;++i){",o);genVerifyValue(t,a,s,o+"[i]")("}")}else{if(a.partOf){var l=i.safeProp(a.partOf.name);if(r[a.partOf.name]===1)t("if(p%s===1)",l)("return%j",a.partOf.name+": multiple values");r[a.partOf.name]=1;t("p%s=1",l)}genVerifyValue(t,a,s,o)}if(a.optional)t("}")}return t("return null")}},3147:(e,t,n)=>{"use strict";var r=t;var i=n(4811);r[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1);var n=this.lookup(t);if(n){var r=e["@type"].charAt(0)==="."?e["@type"].substr(1):e["@type"];if(r.indexOf("/")===-1){r="/"+r}return this.create({type_url:r,value:n.encode(n.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var n="type.googleapis.com/";var r="";var s="";if(t&&t.json&&e.type_url&&e.value){s=e.type_url.substring(e.type_url.lastIndexOf("/")+1);r=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var a=this.lookup(s);if(a)e=a.decode(e.value)}if(!(e instanceof this.ctor)&&e instanceof i){var o=e.$type.toObject(e,t);var l=e.$type.fullName[0]==="."?e.$type.fullName.substr(1):e.$type.fullName;if(r===""){r=n}s=r+l;o["@type"]=s;return o}return this.toObject(e,t)}}},8781:(e,t,n)=>{"use strict";e.exports=Writer;var r=n(5537);var i;var s=r.LongBits,a=r.base64,o=r.utf8;function Op(e,t,n){this.fn=e;this.len=t;this.next=undefined;this.val=n}function noop(){}function State(e){this.head=e.head;this.tail=e.tail;this.len=e.len;this.next=e.states}function Writer(){this.len=0;this.head=new Op(noop,0,0);this.tail=this.head;this.states=null}var l=function create(){return r.Buffer?function create_buffer_setup(){return(Writer.create=function create_buffer(){return new i})()}:function create_array(){return new Writer}};Writer.create=l();Writer.alloc=function alloc(e){return new r.Array(e)};if(r.Array!==Array)Writer.alloc=r.pool(Writer.alloc,r.Array.prototype.subarray);Writer.prototype._push=function push(e,t,n){this.tail=this.tail.next=new Op(e,t,n);this.len+=t;return this};function writeByte(e,t,n){t[n]=e&255}function writeVarint32(e,t,n){while(e>127){t[n++]=e&127|128;e>>>=7}t[n]=e}function VarintOp(e,t){this.len=e;this.next=undefined;this.val=t}VarintOp.prototype=Object.create(Op.prototype);VarintOp.prototype.fn=writeVarint32;Writer.prototype.uint32=function write_uint32(e){this.len+=(this.tail=this.tail.next=new VarintOp((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len;return this};Writer.prototype.int32=function write_int32(e){return e<0?this._push(writeVarint64,10,s.fromNumber(e)):this.uint32(e)};Writer.prototype.sint32=function write_sint32(e){return this.uint32((e<<1^e>>31)>>>0)};function writeVarint64(e,t,n){while(e.hi){t[n++]=e.lo&127|128;e.lo=(e.lo>>>7|e.hi<<25)>>>0;e.hi>>>=7}while(e.lo>127){t[n++]=e.lo&127|128;e.lo=e.lo>>>7}t[n++]=e.lo}Writer.prototype.uint64=function write_uint64(e){var t=s.from(e);return this._push(writeVarint64,t.length(),t)};Writer.prototype.int64=Writer.prototype.uint64;Writer.prototype.sint64=function write_sint64(e){var t=s.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)};Writer.prototype.bool=function write_bool(e){return this._push(writeByte,1,e?1:0)};function writeFixed32(e,t,n){t[n]=e&255;t[n+1]=e>>>8&255;t[n+2]=e>>>16&255;t[n+3]=e>>>24}Writer.prototype.fixed32=function write_fixed32(e){return this._push(writeFixed32,4,e>>>0)};Writer.prototype.sfixed32=Writer.prototype.fixed32;Writer.prototype.fixed64=function write_fixed64(e){var t=s.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)};Writer.prototype.sfixed64=Writer.prototype.fixed64;Writer.prototype.float=function write_float(e){return this._push(r.float.writeFloatLE,4,e)};Writer.prototype.double=function write_double(e){return this._push(r.float.writeDoubleLE,8,e)};var c=r.Array.prototype.set?function writeBytes_set(e,t,n){t.set(e,n)}:function writeBytes_for(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};Writer.prototype.bytes=function write_bytes(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(r.isString(e)){var n=Writer.alloc(t=a.length(e));a.decode(e,n,0);e=n}return this.uint32(t)._push(c,t,e)};Writer.prototype.string=function write_string(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(writeByte,1,0)};Writer.prototype.fork=function fork(){this.states=new State(this);this.head=this.tail=new Op(noop,0,0);this.len=0;return this};Writer.prototype.reset=function reset(){if(this.states){this.head=this.states.head;this.tail=this.states.tail;this.len=this.states.len;this.states=this.states.next}else{this.head=this.tail=new Op(noop,0,0);this.len=0}return this};Writer.prototype.ldelim=function ldelim(){var e=this.head,t=this.tail,n=this.len;this.reset().uint32(n);if(n){this.tail.next=e.next;this.tail=t;this.len+=n}return this};Writer.prototype.finish=function finish(){var e=this.head.next,t=this.constructor.alloc(this.len),n=0;while(e){e.fn(e.val,t,n);n+=e.len;e=e.next}return t};Writer._configure=function(e){i=e;Writer.create=l();i._configure()}},7527:(e,t,n)=>{"use strict";e.exports=BufferWriter;var r=n(8781);(BufferWriter.prototype=Object.create(r.prototype)).constructor=BufferWriter;var i=n(5537);function BufferWriter(){r.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=i._Buffer_allocUnsafe;BufferWriter.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&i.Buffer.prototype.set.name==="set"?function writeBytesBuffer_set(e,t,n){t.set(e,n)}:function writeBytesBuffer_copy(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}};BufferWriter.prototype.bytes=function write_bytes_buffer(e){if(i.isString(e))e=i._Buffer_from(e,"base64");var t=e.length>>>0;this.uint32(t);if(t)this._push(BufferWriter.writeBytesBuffer,t,e);return this};function writeStringBuffer(e,t,n){if(e.length<40)i.utf8.write(e,t,n);else if(t.utf8Write)t.utf8Write(e,n);else t.write(e,n)}BufferWriter.prototype.string=function write_string_buffer(e){var t=i.Buffer.byteLength(e);this.uint32(t);if(t)this._push(writeStringBuffer,t,e);return this};BufferWriter._configure()},9523:e=>{"use strict";e.exports=require("dns")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5158:e=>{"use strict";e.exports=require("http2")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5451:e=>{"use strict";e.exports={i8:"1.6.6"}},9412:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Api":{"fields":{"name":{"type":"string","id":1},"methods":{"rule":"repeated","type":"Method","id":2},"options":{"rule":"repeated","type":"Option","id":3},"version":{"type":"string","id":4},"sourceContext":{"type":"SourceContext","id":5},"mixins":{"rule":"repeated","type":"Mixin","id":6},"syntax":{"type":"Syntax","id":7}}},"Method":{"fields":{"name":{"type":"string","id":1},"requestTypeUrl":{"type":"string","id":2},"requestStreaming":{"type":"bool","id":3},"responseTypeUrl":{"type":"string","id":4},"responseStreaming":{"type":"bool","id":5},"options":{"rule":"repeated","type":"Option","id":6},"syntax":{"type":"Syntax","id":7}}},"Mixin":{"fields":{"name":{"type":"string","id":1},"root":{"type":"string","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}}}}}}}}')},3460:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"FileDescriptorSet":{"fields":{"file":{"rule":"repeated","type":"FileDescriptorProto","id":1}}},"FileDescriptorProto":{"fields":{"name":{"type":"string","id":1},"package":{"type":"string","id":2},"dependency":{"rule":"repeated","type":"string","id":3},"publicDependency":{"rule":"repeated","type":"int32","id":10,"options":{"packed":false}},"weakDependency":{"rule":"repeated","type":"int32","id":11,"options":{"packed":false}},"messageType":{"rule":"repeated","type":"DescriptorProto","id":4},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":5},"service":{"rule":"repeated","type":"ServiceDescriptorProto","id":6},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":7},"options":{"type":"FileOptions","id":8},"sourceCodeInfo":{"type":"SourceCodeInfo","id":9},"syntax":{"type":"string","id":12}}},"DescriptorProto":{"fields":{"name":{"type":"string","id":1},"field":{"rule":"repeated","type":"FieldDescriptorProto","id":2},"extension":{"rule":"repeated","type":"FieldDescriptorProto","id":6},"nestedType":{"rule":"repeated","type":"DescriptorProto","id":3},"enumType":{"rule":"repeated","type":"EnumDescriptorProto","id":4},"extensionRange":{"rule":"repeated","type":"ExtensionRange","id":5},"oneofDecl":{"rule":"repeated","type":"OneofDescriptorProto","id":8},"options":{"type":"MessageOptions","id":7},"reservedRange":{"rule":"repeated","type":"ReservedRange","id":9},"reservedName":{"rule":"repeated","type":"string","id":10}},"nested":{"ExtensionRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}},"ReservedRange":{"fields":{"start":{"type":"int32","id":1},"end":{"type":"int32","id":2}}}}},"FieldDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":3},"label":{"type":"Label","id":4},"type":{"type":"Type","id":5},"typeName":{"type":"string","id":6},"extendee":{"type":"string","id":2},"defaultValue":{"type":"string","id":7},"oneofIndex":{"type":"int32","id":9},"jsonName":{"type":"string","id":10},"options":{"type":"FieldOptions","id":8}},"nested":{"Type":{"values":{"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Label":{"values":{"LABEL_OPTIONAL":1,"LABEL_REQUIRED":2,"LABEL_REPEATED":3}}}},"OneofDescriptorProto":{"fields":{"name":{"type":"string","id":1},"options":{"type":"OneofOptions","id":2}}},"EnumDescriptorProto":{"fields":{"name":{"type":"string","id":1},"value":{"rule":"repeated","type":"EnumValueDescriptorProto","id":2},"options":{"type":"EnumOptions","id":3}}},"EnumValueDescriptorProto":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"type":"EnumValueOptions","id":3}}},"ServiceDescriptorProto":{"fields":{"name":{"type":"string","id":1},"method":{"rule":"repeated","type":"MethodDescriptorProto","id":2},"options":{"type":"ServiceOptions","id":3}}},"MethodDescriptorProto":{"fields":{"name":{"type":"string","id":1},"inputType":{"type":"string","id":2},"outputType":{"type":"string","id":3},"options":{"type":"MethodOptions","id":4},"clientStreaming":{"type":"bool","id":5},"serverStreaming":{"type":"bool","id":6}}},"FileOptions":{"fields":{"javaPackage":{"type":"string","id":1},"javaOuterClassname":{"type":"string","id":8},"javaMultipleFiles":{"type":"bool","id":10},"javaGenerateEqualsAndHash":{"type":"bool","id":20,"options":{"deprecated":true}},"javaStringCheckUtf8":{"type":"bool","id":27},"optimizeFor":{"type":"OptimizeMode","id":9,"options":{"default":"SPEED"}},"goPackage":{"type":"string","id":11},"ccGenericServices":{"type":"bool","id":16},"javaGenericServices":{"type":"bool","id":17},"pyGenericServices":{"type":"bool","id":18},"deprecated":{"type":"bool","id":23},"ccEnableArenas":{"type":"bool","id":31},"objcClassPrefix":{"type":"string","id":36},"csharpNamespace":{"type":"string","id":37},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[38,38]],"nested":{"OptimizeMode":{"values":{"SPEED":1,"CODE_SIZE":2,"LITE_RUNTIME":3}}}},"MessageOptions":{"fields":{"messageSetWireFormat":{"type":"bool","id":1},"noStandardDescriptorAccessor":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"mapEntry":{"type":"bool","id":7},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[8,8]]},"FieldOptions":{"fields":{"ctype":{"type":"CType","id":1,"options":{"default":"STRING"}},"packed":{"type":"bool","id":2},"jstype":{"type":"JSType","id":6,"options":{"default":"JS_NORMAL"}},"lazy":{"type":"bool","id":5},"deprecated":{"type":"bool","id":3},"weak":{"type":"bool","id":10},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]],"reserved":[[4,4]],"nested":{"CType":{"values":{"STRING":0,"CORD":1,"STRING_PIECE":2}},"JSType":{"values":{"JS_NORMAL":0,"JS_STRING":1,"JS_NUMBER":2}}}},"OneofOptions":{"fields":{"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumOptions":{"fields":{"allowAlias":{"type":"bool","id":2},"deprecated":{"type":"bool","id":3},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"EnumValueOptions":{"fields":{"deprecated":{"type":"bool","id":1},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"ServiceOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"MethodOptions":{"fields":{"deprecated":{"type":"bool","id":33},"uninterpretedOption":{"rule":"repeated","type":"UninterpretedOption","id":999}},"extensions":[[1000,536870911]]},"UninterpretedOption":{"fields":{"name":{"rule":"repeated","type":"NamePart","id":2},"identifierValue":{"type":"string","id":3},"positiveIntValue":{"type":"uint64","id":4},"negativeIntValue":{"type":"int64","id":5},"doubleValue":{"type":"double","id":6},"stringValue":{"type":"bytes","id":7},"aggregateValue":{"type":"string","id":8}},"nested":{"NamePart":{"fields":{"namePart":{"rule":"required","type":"string","id":1},"isExtension":{"rule":"required","type":"bool","id":2}}}}},"SourceCodeInfo":{"fields":{"location":{"rule":"repeated","type":"Location","id":1}},"nested":{"Location":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"span":{"rule":"repeated","type":"int32","id":2},"leadingComments":{"type":"string","id":3},"trailingComments":{"type":"string","id":4},"leadingDetachedComments":{"rule":"repeated","type":"string","id":6}}}}},"GeneratedCodeInfo":{"fields":{"annotation":{"rule":"repeated","type":"Annotation","id":1}},"nested":{"Annotation":{"fields":{"path":{"rule":"repeated","type":"int32","id":1},"sourceFile":{"type":"string","id":2},"begin":{"type":"int32","id":3},"end":{"type":"int32","id":4}}}}}}}}}}}')},3266:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')},6019:e=>{"use strict";e.exports=JSON.parse('{"nested":{"google":{"nested":{"protobuf":{"nested":{"Type":{"fields":{"name":{"type":"string","id":1},"fields":{"rule":"repeated","type":"Field","id":2},"oneofs":{"rule":"repeated","type":"string","id":3},"options":{"rule":"repeated","type":"Option","id":4},"sourceContext":{"type":"SourceContext","id":5},"syntax":{"type":"Syntax","id":6}}},"Field":{"fields":{"kind":{"type":"Kind","id":1},"cardinality":{"type":"Cardinality","id":2},"number":{"type":"int32","id":3},"name":{"type":"string","id":4},"typeUrl":{"type":"string","id":6},"oneofIndex":{"type":"int32","id":7},"packed":{"type":"bool","id":8},"options":{"rule":"repeated","type":"Option","id":9},"jsonName":{"type":"string","id":10},"defaultValue":{"type":"string","id":11}},"nested":{"Kind":{"values":{"TYPE_UNKNOWN":0,"TYPE_DOUBLE":1,"TYPE_FLOAT":2,"TYPE_INT64":3,"TYPE_UINT64":4,"TYPE_INT32":5,"TYPE_FIXED64":6,"TYPE_FIXED32":7,"TYPE_BOOL":8,"TYPE_STRING":9,"TYPE_GROUP":10,"TYPE_MESSAGE":11,"TYPE_BYTES":12,"TYPE_UINT32":13,"TYPE_ENUM":14,"TYPE_SFIXED32":15,"TYPE_SFIXED64":16,"TYPE_SINT32":17,"TYPE_SINT64":18}},"Cardinality":{"values":{"CARDINALITY_UNKNOWN":0,"CARDINALITY_OPTIONAL":1,"CARDINALITY_REQUIRED":2,"CARDINALITY_REPEATED":3}}}},"Enum":{"fields":{"name":{"type":"string","id":1},"enumvalue":{"rule":"repeated","type":"EnumValue","id":2},"options":{"rule":"repeated","type":"Option","id":3},"sourceContext":{"type":"SourceContext","id":4},"syntax":{"type":"Syntax","id":5}}},"EnumValue":{"fields":{"name":{"type":"string","id":1},"number":{"type":"int32","id":2},"options":{"rule":"repeated","type":"Option","id":3}}},"Option":{"fields":{"name":{"type":"string","id":1},"value":{"type":"Any","id":2}}},"Syntax":{"values":{"SYNTAX_PROTO2":0,"SYNTAX_PROTO3":1}},"Any":{"fields":{"type_url":{"type":"string","id":1},"value":{"type":"bytes","id":2}}},"SourceContext":{"fields":{"fileName":{"type":"string","id":1}}}}}}}}}')}};var __webpack_module_cache__={};function __nccwpck_require__(e){var t=__webpack_module_cache__[e];if(t!==undefined){return t.exports}var n=__webpack_module_cache__[e]={exports:{}};var r=true;try{__webpack_modules__[e].call(n.exports,n,n.exports,__nccwpck_require__);r=false}finally{if(r)delete __webpack_module_cache__[e]}return n.exports}if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=__dirname+"/";var __webpack_exports__={};(()=>{"use strict";var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:true});e.experimental=e.StatusBuilder=e.getClientChannel=e.ServerCredentials=e.Server=e.setLogVerbosity=e.setLogger=e.load=e.loadObject=e.CallCredentials=e.ChannelCredentials=e.waitForClientReady=e.closeClient=e.Channel=e.makeGenericClientConstructor=e.makeClientConstructor=e.loadPackageDefinition=e.Client=e.compressionAlgorithms=e.propagate=e.connectivityState=e.status=e.logVerbosity=e.Metadata=e.credentials=void 0;const t=__nccwpck_require__(3962);Object.defineProperty(e,"CallCredentials",{enumerable:true,get:function(){return t.CallCredentials}});const n=__nccwpck_require__(7586);Object.defineProperty(e,"Channel",{enumerable:true,get:function(){return n.ChannelImplementation}});const r=__nccwpck_require__(4726);Object.defineProperty(e,"compressionAlgorithms",{enumerable:true,get:function(){return r.CompressionAlgorithms}});const i=__nccwpck_require__(8480);Object.defineProperty(e,"connectivityState",{enumerable:true,get:function(){return i.ConnectivityState}});const s=__nccwpck_require__(3062);Object.defineProperty(e,"ChannelCredentials",{enumerable:true,get:function(){return s.ChannelCredentials}});const a=__nccwpck_require__(4153);Object.defineProperty(e,"Client",{enumerable:true,get:function(){return a.Client}});const o=__nccwpck_require__(8215);Object.defineProperty(e,"logVerbosity",{enumerable:true,get:function(){return o.LogVerbosity}});Object.defineProperty(e,"status",{enumerable:true,get:function(){return o.Status}});Object.defineProperty(e,"propagate",{enumerable:true,get:function(){return o.Propagate}});const l=__nccwpck_require__(8221);const c=__nccwpck_require__(1468);Object.defineProperty(e,"loadPackageDefinition",{enumerable:true,get:function(){return c.loadPackageDefinition}});Object.defineProperty(e,"makeClientConstructor",{enumerable:true,get:function(){return c.makeClientConstructor}});Object.defineProperty(e,"makeGenericClientConstructor",{enumerable:true,get:function(){return c.makeClientConstructor}});const u=__nccwpck_require__(6489);Object.defineProperty(e,"Metadata",{enumerable:true,get:function(){return u.Metadata}});const d=__nccwpck_require__(1493);Object.defineProperty(e,"Server",{enumerable:true,get:function(){return d.Server}});const h=__nccwpck_require__(8659);Object.defineProperty(e,"ServerCredentials",{enumerable:true,get:function(){return h.ServerCredentials}});const f=__nccwpck_require__(7774);Object.defineProperty(e,"StatusBuilder",{enumerable:true,get:function(){return f.StatusBuilder}});e.credentials={combineChannelCredentials:(e,...t)=>t.reduce(((e,t)=>e.compose(t)),e),combineCallCredentials:(e,...t)=>t.reduce(((e,t)=>e.compose(t)),e),createInsecure:s.ChannelCredentials.createInsecure,createSsl:s.ChannelCredentials.createSsl,createFromSecureContext:s.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:t.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:t.CallCredentials.createFromGoogleCredential,createEmpty:t.CallCredentials.createEmpty};e.closeClient=e=>e.close();e.waitForClientReady=(e,t,n)=>e.waitForReady(t,n);e.loadObject=(e,t)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};e.load=(e,t,n)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};e.setLogger=e=>{l.setLogger(e)};e.setLogVerbosity=e=>{l.setLoggerVerbosity(e)};e.getClientChannel=e=>a.Client.prototype.getChannel.call(e);var p=__nccwpck_require__(3428);Object.defineProperty(e,"ListenerBuilder",{enumerable:true,get:function(){return p.ListenerBuilder}});Object.defineProperty(e,"RequesterBuilder",{enumerable:true,get:function(){return p.RequesterBuilder}});Object.defineProperty(e,"InterceptingCall",{enumerable:true,get:function(){return p.InterceptingCall}});Object.defineProperty(e,"InterceptorConfigurationError",{enumerable:true,get:function(){return p.InterceptorConfigurationError}});var m=__nccwpck_require__(6158);Object.defineProperty(e,"getChannelzServiceDefinition",{enumerable:true,get:function(){return m.getChannelzServiceDefinition}});Object.defineProperty(e,"getChannelzHandlers",{enumerable:true,get:function(){return m.getChannelzHandlers}});var g=__nccwpck_require__(7876);Object.defineProperty(e,"addAdminServicesToServer",{enumerable:true,get:function(){return g.addAdminServicesToServer}});const v=__nccwpck_require__(9006);e.experimental=v;const y=__nccwpck_require__(8203);const S=__nccwpck_require__(5933);const b=__nccwpck_require__(7447);const C=__nccwpck_require__(9956);const _=__nccwpck_require__(6761);const T=__nccwpck_require__(2057);const E=__nccwpck_require__(6158);const R=__nccwpck_require__(5451).i8;(()=>{l.trace(o.LogVerbosity.DEBUG,"index","Loading @grpc/grpc-js version "+R);y.setup();S.setup();b.setup();C.setup();_.setup();T.setup();E.setup()})()})();module.exports=__webpack_exports__})();